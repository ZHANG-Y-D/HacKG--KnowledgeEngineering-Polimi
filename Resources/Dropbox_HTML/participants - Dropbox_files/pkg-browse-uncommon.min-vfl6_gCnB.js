define("modules/clean/base64",["require","exports"],(function(e,t){"use strict";function r(e){var t=[],r=0,n=0,i=0,o=0,s=0;for(e+="";r<e.length;)(i=e.charCodeAt(r))<128?(t[n++]=String.fromCharCode(i),r++):i>191&&i<224?(o=e.charCodeAt(r+1),t[n++]=String.fromCharCode((31&i)<<6|63&o),r+=2):(o=e.charCodeAt(r+1),s=e.charCodeAt(r+2),t[n++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s),r+=3);return t.join("")}Object.defineProperty(t,"__esModule",{value:!0}),t.decode=t.encode=void 0,t.encode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r=void 0,n=void 0,i=void 0,o=void 0,s=void 0,a=0,l=0,_="",u=[];if(!e)return e;for(;r=(s=e.charCodeAt(a++)<<16|e.charCodeAt(a++)<<8|e.charCodeAt(a++))>>18&63,n=s>>12&63,i=s>>6&63,o=63&s,u[l++]=t.charAt(r)+t.charAt(n)+t.charAt(i)+t.charAt(o),a<e.length;);_=u.join("");var c=e.length%3;return(c?_.slice(0,c-3):_)+"===".slice(c||3)},t.decode=function(e,t){var n=t?function(e){return e}:r;if("function"==typeof window.atob)return n(window.atob(e));var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=0,s=0,a=[];if(!e)return e;for(e+="";;){var l=i.indexOf(e.charAt(o++)),_=i.indexOf(e.charAt(o++)),u=i.indexOf(e.charAt(o++)),c=i.indexOf(e.charAt(o++)),d=l<<18|_<<12|u<<6|c,v=d>>16&255,f=d>>8&255,g=255&d;if(a[s++]=64===u?String.fromCharCode(v):64===c?String.fromCharCode(v,f):String.fromCharCode(v,f,g),!(o<e.length))break}var m=a.join("");return m=n(m)}})),define("modules/clean/react/browse/action_logger",["require","exports","tslib","modules/clean/filepath/filepath","modules/clean/filetypes","modules/clean/react/browse/logger","modules/clean/react/browse/logger_util","modules/clean/web_user_action_events","modules/clean/user_survey/user_survey"],(function(e,t,r,n,i,o,s,a,l){"use strict";function _(e){o.browseLogger.log(e)}function u(e){var t=e.uid,i=e.source,o=e.action,a=e.num_files_selected,l=e.num_folders_selected,u=e.view_type,c=e.result,d=e.error_summary,v=e.action_surface,f=e.action_source,g=e.batch_success_count,m=e.batch_fail_count,y=e.lookup_error_type,p=e.right_sidebar_state,A=e.extra,S={num_files_selected:a,num_folders_selected:l,source:i,view_type:u,error_summary:d};if(s.isFile(c)){var b=(C=c).request_id,E=C.ns_id,h=C.sjid,w=C.file_id,O=C.fq_path,T=C.bytes,R=C.ext;S=r.__assign(r.__assign({},S),{request_id:b,file_nsid:E,file_sjid:h,file_id:w,file_name:n.filename(O),file_path:O,file_size:T,file_extension:R})}else if(s.isPaper(c)){var C;b=(C=c).request_id;S=r.__assign(r.__assign({},S),{request_id:b})}_({user_id:t,event_name:o,source:i,view_type:u,request_id:S.request_id,file_nsid:S.file_nsid,file_sjid:S.file_sjid,file_id:S.file_id,file_name:S.file_name,file_path:S.file_path,file_size:S.file_size,file_extension:S.file_extension,action_source:f,extra:r.__assign(r.__assign({},A),{num_files_selected:String(S.num_files_selected),num_folders_selected:String(S.num_folders_selected),error_summary:S.error_summary||null,action_surface:v||null,batch_success_count:g?String(g):null,batch_fail_count:m?String(m):null,lookup_error_type:y||null,right_sidebar_state:null!=p?p:null})})}Object.defineProperty(t,"__esModule",{value:!0}),t.logAutomationsModal=t.logFolderRuleFeedbackModal=t.logFolderRulesModal=t.logCreateAutomatedFolderClick=t.logBrowseLoaded=t.logFileAction=t.logRightClickItems=t.logContextMenuClick=t.logKeyboardShortcutUsage=t.logFileCreateSuccess=t.logPageView=t.logFileCreateClick=t.logFileUploadFSWReturned=t.logPermanentDeleteFiles=t.logDeleteFiles=t.logOpenCopyModal=t.logDownload=t.logAddComment=t.logRenameFiles=t.logOpenMoveModal=t.logVersions=t.logCopyFiles=t.logOpenAddToCollectionModal=t.logMoveFiles=t.logFileOperationModalClick=t.logRestore=t.logSwitchViewType=t.logSortRecords=t.logToggleDeletedFiles=t.logViewShareModal=t.logFolderExplorerCollapseRow=t.logFolderExplorerExpandRow=t.logOpenRow=t.logBrowseAction=t.logWebUserAction=t.BrowseLogEventSource=void 0,n=r.__importStar(n),(function(e){e.MAESTRO_RIGHT_SIDEBAR="MAESTRO_RIGHT_SIDEBAR",e.MAESTRO_PHOTOS_RIGHT_SIDEBAR="MAESTRO_PHOTOS_RIGHT_SIDEBAR",e.LEGACY_HEADER_ACTIONS="LEGACY_HEADER_ACTIONS",e.DRAG="DRAG"})(t.BrowseLogEventSource||(t.BrowseLogEventSource={})),o.browseLogger.registerRowInjector(o.screenSizeInjector),t.logWebUserAction=_,t.logBrowseAction=u,t.logOpenRow=function(e){var t=e.uid,r=e.entity_type,n=e.source,o=e.view_type,s=e.file_nsid,l=e.file_sjid,u=e.file_id,c=e.file_name,d=e.file_path,v=e.file_size,f=e.file_type,g=e.file_extension,m=e.request_id,y=e.action_source,p=e.vaultApi,A=e.vaultLoggingTypes,S=e.rightRailState;_({user_id:t,event_name:a.WebUserActionLogEvent.OPEN_ROW,source:n,view_type:o,file_nsid:s,file_sjid:l,file_id:u,file_name:c,file_path:d,file_size:v,file_extension:g,request_id:m,action_source:y,extra:{entity_type:r,right_sidebar_state:null!=S?S:null}}),f===i.FileTypes.VAULT_FOLDER&&null!=p&&null!=A&&p.logProductAnalyticsEvent({actionSurface:A.AnalyticsEventActionSurface.BROWSE,eventAction:A.AnalyticsEventAction.SELECT,eventObject:A.AnalyticsEventObject.VAULT_FOLDER})},t.logFolderExplorerExpandRow=function(e){var t=e.uid,r=e.entity_type,n=e.source,i=e.file_name,o=e.file_path;_({user_id:t,event_name:a.WebUserActionLogEvent.FOLDER_EXPLORER_EXPAND_ROW,source:n,file_name:i,file_path:o,extra:{entity_type:r}})},t.logFolderExplorerCollapseRow=function(e){var t=e.uid,r=e.entity_type,n=e.source,i=e.file_name,o=e.file_path;_({user_id:t,event_name:a.WebUserActionLogEvent.FOLDER_EXPLORER_COLLAPSE_ROW,source:n,file_name:i,file_path:o,extra:{entity_type:r}})},t.logViewShareModal=function(e){var t=e.uid,r=e.modal_session_id,n=e.file_nsid,i=e.file_sjid,o=e.file_id,s=e.file_name,l=e.file_path;_({user_id:t,event_name:a.WebUserActionLogEvent.VIEW_SHARE_MODEL,file_nsid:n,file_sjid:i,file_id:o,file_name:s,file_path:l,extra:{modal_session_id:r}})},t.logToggleDeletedFiles=function(e){var t=e.uid,r=e.show_deleted_files,n=e.view_type;_({user_id:t,event_name:a.WebUserActionLogEvent.TOGGLE_DELETED_FILES,view_type:n,extra:{show_deleted_files:r.toString()}})},t.logSortRecords=function(e){var t=e.uid,r=e.sort_by,n=e.sort_direction,i=e.view_type;_({user_id:t,event_name:a.WebUserActionLogEvent.SORT_RECORDS,view_type:i,extra:{sort_by:r,sort_direction:n}})},t.logSwitchViewType=function(e){var t=e.uid,r=(e.isSearchMode,e.viewType);_({user_id:t,event_name:a.WebUserActionLogEvent.SWITCH_VIEW_TYPE,view_type:r})},t.logRestore=function(e){var t=e.uid,r=e.source,n=e.view_type,i=e.file_nsid,o=e.file_path,s=e.file_name,l=e.num_files_selected,u=e.num_folders_selected;_({user_id:t,event_name:a.WebUserActionLogEvent.RESTORE,source:r,view_type:n,file_nsid:i,file_path:o,file_name:s,extra:{num_files_selected:l?l.toString():null,num_folders_selected:u?u.toString():null}})},t.logFileOperationModalClick=function(e){var t=e.uid,r=e.event_name,n=e.selectedPath;_({user_id:t,event_name:r,extra:n?{selectedPath:n}:{}})},t.logMoveFiles=function(e){u(r.__assign(r.__assign({},e),{action:a.WebUserActionLogEvent.MOVE})),l.UserSurvey.trackEvent("move_item","browse")},t.logOpenAddToCollectionModal=function(e){u(r.__assign(r.__assign({},e),{action:a.WebUserActionLogEvent.OPEN_ADD_TO_COLLECTION_MODAL}))},t.logCopyFiles=function(e){u(r.__assign(r.__assign({},e),{action:a.WebUserActionLogEvent.COPY}))},t.logVersions=function(e){u(r.__assign(r.__assign({},e),{action:a.WebUserActionLogEvent.VERSIONS}))},t.logOpenMoveModal=function(e){u(r.__assign(r.__assign({},e),{action:a.WebUserActionLogEvent.OPEN_MOVE_MODAL}))},t.logRenameFiles=function(e){u(r.__assign(r.__assign({},e),{action:a.WebUserActionLogEvent.RENAME}))},t.logAddComment=function(e){u(r.__assign(r.__assign({},e),{action:a.WebUserActionLogEvent.ADD_COMMENT}))},t.logDownload=function(e){u(r.__assign(r.__assign({},e),{action:a.WebUserActionLogEvent.DOWNLOAD})),l.UserSurvey.trackEvent("download_item","browse")},t.logOpenCopyModal=function(e){u(r.__assign(r.__assign({},e),{action:a.WebUserActionLogEvent.OPEN_COPY_MODAL}))},t.logDeleteFiles=function(e){u(r.__assign(r.__assign({},e),{action:a.WebUserActionLogEvent.DELETE}))},t.logPermanentDeleteFiles=function(e){u(r.__assign(r.__assign({},e),{action:a.WebUserActionLogEvent.PERMANENT_DELETE}))},t.logFileUploadFSWReturned=function(e){var t=e.uid,r=e.file_name,n=e.upload_id,i=e.all_fsw_ids,o=e.filtered_fsw_ids;_({user_id:t,event_name:a.WebUserActionLogEvent.FILE_UPLOAD_FSW_RETURNED,file_name:r,upload_id:n,all_fsw_ids:i,filtered_fsw_ids:o}),l.UserSurvey.trackEvent("upload_item","browse")},t.logFileCreateClick=function(e){var t=e.uid,r=e.source,n=e.action,i=e.depth_folder_selected,o=e.selection_mode,s=e.empty_folder;_({user_id:t,source:r,event_name:n,extra:{depth_folder_selected:void 0!==i?i.toString():null,selection_mode:o,empty_folder:s?"true":"false"}})},t.logPageView=function(e){var t=e.uid,r=e.view_type,n=e.url,i=e.folder_type,o=e.right_sidebar_state,s=e.navigation_depth,l=e.is_under_tmf;_({user_id:t,event_name:a.WebUserActionLogEvent.PAGE_VIEW,view_type:r,extra:{url:n,navigation_depth:void 0!==s?s.toString():null,folder_type:i,right_sidebar_state:o,is_under_tmf:void 0!==l?l.toString():null}})},t.logFileCreateSuccess=function(e){var t=e.uid,r=e.document_type,n=e.time_elapsed,i=e.open_id,o=e.selection_mode,s=e.empty_folder;_({user_id:t,event_name:a.WebUserActionLogEvent.FILE_CREATE_SUCCESS,extra:{document_type:r.toString(),time_elapsed:n.toString(),open_id:i,create_completed_timestamp_ms:Date.now().toString(),selection_mode:o||null,empty_folder:s?"true":"false"}}),l.UserSurvey.trackEvent("create_item","browse")},t.logKeyboardShortcutUsage=function(e){var t=e.user_id,r=e.view_type,n=e.keyboard_shortcut_type;_({user_id:t,event_name:a.WebUserActionLogEvent.KEYBOARD_SHORTCUT,view_type:r,extra:{keyboard_shortcut_type:n}})},t.logContextMenuClick=function(e){var t=e.uid,r=e.viewType,n=e.action_surface,i=e.numFilesSelected,o=e.numFoldersSelected;_({user_id:t,event_name:a.WebUserActionLogEvent.CONTEXT_MENU_CLICK,view_type:r,extra:{action_surface:n,num_files_selected:i?i.toString():null,num_folders_selected:o?o.toString():null}})},t.logRightClickItems=function(e){var t=e.uid,r=e.viewType,n=e.action_surface,i=e.numFilesSelected,o=e.numFoldersSelected;_({user_id:t,event_name:a.WebUserActionLogEvent.RIGHT_CLICK_ITEMS,view_type:r,extra:{action_surface:n,num_files_selected:i?i.toString():null,num_folders_selected:o?o.toString():null}})},t.logFileAction=function(e){var t=e.uid,n=e.action,i=e.num_files_selected,o=e.num_folders_selected,s=e.source,a=e.view_type,l=e.jobId,u=e.error_summary,c=e.error,d=e.batch_success_count,v=e.batch_fail_count,f=e.lookup_error_type,g=e.extra,m=void 0===g?{}:g;_({user_id:t,event_name:n,source:s,view_type:a,extra:r.__assign({num_files_selected:i?i.toString():null,num_folders_selected:o?o.toString():null,error_summary:u||null,error:c||null,job_id:l||null,batch_success_count:d?String(d):null,batch_fail_count:v?String(v):null,lookup_error_type:f||null},m)})},t.logBrowseLoaded=function(e){var t=e.uid,r=e.view_type,n=e.url,i=e.folder_type,o=e.navigation_depth,s=e.is_under_tmf;_({user_id:t,event_name:a.WebUserActionLogEvent.BROWSE_LOADED,view_type:r,extra:{url:n,navigation_depth:void 0!==o?o.toString():null,folder_type:i,is_under_tmf:void 0!==s?s.toString():null}})},t.logCreateAutomatedFolderClick=function(e){_({user_id:e.uid,source:e.source,file_path:e.file_path,file_nsid:e.file_nsid,event_name:a.WebUserActionLogEvent.CREATE_AUTOMATED_FOLDER_CLICK})},t.logFolderRulesModal=function(e){var t=e.uid,r=e.modal_session_id,n=e.event_name;_({user_id:t,file_nsid:e.file_nsid,event_name:n,file_path:e.file_path,extra:{error:e.error||null,pdfToggleStatus:e.pdfToggleStatus||null,unzipToggleStatus:e.unzipToggleStatus||null,isFolderRulesEnabled:e.isFolderRulesEnabled||null,modal_session_id:r,rule_type:e.ruleType||null}})},t.logFolderRuleFeedbackModal=function(e){var t=e.uid,r=e.feedback_source,n=e.modal_session_id,i=e.event_name;_({user_id:t,file_path:e.file_path,event_name:i,extra:{feedback_source:r,modal_session_id:n,error:e.error||null}})},t.logAutomationsModal=function(e){var t=e.action_source,r=e.event_name,n=e.file_nsid,i=e.modal_session_id,o=e.rule_selected;_({user_id:e.user_id,event_name:r,action_source:t,file_nsid:n,extra:{rule_selected:o||null,modal_session_id:i}})}})),define("modules/clean/react/browse/logger",["require","exports","tslib","modules/clean/logging/hive/schemas/web-user-action","modules/clean/logging/telemetry"],(function(e,t,r,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.screenSizeInjector=t.browseLogger=t.BrowseLogger=void 0,i=r.__importStar(i);var o=function(e){var t=this;this.registerRowInjector=function(e){t.rowInjectors.push(e)},this.log=function(e){var i={};t.rowInjectors.forEach((function(e){var t=e();i=r.__assign(r.__assign(r.__assign({},i),t),{extra:r.__assign(r.__assign({},i.extra),t.extra)})})),t.hiveLogger.log(new n.WebUserActionRow(r.__assign(r.__assign(r.__assign({},i),e),{extra:r.__assign(r.__assign({},i.extra),e.extra)})))},this.hiveLogger=e||new i.HiveLogger,this.rowInjectors=[]};t.BrowseLogger=o,t.browseLogger=new o,t.screenSizeInjector=function(){return{browser_width:window.innerWidth,browser_height:window.innerHeight,device_width:window.screen&&window.screen.width,device_height:window.screen&&window.screen.height}}})),define("dropbox/proto/js_init_data/user_survey/user_survey",["require","exports","tslib","protobufjs/minimal"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.user_survey=void 0;var i,o,s,a=(n=r.__importStar(n)).Reader,l=n.Writer,_=(n.util,n.roots.default||(n.roots.default={}));t.default=_,t.user_survey=_.user_survey=((i=_.user_survey||{}).SkuName=(o={},(s=Object.create(o))[o[0]="NONE"]=0,s[o[1]="OTHER"]=1,s[o[2]="FAMILY_PAYING_MEMBER"]=2,s[o[3]="FAMILY_NONPAYING_MEMBER"]=3,s[o[4]="BASIC"]=4,s[o[5]="TRANSFER"]=5,s[o[6]="PLUS"]=6,s[o[7]="PROFESSIONAL"]=7,s[o[8]="BUSINESS_STANDARD"]=8,s[o[9]="BUSINESS_ADVANCED"]=9,s[o[10]="ENTERPRISE"]=10,s),i.AccountAge=(function(){var e={},t=Object.create(e);return t[e[0]="UNKNOWN"]=0,t[e[1]="UNDER_14_DAYS"]=1,t[e[2]="FROM_14_DAYS_TO_30_DAYS"]=2,t[e[3]="FROM_30_DAYS_TO_90_DAYS"]=3,t[e[4]="FROM_90_DAYS_TO_1_YEAR"]=4,t[e[5]="FROM_1_YEAR_TO_5_YEARS"]=5,t[e[6]="OVER_5_YEARS"]=6,t})(),i.FamilyData=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.hasCompletedOnboarding=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=l.create()),null!=e.hasCompletedOnboarding&&Object.hasOwnProperty.call(e,"hasCompletedOnboarding")&&t.uint32(8).bool(e.hasCompletedOnboarding),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new _.user_survey.FamilyData;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.hasCompletedOnboarding=e.bool();break;default:e.skipType(7&i)}}return n},e.getTypeUrl=function(){return"type.googleapis.com/user_survey.FamilyData"},e})(i.FamilyData||{}),i.UserSurveyInitData=(function(e){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.iframeSrc="",e.prototype.surveyUserId="",e.prototype.isCsmTeam=!1,e.prototype.isTestAccount=!1,e.prototype.skuName=0,e.prototype.anonymizedPath="",e.prototype.isMobile=!1,e.prototype.isPaidTeam=!1,e.prototype.isTeamAdmin=!1,e.prototype.isCdm=!1,e.prototype.isOver_30DaysSinceAccountCreated=!1,e.prototype.isOver_30DaysSinceJoinedTeam=!1,e.prototype.familyData=null,e.prototype.accountAge=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=l.create()),null!=e.iframeSrc&&Object.hasOwnProperty.call(e,"iframeSrc")&&t.uint32(10).string(e.iframeSrc),null!=e.surveyUserId&&Object.hasOwnProperty.call(e,"surveyUserId")&&t.uint32(18).string(e.surveyUserId),null!=e.isCsmTeam&&Object.hasOwnProperty.call(e,"isCsmTeam")&&t.uint32(24).bool(e.isCsmTeam),null!=e.isTestAccount&&Object.hasOwnProperty.call(e,"isTestAccount")&&t.uint32(32).bool(e.isTestAccount),null!=e.skuName&&Object.hasOwnProperty.call(e,"skuName")&&t.uint32(40).int32(e.skuName),null!=e.anonymizedPath&&Object.hasOwnProperty.call(e,"anonymizedPath")&&t.uint32(50).string(e.anonymizedPath),null!=e.isMobile&&Object.hasOwnProperty.call(e,"isMobile")&&t.uint32(56).bool(e.isMobile),null!=e.isPaidTeam&&Object.hasOwnProperty.call(e,"isPaidTeam")&&t.uint32(64).bool(e.isPaidTeam),null!=e.isTeamAdmin&&Object.hasOwnProperty.call(e,"isTeamAdmin")&&t.uint32(72).bool(e.isTeamAdmin),null!=e.isCdm&&Object.hasOwnProperty.call(e,"isCdm")&&t.uint32(80).bool(e.isCdm),null!=e.isOver_30DaysSinceAccountCreated&&Object.hasOwnProperty.call(e,"isOver_30DaysSinceAccountCreated")&&t.uint32(88).bool(e.isOver_30DaysSinceAccountCreated),null!=e.isOver_30DaysSinceJoinedTeam&&Object.hasOwnProperty.call(e,"isOver_30DaysSinceJoinedTeam")&&t.uint32(96).bool(e.isOver_30DaysSinceJoinedTeam),null!=e.familyData&&Object.hasOwnProperty.call(e,"familyData")&&_.user_survey.FamilyData.encode(e.familyData,t.uint32(106).fork()).ldelim(),null!=e.accountAge&&Object.hasOwnProperty.call(e,"accountAge")&&t.uint32(112).int32(e.accountAge),t},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new _.user_survey.UserSurveyInitData;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.iframeSrc=e.string();break;case 2:n.surveyUserId=e.string();break;case 3:n.isCsmTeam=e.bool();break;case 4:n.isTestAccount=e.bool();break;case 5:n.skuName=e.int32();break;case 6:n.anonymizedPath=e.string();break;case 7:n.isMobile=e.bool();break;case 8:n.isPaidTeam=e.bool();break;case 9:n.isTeamAdmin=e.bool();break;case 10:n.isCdm=e.bool();break;case 11:n.isOver_30DaysSinceAccountCreated=e.bool();break;case 12:n.isOver_30DaysSinceJoinedTeam=e.bool();break;case 13:n.familyData=_.user_survey.FamilyData.decode(e,e.uint32());break;case 14:n.accountAge=e.int32();break;default:e.skipType(7&i)}}return n},e.getTypeUrl=function(){return"type.googleapis.com/user_survey.UserSurveyInitData"},e})(i.UserSurveyInitData||{}),i)})),define("modules/clean/user_survey/user_survey",["require","exports","tslib","proto_utils/unpack","dropbox/proto/js_init_data/user_survey/user_survey","modules/constants/page_load","modules/clean/viewer","modules/clean/logging/telemetry","modules/clean/logging/hive/schemas/web-user_survey","modules/constants/locales","lodash","modules/clean/ts_utils"],(function(e,t,r,n,i,o,s,a,l,_,u,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.moduleInit=t.InternalSurveyFunctionsForTestOnly=t.UserSurvey=t.USER_SURVEY_AGGREGATE_EVENTS_MAP=void 0,a=r.__importStar(a),_=r.__importStar(_);var d=new a.HiveLogger;t.USER_SURVEY_AGGREGATE_EVENTS_MAP=new Map([["browse_csat_trigger",[{event:"share_item",eventSurface:"browse"},{event:"move_item",eventSurface:"browse"},{event:"rename_item",eventSurface:"browse"},{event:"delete_item",eventSurface:"browse"},{event:"download_item",eventSurface:"browse"},{event:"upload_item",eventSurface:"browse"},{event:"create_item",eventSurface:"browse"}]],["add_item",[{event:"upload_item",eventSurface:"browse"},{event:"create_item",eventSurface:"browse"}]]]);var v=["/individual"],f=null,g=null,m=void 0,y=[];function p(e,t){f&&(f.height=e,f.width=t)}function A(e){var t=e.data.eventType;if(e.origin===g&&e.source===(null==f?void 0:f.contentWindow))switch(t){case"surveyResized":p(e.data.surveyHeight,e.data.surveyWidth);break;case"surveyPresented":d.log(new l.UserSurveyLoggingTableRow({event_name:"shown_survey",user_survey_id:m}));break;case"surveyClosed":p("0","0"),d.log(new l.UserSurveyLoggingTableRow({event_name:"closed_survey",user_survey_id:m}))}}function S(e){f||(g="https://"+e.iframeSrc,f=T.createIframe(g)),v.includes(e.anonymizedPath)&&f.classList.add("usersurvey-iframe--bottom-left"),f.addEventListener("load",(function(){b("setUserId",{userId:e.surveyUserId}),m=e.surveyUserId,w("localeCode",(function(){var e,t=null===(e=u.find(_.LIST_OF_LOCALES_WITHOUT_INTERNAL,(function(e){return e.localeCode===o.USER_LOCALE})))||void 0===e?void 0:e.localeCode;if(t)return t;return"unknown"})()),w("isCsmTeam",e.isCsmTeam?"true":"false"),w("isTestUser",e.isTestAccount?"true":"false"),w("skuName",(function(e){switch(e){case i.user_survey.SkuName.NONE:return"none";case i.user_survey.SkuName.OTHER:return"other";case i.user_survey.SkuName.FAMILY_PAYING_MEMBER:return"family_paying_member";case i.user_survey.SkuName.FAMILY_NONPAYING_MEMBER:return"family_nonpaying_member";case i.user_survey.SkuName.BASIC:return"basic";case i.user_survey.SkuName.TRANSFER:return"transfer";case i.user_survey.SkuName.PLUS:return"plus";case i.user_survey.SkuName.PROFESSIONAL:return"professional";case i.user_survey.SkuName.BUSINESS_ADVANCED:return"business_advanced";case i.user_survey.SkuName.BUSINESS_STANDARD:return"business_standard";case i.user_survey.SkuName.ENTERPRISE:return"enterprise";default:c.enforceExhaustive(e)}})(e.skuName)),w("isMobile",e.isMobile?"true":"false"),w("isPaidTeam",e.isPaidTeam?"true":"false"),w("isTeamAdmin",e.isTeamAdmin?"true":"false"),w("isCdm",e.isCdm?"true":"false"),w("isOver30DaysSinceAccountCreated",e.isOver_30DaysSinceAccountCreated?"true":"false"),w("isOver30DaysSinceJoinedTeam",e.isOver_30DaysSinceJoinedTeam?"true":"false"),w("accountAge",E(e.accountAge));var t=s.Viewer.get_viewer();w("isSignedIn",t.is_signed_in?"true":"false"),t.get_users().find((function(e){return e.is_dropbox_admin}))?w("isDropboxer","true"):O("isDropboxer"),e.familyData&&w("hasCompletedAllFamilyOnboarding",e.familyData.hasCompletedOnboarding?"true":"false"),y.forEach((function(e){return b.apply(void 0,e)})),y=[]})),window.addEventListener("message",A)}function b(e,t){var r=f||document&&document.getElementById("usersurvey-iframe"),n=g||r&&r.src;if(r&&r.contentWindow&&n){var i={eventType:e,eventData:t};r.contentWindow.postMessage(i,n)}else y.push([e,t])}var E=function(e){switch(e){case i.user_survey.AccountAge.UNKNOWN:return"unknown";case i.user_survey.AccountAge.UNDER_14_DAYS:return"under_14_days";case i.user_survey.AccountAge.FROM_14_DAYS_TO_30_DAYS:return"14_to_30_days";case i.user_survey.AccountAge.FROM_30_DAYS_TO_90_DAYS:return"30_to_90_days";case i.user_survey.AccountAge.FROM_90_DAYS_TO_1_YEAR:return"90_days_to_1_year";case i.user_survey.AccountAge.FROM_1_YEAR_TO_5_YEARS:return"1_to_5_years";case i.user_survey.AccountAge.OVER_5_YEARS:return"over_5_years";default:return"unknown"}};function h(e,t){var r="web_"+e;b("trackEvent",{eventName:r}),b("trackEvent",{eventName:r+"_from_"+t})}function w(e,t){b("addAttribute",{key:e,value:t})}function O(e){b("removeAttribute",{key:e})}t.UserSurvey={trackEvent:function(e,r){h(e,r),t.USER_SURVEY_AGGREGATE_EVENTS_MAP.forEach((function(t,n){for(var i=0,o=t;i<o.length;i++){var s=o[i];e===s.event&&s.eventSurface===r&&(b("trackEvent",{eventName:n}),h(n,r))}}))},addAttribute:w,addCallback:function(){},removeAttribute:O};var T={init:S,createIframe:function(e){var t=document.createElement("iframe");return t.src=e,t.setAttribute("sandbox","allow-scripts allow-same-origin allow-popups"),t.setAttribute("class","usersurvey-iframe"),t.setAttribute("id","usersurvey-iframe"),t.setAttribute("allowTransparency","true"),t.setAttribute("height","0"),t.setAttribute("width","0"),document.body.insertBefore(t,document.body.childNodes[0]),t},receiveMessage:A};t.InternalSurveyFunctionsForTestOnly=T,t.moduleInit=function(e){S(n.unpackProto(e,i.user_survey.UserSurveyInitData))}})),define("modules/clean/logging/hive/schemas/web-user_survey",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserSurveyLoggingTableRow=void 0;var r=function(e){this.category="web-user_survey",this.session_id=null,this.team_id=null,this.ua_browser_name=null,this.ua_browser_version=null,this.locale_user_selected=null,this.user_agent=null,this.active_user_id=null,this.user_id=null,this.event_name=e.event_name,this.user_survey_id=e.user_survey_id,this.extras=e.extras,Object.seal(this)};t.UserSurveyLoggingTableRow=r}));
//# sourceMappingURL=pkg-browse-uncommon.min.js-vfl5ipkTZ.map