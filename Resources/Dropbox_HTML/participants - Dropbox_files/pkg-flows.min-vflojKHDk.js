define("modules/clean/react/flows/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EXCLOG_TAG=t.FLOWS_STYLESHEETS=void 0,t.FLOWS_STYLESHEETS=["/static/css/spectrum/index.web-vflmHVRF-.css","/static/css/dig-components/index.web-vflx3F5Tv.css","/static/js/flows/index.web-vfl8ZX_si.css","/static/css/flows/flows-vflHfWgmI.css"],t.EXCLOG_TAG="dbx-owner:workflow-automation"})),define("modules/clean/react/flows/components/badge",["require","exports","tslib","react","dig-components/badges","react-intl","modules/clean/react/components/css","modules/clean/react/flows/constants","modules/core/i18n","dig-components/tooltips","modules/clean/react/flows/types","flows/common/constants"],(function(e,t,n,o,r,i,s,a,l,c,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlowsFolderBadge=t.FlowsFolderBadgeComponent=void 0,o=n.__importDefault(o),t.FlowsFolderBadgeComponent=function(e){var t,n=e.type,s=e.isInUnifiedModal,a=e.isFolderFocused,v=f(),p=v.autoPdfBadgeContent,_=v.autoPdfBadgeTooltip,g=v.autoUnzipBadgeContent,m=v.autoUnzipBadgeTooltip,w=v.unifiedModalContent,h=v.autoTagBadgeContent,b=v.autoTagBadgeTooltip,S=v.autoSmartSubfoldersBadgeContent,C=v.autoSmartSubfoldersBadgeTooltip,y=((t={})[u.FlowsRuleType.AutoPDF]={tooltip:_,content:p},t[u.FlowsRuleType.AutoUnzip]={tooltip:m,content:g},t[u.FlowsRuleType.AutoTag]={tooltip:b,content:h},t[u.FlowsRuleType.AutoSmartSubfolders]={tooltip:C,content:S},t),T=n===u.FlowsRuleType.None?void 0:y[n];return o.default.createElement(i.RawIntlProvider,{value:l.intl},T&&o.default.createElement(c.Tooltip,{id:"flows-badge-tooltip","data-testid":d.TestTarget.FLOWS_BADGE_TOOLTIP,title:T.tooltip,maxWidth:400},o.default.createElement("div",{className:"flows-badge","data-testid":d.TestTarget.FLOWS_BADGE,tabIndex:a?0:-1},o.default.createElement(r.AccessoryBadge,null,s?w:T.content))))};var f=function(){var e=i.useIntl();return{autoPdfBadgeContent:e.formatMessage({id:"J7Q2k7",defaultMessage:"Auto-PDF"}),autoPdfBadgeTooltip:e.formatMessage({id:"fsqHOb",defaultMessage:"Files added to this folder are automatically saved as PDFs."}),unifiedModalContent:e.formatMessage({id:"VWmNRn",defaultMessage:"Automated"}),autoUnzipBadgeContent:e.formatMessage({id:"ZrkK1J",defaultMessage:"Auto-unzip"}),autoUnzipBadgeTooltip:e.formatMessage({id:"7ZScv9",defaultMessage:"Zipped files added to this folder are automatically unzipped."}),autoTagBadgeContent:e.formatMessage({id:"86n5XF",defaultMessage:"Auto-tag"}),autoTagBadgeTooltip:e.formatMessage({id:"1VM5D6",defaultMessage:"Files added to this folder are automatically tagged"}),autoSmartSubfoldersBadgeContent:e.formatMessage({id:"fy7f50",defaultMessage:"Smart Subfolders"}),autoSmartSubfoldersBadgeTooltip:e.formatMessage({id:"apbbra",defaultMessage:"Files added to this folder are automatically sorted and moved to organized subfolders"})}};t.FlowsFolderBadge=s.requireCssWithComponent(t.FlowsFolderBadgeComponent,a.FLOWS_STYLESHEETS)})),define("modules/clean/react/flows/components/flows_browse_root",["require","exports","tslib","react","react-intl","modules/core/i18n","modules/clean/react/browse/data/selectors","react-redux","modules/clean/react/browse/data/action_creators/index","modules/clean/react/flows/lib/api","modules/clean/react/hooks/usePrevious","modules/clean/react/flows/components/badge","modules/clean/react/flows/types","react-dom","modules/clean/react/browse/models","modules/clean/filetypes","modules/clean/react/flows/utils/api_helpers","modules/clean/react/flows/types"],(function(e,t,n,o,r,i,s,a,l,c,u,d,f,v,p,_,g,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlowsRoot=t.FlowsRootComponent=void 0,o=n.__importStar(o),s=n.__importStar(s),l=n.__importStar(l),c=n.__importStar(c);var w={setFileHasAutomatedRuleMap:l.setFileHasAutomatedRuleMap,setFolderRulesConfig:l.setFlowsFolderRulesConfig};t.FlowsRootComponent=function(e){var t=e.unsortedFiles,n=e.setFileHasAutomatedRuleMap,s=e.path,a=e.titleBadgeSlot,l=e.flowsRule,w=e.expAutoPDFConversionBackendEnabled,h=e.expFlowsAutoUnzipLambdaEnabled,b=e.expFlowsAutomatedFolderUI,S=e.setFolderRulesConfig,C=u.usePrevious(t);o.useEffect((function(){var e=[];t.forEach((function(n,o){!n.is_dir||p.File.isNoAccessSharedFolder(n)||n.is_in_vault_folder||n.type===_.FileTypes.VAULT_FOLDER||(C?C.get(o)!==t.get(o)&&e.push(n.fq_path):e.push(n.fq_path))})),e.length>0&&c.getFolderRulesBatch(e).then((function(e){var t;if("folder_rule_batch_result"===(null===(t=null==e?void 0:e.get_rule_batch_result)||void 0===t?void 0:t[".tag"])){var o=null==e?void 0:e.get_rule_batch_result;if(o.folder_rule_results){var r=m.FlowsMap(o.folder_rule_results.map((function(e){var t,n,o,r;if(!e.err&&(null===(t=e.folder_rule_set)||void 0===t?void 0:t.rules)){var i=null===(n=e.folder_rule_set)||void 0===n?void 0:n.rules;if(i.length>0){var s=null===(r=null===(o=i[0].action)||void 0===o?void 0:o.action)||void 0===r?void 0:r[".tag"],a=s?g.APIV2_TAG_TO_RULE_TYPE[s]:f.FlowsRuleType.None;return[e.fq_path,a]}}return[e.fq_path,f.FlowsRuleType.None]})));n({fileHasAutomatedRuleMap:r})}}}))}),[t]),o.useEffect((function(){"/"!==s&&""!==s&&c.getFolderRules(s).then((function(e){var t,o,r,i,a;if("folder_rule_set"===(null===(o=null==e?void 0:e.get_rule_result)||void 0===o?void 0:o[".tag"])){var l=null===(r=e.get_rule_result)||void 0===r?void 0:r.rules;if(l&&l.length>0){var c=null===(a=null===(i=l[0].action)||void 0===i?void 0:i.action)||void 0===a?void 0:a[".tag"],u=c?g.APIV2_TAG_TO_RULE_TYPE[c]:f.FlowsRuleType.None;n({fileHasAutomatedRuleMap:m.FlowsMap((t={},t[s]=u,t))})}}}),(function(e){}))}),[s]),o.useEffect((function(){S({status:"pending"}),c.getFolderRulesConfig().then((function(e){var t;S({data:(null===(t=e.folder_rules_config)||void 0===t?void 0:t.actions)||[],status:"completed"})}),(function(e){S({error:e.toString(),status:"errored"})}))}),[]);var y=l===f.FlowsRuleType.AutoPDF&&w||l===f.FlowsRuleType.AutoUnzip&&h||null!=l&&l!==f.FlowsRuleType.None&&b;return o.default.createElement(r.RawIntlProvider,{value:i.intl},a.current&&l&&y&&v.createPortal(o.default.createElement(d.FlowsFolderBadge,{type:l,isInUnifiedModal:!!b,isFolderFocused:!0}),a.current))};var h=a.connect((function(e,t){return{unsortedFiles:s.unsortedFiles(e),flowsRule:s.flowsFolderRule(e,t.path)}}),w);t.FlowsRoot=h(t.FlowsRootComponent)})),define("modules/clean/react/flows/conversions/actions/convert_image_format",["require","exports","tslib","modules/clean/react/flows/conversions/convert","modules/clean/react/flows/conversions/api","modules/clean/react/flows/conversions/utils","dig-components/icons/src"],(function(e,t,n,o,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConvertImageFormatActions=void 0;var a=["bmp","gif","j2c","j2k","jp2","jpc","jpeg","jpf","jpg","jpg2","jpm","jpx","png","ppm","tga","tif","tiff","wbmp","webp"],l={jpg:a.filter((function(e){return"jpg"!==e&&"jpeg"!==e})),png:a.filter((function(e){return"png"!==e}))};t.ConvertImageFormatActions=Object.entries(l).map((function(e){var t=e[0],a=e[1];return{actionText:t.toUpperCase(),actionIcon:s.ImageLine,selector:i.singleFileWithExtensionSelector(a),convert:function(e,s,a){return o.convertFileAndShowSnackbar({file:e[0],user:s,shareToken:a,loggingFunctions:i.getConversionLoggingFunctions("convert_image_format"),getStrings:function(e){return i.getDefaultConversionStrings(t.toUpperCase(),e)},conversionFn:function(e,o,s){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return[4,r.convertImageFormat(o.id,i.getFileIdentifier(e,s),t)];case 1:return[2,n.sent().path]}}))}))}})}}}))})),define("modules/clean/react/flows/conversions/actions/convert_doc_to_image",["require","exports","tslib","modules/clean/react/flows/conversions/convert","modules/clean/react/flows/conversions/api","modules/clean/react/flows/conversions/utils","dig-components/icons/src"],(function(e,t,n,o,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConvertDocToImageActions=void 0;var a=["ai","azw4","binder","djvu","doc","docm","docx","dwg","eps","epub","gdoc","gslides","mobi","odp","odt","paper","papert","pps","ppsm","ppsx","ppt","pptm","pptx","ps","rtf","wpd","pdf"];t.ConvertDocToImageActions=["jpg","png"].map((function(e){return{actionText:e.toUpperCase(),actionIcon:s.ImageLine,selector:i.singleFileWithExtensionSelector(a),convert:function(t,s,a){return o.convertFileAndShowSnackbar({file:t[0],user:s,shareToken:a,loggingFunctions:i.getConversionLoggingFunctions("convert_doc_to_image"),getStrings:function(t){return i.getDefaultConversionStrings(e.toUpperCase(),t)},conversionFn:function(t,o,s){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return[4,r.convertDocToImage(o.id,i.getFileIdentifier(t,s),e)];case 1:return[2,n.sent().path]}}))}))}})}}}))})),define("modules/clean/react/flows/conversions/actions/convert_to_pdf",["require","exports","tslib","modules/clean/react/flows/conversions/convert","modules/clean/react/flows/conversions/api","modules/clean/react/flows/conversions/utils","dig-components/icons/src"],(function(e,t,n,o,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canConvertToPdfExcludingImages=t.ConvertToPdfAction=t.SUPPORTED_PDF_EXTENSIONS=void 0;var a=["ai","azw4","binder","djvu","doc","docm","docx","dwg","eps","epub","gdoc","gslides","mobi","odp","odt","paper","papert","pps","ppsm","ppsx","ppt","pptm","pptx","ps","rtf","wpd"];t.SUPPORTED_PDF_EXTENSIONS=a.concat(["bmp","j2c","j2k","jp2","jpc","jpeg","jpf","jpg","jpg2","jpm","jpx","png","ppm","tga","tif","tiff"]),t.ConvertToPdfAction={actionText:"PDF",actionIcon:s.FileLine,selector:i.singleFileWithExtensionSelector(t.SUPPORTED_PDF_EXTENSIONS),convert:function(e,t,s){return o.convertFileAndShowSnackbar({file:e[0],user:t,shareToken:s,loggingFunctions:i.getConversionLoggingFunctions("convert_to_pdf"),getStrings:function(e){return i.getDefaultConversionStrings("PDF",e)},conversionFn:function(e,t,o){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return[4,r.convertToPdf(t.id,i.getFileIdentifier(e,o))];case 1:return[2,n.sent().path]}}))}))}})}},t.canConvertToPdfExcludingImages=function(e){return i.singleFileWithExtensionSelector(a)([e])}})),define("modules/clean/react/flows/conversions/actions/unzip",["require","exports","tslib","modules/core/i18n","modules/clean/react/flows/conversions/convert","modules/clean/react/flows/conversions/api","modules/clean/react/flows/conversions/utils","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/file_preview_event_emitter","modules/clean/react/file_viewer/models","modules/clean/react/app_actions/telemetry_client","dig-components/icons/src"],(function(e,t,n,o,r,i,s,a,l,c,u,d,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnzipAction=t.SUPPORTED_UNZIP_EXTENSIONS=void 0;t.SUPPORTED_UNZIP_EXTENSIONS=["7z","bz","bz2","cpio","gz","iso","lha","lz","lzh","lzma","rar","tar","taz","tbz","tbz2","tgz","tlz","txz","tz","xar","xz","z","zip"],t.UnzipAction={actionText:o.intl.formatMessage({id:"u1R/iY",defaultMessage:"Extract all"}),actionIcon:f.ZipLine,selector:s.singleFileWithExtensionSelector(t.SUPPORTED_UNZIP_EXTENSIONS),convert:function(e,t,o){return r.convertFileAndShowSnackbar({file:e[0],user:t,shareToken:o,loggingFunctions:p,getStrings:_,conversionFn:function(e,t,o){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return[4,i.unzip(t.id,s.getFileIdentifier(e,o))];case 1:return[2,n.sent().path]}}))}))}})}};var v=function(){return{previewSession:u.FilePreviewSession.currentSession,browseSession:d.createTelemetryClient({component:"decompress_action"}).session()}},p={logConvert:function(){var e=v(),t=e.previewSession,n=e.browseSession;t?c.filePreviewEventEmitter.emit(l.EventType.DecompressInitiated,t):n.event(l.EventType.DecompressInitiated)},logConvertRetry:function(){var e=v(),t=e.previewSession,n=e.browseSession;t?a.logUserAction(l.UserAction.DecompressRetry,l.UserActionContext.Snackbar):n.event(l.UserAction.DecompressRetry,{context:l.UserActionContext.Snackbar})},logConvertOpen:function(){var e=v(),t=e.previewSession,n=e.browseSession;t?a.logUserAction(l.UserAction.GoToFolder,l.UserActionContext.Snackbar):n.event(l.UserAction.GoToFolder,{context:l.UserActionContext.Snackbar})},logConvertClose:function(){var e=v(),t=e.previewSession,n=e.browseSession;t?a.logUserAction(l.UserAction.DecompressCloseSnackbar,l.UserActionContext.Snackbar):n.event(l.UserAction.DecompressCloseSnackbar,{context:l.UserActionContext.Snackbar})}},_=function(e){var t=o.intl.formatMessage({id:"gJnC96",defaultMessage:"Couldn't extract files"});return{saving:o.intl.formatMessage({id:"Jk+n/I",defaultMessage:"Extracting files..."}),success:s.getSuccessString(e,(function(e,t){return o.intl.formatMessage({id:"Hz2NSj",defaultMessage:"Files extracted to {folderName} in {parentFolderName} folder"},{folderName:e,parentFolderName:t})}),(function(e){return o.intl.formatMessage({id:"TRohxO",defaultMessage:"Files extracted to {folderName} in your main Dropbox folder"},{folderName:e})})),failGeneric:t,failRetryable:t,failOverQuota:o.intl.formatMessage({id:"atcchQ",defaultMessage:"Couldn't extract because your Dropbox account is out of space"}),failTooLarge:o.intl.formatMessage({id:"Hgd1fQ",defaultMessage:"Couldn't extract files. Can only handle files up to {fileSize} MB"},{fileSize:512}),failCorrupt:o.intl.formatMessage({id:"00qMd1",defaultMessage:"Couldn't extract because the file is damaged"}),failPassword:o.intl.formatMessage({id:"xbgxEF",defaultMessage:"Couldn't extract because the file is password protected"}),failPasswordLink:o.intl.formatMessage({id:"UvS9P9",defaultMessage:"Couldn't extract because the file was shared using a password-protected link"})}}})),define("modules/clean/react/flows/conversions/api",["require","exports","tslib","api_v2/user_client","modules/clean/react/flows/conversions/utils","modules/clean/downloads"],(function(e,t,n,o,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mediaRemux=t.archive=t.convertDocToImage=t.convertImageFormat=t.unzip=t.convertToPdf=void 0,t.convertToPdf=function(e,t,n){var r={file:t,dest_path:n};return(new o.UserApiV2Client).ns("flows").rpc("convert_to_pdf",r,{subjectUserId:e})},t.unzip=function(e,t,n){var r={file:t,dest_path:n};return(new o.UserApiV2Client).ns("flows").rpc("unzip",r,{subjectUserId:e})},t.convertImageFormat=function(e,t,n,r){var i={file:t,format:n,dest_path:r};return(new o.UserApiV2Client).ns("flows").rpc("convert_image_format",i,{subjectUserId:e})},t.convertDocToImage=function(e,t,n,r){var i={file:t,format:n,dest_path:r};return(new o.UserApiV2Client).ns("flows").rpc("convert_doc_to_image",i,{subjectUserId:e})},t.archive=function(e,t,s,a,l){return n.__awaiter(this,void 0,Promise,(function(){var c,u,d,f,v;return n.__generator(this,(function(n){switch(n.label){case 0:return a&&a.blockHash?(c=a.currentFQPath,u=t.map((function(e){return e.fq_path})),[4,i.getZipDownloadUrl({block_hash:a.blockHash,fq_paths:u,parent_path:c,subjectUserId:e,flat_mode:!1})]):[3,2];case 1:return(d=n.sent()).isError?(i.showGetZipUrlErrorSnackbar(d.error),[2,Promise.resolve({path:void 0})]):(f=t.map((function(e){return r.getFileIdentifier(e)})),s=s||"archive.zip",v={file:f,dest_path:l,zip_url:d.result.url,archive_name:s},[2,(new o.UserApiV2Client).ns("flows").rpc("archive",v,{subjectUserId:e})]);case 2:return[2,Promise.resolve({path:void 0})]}}))}))},t.mediaRemux=function(e,t,n,r){var i={file:t,dest_path:r,container:n};return(new o.UserApiV2Client).ns("flows").rpc("media_remux",i,{subjectUserId:e})}})),define("modules/clean/react/flows/conversions/conversion_actions",["require","exports","tslib","modules/clean/react/flows/conversions/actions/convert_to_pdf","modules/clean/react/flows/conversions/actions/convert_image_format","modules/clean/react/flows/conversions/actions/convert_doc_to_image","modules/clean/react/flows/conversions/actions/media_remux"],(function(e,t,n,o,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getConversionActionsForFiles=void 0;var a=n.__spreadArrays([o.ConvertToPdfAction],r.ConvertImageFormatActions,i.ConvertDocToImageActions,s.MediaRemuxActions);t.getConversionActionsForFiles=function(e,t){return a.filter((function(n){return n.selector(e,t)}))}})),define("modules/clean/react/flows/conversions/convert",["require","exports","tslib","modules/core/i18n","react","modules/clean/react/snackbar","modules/clean/browse_uri_interface","modules/core/uri","modules/core/browser","modules/clean/react/flows/conversions/utils"],(function(e,t,n,o,r,i,s,a,l,c){"use strict";function u(e){return n.__awaiter(this,void 0,void 0,(function(){var t,o,r,i,s,a,l;return n.__generator(this,(function(u){switch(u.label){case 0:t=e.file,o=e.user,r=e.shareToken,i=e.conversionFn,e.loggingFunctions.logConvert(),d(n.__assign(n.__assign({},e),{state:"saving"})),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,i(t,o,r)];case 2:return d((s=u.sent())?n.__assign(n.__assign({},e),{state:"success",resultPath:s}):n.__assign(n.__assign({},e),{state:"failGeneric"})),[3,4];case 3:return a=u.sent(),l=c.getConversionStateFromException(a),d(n.__assign(n.__assign({},e),{state:l})),[3,4];case 4:return[2]}}))}))}function d(e){var t=e.user,c=e.getStrings,d=e.state,f=e.resultPath,v=e.loggingFunctions,p=n.__assign(n.__assign({},c(f||"")),{open:o.intl.formatMessage({id:"+JIEsO",defaultMessage:"Open"}),close:o.intl.formatMessage({id:"In8b64",defaultMessage:"Close"}),retry:o.intl.formatMessage({id:"Y/tkCj",defaultMessage:"Try again"})}),_={closeButtonText:p.close,onCloseClick:v.logConvertClose},g={saving:{variant:"sync",syncProgressLoop:!0},failGeneric:n.__assign({variant:"fail"},_),failOverQuota:n.__assign({variant:"fail"},_),failTooLarge:n.__assign({variant:"fail"},_),failCorrupt:n.__assign({variant:"fail"},_),failPassword:n.__assign({variant:"fail"},_),failPasswordLink:n.__assign({variant:"fail"},_),failRetryable:n.__assign({variant:"fail",onActionClick:function(){v.logConvertRetry(),u(e)}},_),success:n.__assign({variant:"complete",actionButtonText:p.open,onActionClick:function(){return(function(e,t,n){n.logConvertOpen();var o=t,r=s.get_browse_root(e)+a.URI.encode_parts(o);l.replace_location(r)})(t,f,v)}},_)};i.Snackbar.update(r.default.createElement(i.Snackbar,n.__assign({id:"flows-conversion-snackbar",title:p[d]},g[d])))}Object.defineProperty(t,"__esModule",{value:!0}),t.convertFileAndShowSnackbar=void 0,r=n.__importDefault(r),l=n.__importStar(l),t.convertFileAndShowSnackbar=u})),define("modules/clean/react/flows/conversions/utils",["require","exports","tslib","modules/core/i18n","modules/clean/file_store/utils","spectrum-sharing/utils/sharing_constants","modules/clean/file_store/utils","modules/clean/filepath/filepath","modules/clean/hql/index","dropbox/proto/hql_events/flows/manual_file_conversion","dropbox/proto/hql_events/extensions","dropbox/proto/hql_events/taxonomy","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/models","modules/clean/react/app_actions/telemetry_client"],(function(e,t,n,o,r,i,s,a,l,c,u,d,f,v,p,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getConversionLoggingFunctions=t.getDefaultConversionStrings=t.getSuccessString=t.singleFileWithExtensionSelector=t.canConvertFile=t.getConversionStateFromException=t.getFileIdentifier=void 0,a=n.__importStar(a),t.getFileIdentifier=function(e,t){return r.isBrowseFile(e)||(null==t?void 0:t.linkType)===i.SharedLinkType.Content?{identifier:{file_id:e.file_id,".tag":"file_id"}}:{identifier:{shared_link_url:e.href?e.href:"",".tag":"shared_link_url"}}};var g={generic_error:"failGeneric",permission_error:"failGeneric",unsupported_error:"failGeneric",filesystem_error:"failGeneric",filesystem_transient_error:"failRetryable",over_quota_error:"failOverQuota",riviera_permanent_error:"failGeneric",riviera_retryable_error:"failRetryable",riviera_too_large_error:"failTooLarge",riviera_source_corrupt_error:"failCorrupt",riviera_password_protected_error:"failPassword",password_protected_shared_link_error:"failPasswordLink",riviera_invalid_request_error:"failGeneric",other:"failGeneric"};function m(e,t,n){var o=a.filename(e),r=a.parentDirName(e);return r?t(o,r):n(o)}t.getConversionStateFromException=function(e){var t=null==e?void 0:e.error;return(function(e){return e&&e[".tag"]&&e[".tag"]in g})(t)?g[t[".tag"]]:"failGeneric"},t.canConvertFile=function(e,t){return r.isBrowseFile(e)||t&&t.canDownloadRoles.length>0},t.singleFileWithExtensionSelector=function(e){return function(t){if(1!==t.length||t[0].is_dir)return!1;var n=s.getExtension(t[0]);return e.includes(n)}},t.getSuccessString=m,t.getDefaultConversionStrings=function(e,t){var n=o.intl.formatMessage({id:"WthXj+",defaultMessage:"Couldn't save as {fileType}"},{fileType:e});return{saving:o.intl.formatMessage({id:"Bdb4J5",defaultMessage:"Saving {fileType}..."},{fileType:e}),success:m(t,(function(e,t){return o.intl.formatMessage({id:"HwR61n",defaultMessage:"{fileName} saved to {dirName} folder"},{fileName:e,dirName:t})}),(function(e){return o.intl.formatMessage({id:"ukwwi2",defaultMessage:"{fileName} saved to your main Dropbox folder"},{fileName:e})})),failGeneric:n,failRetryable:n,failOverQuota:o.intl.formatMessage({id:"QP2WHb",defaultMessage:"Couldn't save as {fileType} because your Dropbox account is out of space"},{fileType:e}),failTooLarge:o.intl.formatMessage({id:"cmnQAC",defaultMessage:"Couldn't save as {fileType} because the file is too large"},{fileType:e}),failCorrupt:o.intl.formatMessage({id:"INKSmo",defaultMessage:"Couldn't save as {fileType} because the file is damaged"},{fileType:e}),failPassword:o.intl.formatMessage({id:"dnnNdt",defaultMessage:"Couldn't save as {fileType} because the file is password protected"},{fileType:e}),failPasswordLink:o.intl.formatMessage({id:"qzTamN",defaultMessage:"Couldn't save as {fileType} because the file was shared using a password-protected link"},{fileType:e})}},t.getConversionLoggingFunctions=function(e){var t=d.hql_events.TaxonomyAppSurface.AppSurface,n=d.hql_events.TaxonomyActionSurface.ActionSurface,o=function(){return{previewSession:p.FilePreviewSession.currentSession,browseSession:_.createTelemetryClient({component:"file_conversion"}).session()}};return{logConvert:function(){l.logEvent(c.hql_events.SelectConversion.create({conversionType:e,hqlMetadata:u.hql_events.HQLMetadata.create({appSurface:t.WEB,actionSurface:n.BROWSER_WINDOW})}));var r=o(),i=r.previewSession,s=r.browseSession;i?f.logUserAction(v.UserAction.FileConversionInitiated,v.UserActionContext.Snackbar,{conversion_type:e}):s.event(v.UserAction.FileConversionInitiated,{conversion_type:e})},logConvertRetry:function(){l.logEvent(c.hql_events.SelectConversionRetry.create({conversionType:e,hqlMetadata:u.hql_events.HQLMetadata.create({appSurface:t.WEB,actionSurface:n.BROWSER_WINDOW})}));var r=o(),i=r.previewSession,s=r.browseSession;i?f.logUserAction(v.UserAction.FileConversionRetry,v.UserActionContext.Snackbar,{conversion_type:e}):s.event(v.UserAction.FileConversionRetry,{context:v.UserActionContext.Snackbar,conversion_type:e})},logConvertClose:function(){l.logEvent(c.hql_events.SelectConversionCloseClick.create({conversionType:e,hqlMetadata:u.hql_events.HQLMetadata.create({appSurface:t.WEB,actionSurface:n.BROWSER_WINDOW})}));var r=o(),i=r.previewSession,s=r.browseSession;i?f.logUserAction(v.UserAction.FileConversionCloseSnackbar,v.UserActionContext.Snackbar,{conversion_type:e}):s.event(v.UserAction.FileConversionCloseSnackbar,{context:v.UserActionContext.Snackbar,conversion_type:e})},logConvertOpen:function(){l.logEvent(c.hql_events.SelectConversionOpenClick.create({conversionType:e,hqlMetadata:u.hql_events.HQLMetadata.create({appSurface:t.WEB,actionSurface:n.BROWSER_WINDOW})}));var r=o(),i=r.previewSession,s=r.browseSession;i?f.logUserAction(v.UserAction.GoToFolder,v.UserActionContext.Snackbar,{conversion_type:e}):s.event(v.UserAction.GoToFolder,{context:v.UserActionContext.Snackbar,conversion_type:e})}}}})),define("dropbox/proto/hql_events/flows/manual_file_conversion",["require","exports","tslib","protobufjs/minimal","dropbox/proto/hql_events/extensions"],(function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.hql_events=void 0;var r,i=(o=n.__importStar(o)).Reader,s=o.Writer,a=(o.util,o.roots.default||(o.roots.default={}));t.default=a,t.hql_events=a.hql_events=((r=a.hql_events||{}).SelectConversion=(function(e){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversionType="",e.prototype.hqlMetadata=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.conversionType&&Object.hasOwnProperty.call(e,"conversionType")&&t.uint32(10).string(e.conversionType),null!=e.hqlMetadata&&Object.hasOwnProperty.call(e,"hqlMetadata")&&a.hql_events.HQLMetadata.encode(e.hqlMetadata,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,o=new a.hql_events.SelectConversion;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversionType=e.string();break;case 2:o.hqlMetadata=a.hql_events.HQLMetadata.decode(e,e.uint32());break;default:e.skipType(7&r)}}return o},e.getTypeUrl=function(){return"type.googleapis.com/hql_events.SelectConversion"},e})(r.SelectConversion||{}),r.SelectConversionRetry=(function(e){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversionType="",e.prototype.hqlMetadata=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.conversionType&&Object.hasOwnProperty.call(e,"conversionType")&&t.uint32(10).string(e.conversionType),null!=e.hqlMetadata&&Object.hasOwnProperty.call(e,"hqlMetadata")&&a.hql_events.HQLMetadata.encode(e.hqlMetadata,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,o=new a.hql_events.SelectConversionRetry;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversionType=e.string();break;case 2:o.hqlMetadata=a.hql_events.HQLMetadata.decode(e,e.uint32());break;default:e.skipType(7&r)}}return o},e.getTypeUrl=function(){return"type.googleapis.com/hql_events.SelectConversionRetry"},e})(r.SelectConversionRetry||{}),r.SelectConversionCloseClick=(function(e){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversionType="",e.prototype.hqlMetadata=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.conversionType&&Object.hasOwnProperty.call(e,"conversionType")&&t.uint32(10).string(e.conversionType),null!=e.hqlMetadata&&Object.hasOwnProperty.call(e,"hqlMetadata")&&a.hql_events.HQLMetadata.encode(e.hqlMetadata,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,o=new a.hql_events.SelectConversionCloseClick;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversionType=e.string();break;case 2:o.hqlMetadata=a.hql_events.HQLMetadata.decode(e,e.uint32());break;default:e.skipType(7&r)}}return o},e.getTypeUrl=function(){return"type.googleapis.com/hql_events.SelectConversionCloseClick"},e})(r.SelectConversionCloseClick||{}),r.SelectConversionOpenClick=(function(e){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.conversionType="",e.prototype.hqlMetadata=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.conversionType&&Object.hasOwnProperty.call(e,"conversionType")&&t.uint32(10).string(e.conversionType),null!=e.hqlMetadata&&Object.hasOwnProperty.call(e,"hqlMetadata")&&a.hql_events.HQLMetadata.encode(e.hqlMetadata,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){e instanceof i||(e=i.create(e));for(var n=void 0===t?e.len:e.pos+t,o=new a.hql_events.SelectConversionOpenClick;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:o.conversionType=e.string();break;case 2:o.hqlMetadata=a.hql_events.HQLMetadata.decode(e,e.uint32());break;default:e.skipType(7&r)}}return o},e.getTypeUrl=function(){return"type.googleapis.com/hql_events.SelectConversionOpenClick"},e})(r.SelectConversionOpenClick||{}),r)})),define("modules/clean/react/file_viewer/file_conversion/convert_to_pdf_button",["require","exports","tslib","react","dig-components/buttons","dig-components/icons","dig-components/icons/src","modules/core/i18n","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/constants","modules/clean/react/flows/conversions/actions/convert_to_pdf"],(function(e,t,n,o,r,i,s,a,l,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConvertToPdfButton=void 0,o=n.__importStar(o),t.ConvertToPdfButton=function(e){var t=e.file,d=e.user,f=e.shareToken,v=o.useState(!1),p=v[0],_=v[1];return o.default.createElement(r.Button,{style:{margin:"12px 25px"},variant:"opacity",size:"large",onClick:function(){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return _(!0),l.logUserAction(c.UserAction.ConvertToPdf,c.UserActionContext.PreviewContentMain),[4,u.ConvertToPdfAction.convert([t],d,f)];case 1:return e.sent(),_(!1),[2]}}))}))},disabled:p,withIconLeft:o.default.createElement(i.UIIcon,{src:s.FileLine})},a.intl.formatMessage({id:"Xlc8yC",defaultMessage:"Save as PDF"}))}})),define("modules/clean/react/file_viewer/file_conversion/save_as_button",["require","exports","tslib","react","dig-components/buttons","dig-components/icons","dig-components/icons/src","dig-components/menu","modules/clean/react/flows/conversions/conversion_actions","modules/core/i18n","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/constants"],(function(e,t,n,o,r,i,s,a,l,c,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SaveAsButton=void 0,o=n.__importDefault(o),t.SaveAsButton=function(e){var t=e.file,f=e.user,v=e.shareToken,p=e.experiments,_=l.getConversionActionsForFiles([t],p);return 0===_.length?null:o.default.createElement(a.Menu.Wrapper,null,(function(e){var l=e.getTriggerProps,p=e.getContentProps;return o.default.createElement(o.default.Fragment,null,o.default.createElement(r.Button,n.__assign({className:"flows_save_as_button",style:{margin:"12px 25px"},variant:"opacity",withIconLeft:o.default.createElement(i.UIIcon,{src:s.AddFileLine}),withDropdownIcon:!0},l()),c.intl.formatMessage({id:"NXcki+",defaultMessage:"Save as..."})),o.default.createElement(a.Menu.Content,n.__assign({},p()),o.default.createElement(a.Menu.Segment,null,_.map((function(e){return o.default.createElement(a.Menu.ActionItem,{key:e.actionText,onClick:function(){u.logUserAction(d.UserAction.ConvertFile,d.UserActionContext.PreviewContentMain,{action:e.actionText}),e.convert([t],f,v)}},o.default.createElement("div",{style:{display:"flex"}},o.default.createElement(i.UIIcon,{src:e.actionIcon}),e.actionText))})))))}))}})),define("modules/clean/react/file_viewer/file_conversion/unzip_button",["require","exports","tslib","react","dig-components/buttons","modules/core/i18n","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/constants","modules/clean/react/flows/conversions/actions/unzip"],(function(e,t,n,o,r,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnzipButton=void 0,o=n.__importStar(o),t.UnzipButton=function(e){var t=e.file,c=e.user,u=e.shareToken,d=o.useState(!1),f=d[0],v=d[1];return o.default.createElement(r.Button,{className:"decompress-button",variant:"outline",onClick:function(){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return v(!0),s.logUserAction(a.UserAction.DecompressFile,a.UserActionContext.PreviewContentMain),[4,l.UnzipAction.convert([t],c,u)];case 1:return e.sent(),v(!1),[2]}}))}))},disabled:f},i.intl.formatMessage({id:"rFpkYN",defaultMessage:"Extract all"}))}})),define("modules/clean/react/file_viewer/file_conversion/utils",["require","exports","tslib","react","modules/clean/file_store/utils","modules/constants/file_viewer","modules/clean/react/file_viewer/file_conversion/save_as_button","modules/clean/react/file_viewer/file_conversion/convert_to_pdf_button","modules/clean/react/flows/conversions/utils","modules/clean/react/flows/conversions/actions/unzip","modules/clean/react/flows/conversions/actions/convert_to_pdf","modules/clean/react/file_viewer/file_conversion/unzip_button"],(function(e,t,n,o,r,i,s,a,l,c,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getConversionsForPreview=t.isManualVideoGifEnabled=t.isManualVideoRemuxingEnabled=t.isManualFileConversionEnabled=t.isManualPdfConversionEnabled=void 0,o=n.__importDefault(o),t.isManualPdfConversionEnabled=function(e){return!!(e&&i.MANUAL_PDF_CONVERSION_BY_USER_ID&&i.MANUAL_PDF_CONVERSION_BY_USER_ID[e.id])},t.isManualFileConversionEnabled=function(e){return!!(e&&i.MANUAL_FILE_CONVERSION_BY_USER_ID&&i.MANUAL_FILE_CONVERSION_BY_USER_ID[e.id])},t.isManualVideoRemuxingEnabled=function(e){return!!(e&&i.MANUAL_VIDEO_REMUX_BY_USER_ID&&i.MANUAL_VIDEO_REMUX_BY_USER_ID[e.id])},t.isManualVideoGifEnabled=function(e){return!!(e&&i.MANUAL_VIDEO_GIF_BY_USER_ID&&i.MANUAL_VIDEO_GIF_BY_USER_ID[e.id])},t.getConversionsForPreview=function(e,n,i,f){if(!n||r.isArchiveFile(e)||!l.canConvertFile(e,f))return null;if(c.UnzipAction.selector([e]))return o.default.createElement("div",null,o.default.createElement(d.UnzipButton,{user:n,file:e,shareToken:i}));if(t.isManualFileConversionEnabled(n)){var v={expFlowsManualVideoRemuxUi:t.isManualVideoRemuxingEnabled(n),expFlowsManualVideoGifUi:t.isManualVideoGifEnabled(n)};return o.default.createElement("div",null,o.default.createElement(s.SaveAsButton,{user:n,file:e,shareToken:i,experiments:v}))}return t.isManualPdfConversionEnabled(n)&&u.canConvertToPdfExcludingImages(e)?o.default.createElement("div",null,o.default.createElement(a.ConvertToPdfButton,{user:n,file:e,shareToken:i})):null}})),define("modules/clean/logging/hive/schemas/web-app_actions_telemetry",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppActionsTelemetryRow=void 0;var n=function(e){this.category="web-app_actions_telemetry",this.user_id=null,this.session_id=null,this.request_id=null,this.url=null,this.telemetry_session_id=e.telemetry_session_id,this.event_name=e.event_name,this.event_start_ts=e.event_start_ts,this.event_extras=e.event_extras,Object.seal(this)};t.AppActionsTelemetryRow=n})),define("modules/clean/react/app_actions/telemetry_client",["require","exports","tslib","modules/clean/logging/telemetry","modules/clean/logging/hive/schemas/web-app_actions_telemetry"],(function(e,t,n,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPiiSafeExtension=t.createTelemetryClient=t.TelemetryClient=t.Session=void 0,o=n.__importStar(o);var i=(function(){function e(t,n){this.logger=t,this.context=n,this.sessionId=e.generateRandomId()}return e.generateRandomId=function(){return Math.random().toString(36).substring(2)},e.getCurrentTimestamp=function(){return(new Date).getTime()},e.prototype.event=function(t,o){var i=e.getCurrentTimestamp(),s=n.__assign(n.__assign({},this.context),o),a=new r.AppActionsTelemetryRow({telemetry_session_id:this.sessionId,event_name:t,event_start_ts:i,event_extras:JSON.stringify(s)});this.logger.log(a)},e})();t.Session=i;var s=(function(){function e(e,t){this.logger=e,this.context=t||{}}return e.prototype.session=function(e){var t=n.__assign(n.__assign({},this.context),e);return new i(this.logger,t)},e})();t.TelemetryClient=s;var a=new o.HiveLogger;t.createTelemetryClient=function(e){return new s(a,e)};var l=(function(e){for(var t={},n=0,o=e;n<o.length;n++){t[o[n]]=!0}return t})(["",".doc",".docx",".pdf",".dwg",".png",".jpg",".jpeg",".tiff",".m4v",".wmv",".mpg",".pptx",".xlsx",".pages",".numbers",".key"]);t.getPiiSafeExtension=function(e){return l[e]?e:"__REDACTED__"}})),define("modules/clean/react/flows/conversions/actions/media_remux",["require","exports","tslib","modules/clean/react/flows/conversions/convert","modules/clean/react/flows/conversions/api","modules/clean/react/flows/conversions/utils","dig-components/icons/src"],(function(e,t,n,o,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaRemuxActions=t.SUPPORTED_VIDEO_OUTPUT_CONTAINERS=void 0;var a=["mov","mp4","avi","mkv","mpeg"];t.SUPPORTED_VIDEO_OUTPUT_CONTAINERS=["mp4","mov"];t.MediaRemuxActions=t.SUPPORTED_VIDEO_OUTPUT_CONTAINERS.map((function(e){return{actionText:e.toUpperCase(),actionIcon:s.VideoLine,selector:function(t,n){var o=i.singleFileWithExtensionSelector(a.filter((function(t){return t!==e}))),r=!!n&&n.expFlowsManualVideoRemuxUi;return o(t)&&r},convert:function(t,s,a){return o.convertFileAndShowSnackbar({file:t[0],user:s,shareToken:a,loggingFunctions:i.getConversionLoggingFunctions("media_remux"),getStrings:function(t){return i.getDefaultConversionStrings(e.toUpperCase(),t)},conversionFn:function(t,o,s){return n.__awaiter(void 0,void 0,void 0,(function(){return n.__generator(this,(function(n){switch(n.label){case 0:return[4,r.mediaRemux(o.id,i.getFileIdentifier(t,s),e)];case 1:return[2,n.sent().path]}}))}))}})}}}))}));
//# sourceMappingURL=pkg-flows.min.js-vflP4nBT1.map