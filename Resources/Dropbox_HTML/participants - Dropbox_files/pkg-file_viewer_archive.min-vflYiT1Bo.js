define("modules/clean/react/previews/archive/api",["require","exports","tslib","lodash","modules/clean/react/previews/archive/constants","api_v2/user_client","api_v2/noauth_client","modules/clean/filepath/filepath","modules/core/exception"],(function(e,t,r,n,o,i,a,s,l){"use strict";function c(e){return{name:e.name,size:void 0!==e.size?parseInt(e.size,10):void 0,isDir:e.isDir,children:e.children?(t=e.children,n.keyBy(n.values(t.map(c)),"name")):{}};var t}function d(e){var t=s.file_extension(e);if(!o.COMPRESSED_EXTENSIONS.includes(t))return!1;var r=s.filename_without_extension(e),n=s.file_extension(r);return!o.COMPRESSED_CONTAINER_EXTENSIONS.includes(n)}function u(e){return{isDir:!0,isEncrypted:!1,children:[{isDir:!1,isEncrypted:!1,name:s.filename_without_extension(e)}],name:"/",size:"0"}}Object.defineProperty(t,"__esModule",{value:!0}),t.fetchArchiveFiles=t.fetchRootArchiveEntry=t.generateRootArchiveEntry=t.shouldMockRootArchiveEntry=void 0,n=r.__importStar(n),o=r.__importStar(o),s=r.__importStar(s),l=r.__importStar(l),t.shouldMockRootArchiveEntry=d,t.generateRootArchiveEntry=u,t.fetchRootArchiveEntry=function(e){return new Promise((function(t,r){var n=function(e){var r;t({rootEntry:c(r=e),isPasswordProtected:!!r.isEncrypted})};if(d(e.filename)){var o=u(e.filename);n(o)}else{var i=new XMLHttpRequest;i.open("GET",e.url),i.withCredentials=!0,i.onreadystatechange=function(){if(i.readyState===XMLHttpRequest.DONE)if(200===i.status){var e=i.response,t=JSON.parse(e);n(t)}else{l.reportException({err:new Error("Failed to retrieve entry tree"),tags:["archivePreviews"],severity:l.SEVERITY.NONCRITICAL}),r("Failed to retrieve entry tree")}},i.send()}}))},t.fetchArchiveFiles=function(e){var t=e.rootFile,r=e.subpathInfos,o=e.user,s=e.sharedLinkUrl,l={root_file_info:{ns_id:t.ns_id,sj_id:t.sjid,url:s},subpaths:r.map((function(e){return e.subpath})),subpath_sizes:r.some((function(e){return void 0===e.size}))?void 0:r.map((function(e){return e.size}))};return(o?(new i.UserApiV2Client).ns("previews").rpc("get_archive_files",l,{subjectUserId:o.id}):(new a.NoAuthApiV2Client).ns("previews").rpc("logged_out/get_archive_files",l,{})).then((function(e){return t=e.archive_files,n.keyBy(t,"subpath");var t}))}})),define("modules/clean/react/previews/archive/app",["require","exports","tslib","react","modules/clean/previews/util","modules/clean/loggers/file_preview_logger","modules/clean/react/file_viewer/logging","modules/clean/file_store/utils","modules/clean/react/file_viewer/file_preview_event_emitter","modules/clean/react/file_viewer/constants","modules/clean/file_store/utils","modules/clean/react/file_viewer/location_utils","modules/clean/react/previews/archive/archive_entry_watcher","modules/clean/react/previews/archive/keyboard_binding_connector","modules/clean/react/previews/archive/utils","modules/clean/react/previews/archive/view","modules/clean/web_timing_logger","modules/clean/redux/constants","modules/clean/file_store/utils"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m,h,_,v,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0,n=r.__importDefault(n),s=r.__importStar(s),_=r.__importStar(_);var y=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.logger=null,t.onFetchSuccess=function(){if(t.markWebTiming(),t.logFilePreviewTimeline(c.EventType.FilePreviewDownloadSucceeded),t.logFilePreviewTimeline(c.EventType.FilePreviewRenderSucceeded),t.props.entry){var e=m.scanEntryContents(t.props.entry);t.logArchivePreviewEvent(c.EventType.ArchivePreviewContentsScanned,e)}t.props.setRenderStatusSuccess()},t.onFetchFailure=function(){t.logFilePreviewTimeline(c.EventType.FilePreviewDownloadFailed),t.props.onError&&t.props.onError()},t.handleEntryRowClick=function(e,r){e.preventDefault();var n=t.props.fileSubpath;if(r){var o=u.addToFileSubpath(n,r.name);u.updateFileSubpathQuery(o),t.logUserAction(r,c.UserAction.ArchiveNavigation,c.UserActionContext.PreviewContentMain)}},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.setUpLogger(),this.fetchArchiveContents()},t.prototype.componentWillUnmount=function(){this.teardownLogger(),this.props.resetState(),u.updateFileSubpathQuery(null)},t.prototype.componentDidUpdate=function(e){if(g.areFilesEqual(e.rootFile,this.props.rootFile)&&e.previewUrl===this.props.previewUrl||(this.props.resetState(),this.fetchArchiveContents()),e.treeApiStatus===v.ApiClientStatus.Fetch)switch(this.props.treeApiStatus){case v.ApiClientStatus.Success:this.onFetchSuccess();break;case v.ApiClientStatus.Error:this.onFetchFailure()}},t.prototype.fetchArchiveContents=function(){if(this.logFilePreviewTimeline(c.EventType.FilePreviewSupportConfirmed),this.props.previewUrl){this.logFilePreviewTimeline(c.EventType.FilePreviewDownloadAttempted);var e=m.getPreviewUrl(this.props.previewUrl),t=s.getFilename(this.props.rootFile);this.props.fetchRootArchiveEntry({url:e,filename:t})}else this.props.onError&&this.props.onError()},t.prototype.setUpLogger=function(){this.logger&&this.teardownLogger(),this.logger=new i.FilePreviewArchiveLogger,this.logger.listenTo(l.filePreviewEventEmitter)},t.prototype.teardownLogger=function(){var e;null===(e=this.logger)||void 0===e||e.unlistenTo(l.filePreviewEventEmitter),this.logger=null},t.prototype.logFilePreviewTimeline=function(e){this.props.filePreviewSession&&this.props.filePreviewSession.recordEvent(e)},t.prototype.logArchivePreviewEvent=function(e,t){void 0===t&&(t={}),l.filePreviewEventEmitter.emit(e,this.props.filePreviewSession,t)},t.prototype.logUserAction=function(e,t,r){a.logUserAction(t,r,{isDir:e.isDir,extension:e.isDir?"":o.getWhitelistedExtension(e.name)})},t.prototype.markWebTiming=function(){this.props.filePreviewSession&&this.props.filePreviewSession.markPrimaryEvent(),_.mark_time_to_view(),_.mark_time_to_interactive()},t.prototype.render=function(){return n.default.createElement("div",null,n.default.createElement(h.View,{entry:this.props.entry,fileExtension:d.getExtension(this.props.rootFile),isPasswordProtected:this.props.isPasswordProtected,onEntryRowClick:this.handleEntryRowClick,rootFile:this.props.rootFile,currentSubpath:this.props.fileSubpath,encryptionOptions:this.props.encryptionOptions,user:this.props.user,sharePermission:this.props.sharePermission,shareToken:this.props.shareToken}),n.default.createElement(p.ArchiveEntryWatcher,{rootFile:this.props.rootFile,fileSubpath:this.props.fileSubpath,sharedLinkUrl:this.props.sharedLinkUrl,user:this.props.user}),n.default.createElement(f.ArchiveKeyboardBindingConnector,{fileSubpath:this.props.fileSubpath}))},t})(n.default.Component);t.App=y})),define("modules/clean/react/previews/archive/archive_entry_watcher",["require","exports","tslib","react","react-redux","modules/clean/react/previews/archive/data/actions","modules/clean/react/previews/archive/data/selectors","modules/clean/react/previews/archive/utils"],(function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArchiveEntryWatcher=t.UnconnectedArchiveEntryWatcher=void 0;var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fetchArchiveFiles=function(e){var r=t.props;(0,r.fetchArchiveFiles)({rootFile:r.rootFile,subpathInfos:e,sharedLinkUrl:r.sharedLinkUrl,user:r.user})},t}return r.__extends(t,e),t.prototype.componentDidUpdate=function(){var e=this.props.neededSubpathInfos;e.length&&this.fetchArchiveFiles(e)},t.prototype.render=function(){return null},t})((n=r.__importDefault(n)).default.Component);t.UnconnectedArchiveEntryWatcher=l;var c=a.makeGetArchiveEntry();var d={fetchArchiveFiles:i.fetchArchiveFiles};t.ArchiveEntryWatcher=o.connect((function(e,t){var r=t.rootFile,n=t.fileSubpath,o=c(e,{fileSubpath:n,rootFile:r});return{neededSubpathInfos:s.getNeededArchiveFileSubpathInfos(n,o).filter((function(t){return a.getShouldFetchArchiveFiles(e,{subpath:t.subpath})}))}}),d)(l)})),define("modules/clean/react/previews/archive/constants",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.COMPRESSED_CONTAINER_EXTENSIONS=t.COMPRESSED_EXTENSIONS=t.MAX_ROW_WIDTH_IN_EMS=t.DEFAULT_NUM_ROWS=void 0,t.DEFAULT_NUM_ROWS=10,t.MAX_ROW_WIDTH_IN_EMS=17,t.COMPRESSED_EXTENSIONS=["bz","bz2","gz","lz","lzma","xz","z"],t.COMPRESSED_CONTAINER_EXTENSIONS=["tar","xar"]})),define("modules/clean/react/previews/archive/data/actions",["require","exports","tslib","lodash","modules/clean/react/previews/archive/api","modules/clean/previews/data/actions"],(function(e,t,r,n,o,i){"use strict";var a;function s(){return{type:a.GetTreeApiFetch}}function l(e){var t=e.entry,r=e.isPasswordProtected;return{type:a.GetTreeApiSuccess,payload:{entry:t,isPasswordProtected:r}}}function c(e){return{type:a.GetTreeApiError,payload:{error:e}}}function d(e){var t=e.subpaths;return{type:a.GetArchiveFilesApiFetch,meta:{subpaths:t}}}function u(e){return{type:a.GetArchiveFilesApiSuccess,payload:{archiveFiles:e}}}function p(e,t){var r=t.subpaths;return{type:a.GetArchiveFilesApiError,meta:{subpaths:r},error:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.fetchArchiveFiles=t.fetchRootArchiveEntry=t.resetState=t.getArchiveFilesApiError=t.getArchiveFilesApiSuccess=t.getArchiveFilesApiFetch=t.getTreeApiError=t.getTreeApiSuccess=t.getTreeApiFetch=t.Actions=void 0,o=r.__importStar(o),(function(e){e.ResetState="ArchivePreviewResetState",e.GetTreeApiFetch="ArchivePreviewGetTreeApiFetch",e.GetTreeApiSuccess="ArchivePreviewGetTreeApiSuccess",e.GetTreeApiError="ArchivePreviewGetTreeApiError",e.GetArchiveFilesApiFetch="ArchivePreviewGetArchiveFilesApiFetch",e.GetArchiveFilesApiSuccess="ArchivePreviewGetArchiveFilesApiSuccess",e.GetArchiveFilesApiError="ArchivePreviewGetArchiveFilesApiError"})(a=t.Actions||(t.Actions={})),t.getTreeApiFetch=s,t.getTreeApiSuccess=l,t.getTreeApiError=c,t.getArchiveFilesApiFetch=d,t.getArchiveFilesApiSuccess=u,t.getArchiveFilesApiError=p,t.resetState=function(){return{type:a.ResetState}},t.fetchRootArchiveEntry=function(e){return function(t){t(s()),o.fetchRootArchiveEntry(e).then((function(e){var r=e.rootEntry,n=e.isPasswordProtected;t(l({entry:r,isPasswordProtected:n}))})).catch((function(e){t(c(e))}))}},t.fetchArchiveFiles=function(e){var t=e.rootFile,r=e.sharedLinkUrl,a=e.subpathInfos,s=e.user,l=a.map((function(e){return e.subpath}));return function(e){return e(d({subpaths:l})),o.fetchArchiveFiles({rootFile:t,sharedLinkUrl:r,subpathInfos:a,user:s}).then((function(r){return e(u(r)),e(i.populateArchivePreviews(t,n.values(r))),r})).catch((function(t){return e(p(t,{subpaths:l})),t}))}}})),define("modules/clean/react/previews/archive/data/reducer",["require","exports","tslib","modules/clean/react/previews/archive/data/actions","modules/clean/redux/constants"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.previewArchiveReducer=t.initialState=void 0,t.initialState={archiveFiles:{},rootEntry:void 0,treeApiStatus:void 0,error:void 0},t.previewArchiveReducer=function(e,i){switch(void 0===e&&(e=t.initialState),i.type){case n.Actions.GetTreeApiFetch:return r.__assign(r.__assign({},e),{treeApiStatus:o.ApiClientStatus.Fetch});case n.Actions.GetTreeApiSuccess:return r.__assign(r.__assign({},e),{rootEntry:i.payload.entry,isPasswordProtected:i.payload.isPasswordProtected,treeApiStatus:o.ApiClientStatus.Success});case n.Actions.GetTreeApiError:return r.__assign(r.__assign({},e),{treeApiStatus:o.ApiClientStatus.Error,error:i.payload.error});case n.Actions.GetArchiveFilesApiFetch:return r.__assign(r.__assign({},e),{archiveFiles:r.__assign(r.__assign({},e.archiveFiles),i.meta.subpaths.reduce((function(e,t){return e[t]={archiveFile:void 0,apiStatus:o.ApiClientStatus.Fetch},e}),{}))});case n.Actions.GetArchiveFilesApiSuccess:for(var a=i.payload.archiveFiles,s={},l=0,c=Object.keys(a);l<c.length;l++){var d=c[l];s[d]={archiveFile:a[d],apiStatus:o.ApiClientStatus.Success}}return r.__assign(r.__assign({},e),{archiveFiles:r.__assign(r.__assign({},e.archiveFiles),s)});case n.Actions.GetArchiveFilesApiError:return r.__assign(r.__assign({},e),{archiveFiles:r.__assign({},i.meta.subpaths.reduce((function(e,t){return e[t]={archiveFile:void 0,apiStatus:o.ApiClientStatus.Error,error:i.error},e}),{}))});case n.Actions.ResetState:return t.initialState;default:return e}}})),define("modules/clean/react/previews/archive/data/selectors",["require","exports","tslib","lodash","reselect","modules/clean/react/previews/archive/data/utils","modules/clean/redux/constants","modules/clean/redux/namespaces"],(function(e,t,r,n,o,i,a,s){"use strict";function l(e){return e[s.PREVIEW_ARCHIVE_NAMESPACE_KEY]}Object.defineProperty(t,"__esModule",{value:!0}),t.getTreeApiStatus=t.isErrorStateForSubpath=t.getShouldFetchArchiveFiles=t.makeGetArchiveEntry=t.getEncryptedStatus=void 0,n=r.__importStar(n),t.getEncryptedStatus=function(e){return l(e).isPasswordProtected};var c=function(e,t){var r=(function(e,t){var r=l(e).archiveFiles;if(r)return r[t]})(e,t.subpath);if(r)return r.apiStatus},d=function(e){return l(e).rootEntry},u=n.flow(l,(function(e){return n.get(e,"archiveFiles",{})}));function p(e,t,r){var n=r.fileSubpath,o=r.rootFile;if(!e)return e;var a=n?i.walkEntryTree(e,n):e;return i.getEntryWithArchiveFiles({subpath:n,rootFile:o,entry:a,archiveFilesMap:t})}t.makeGetArchiveEntry=function(){return o.createSelector([d,u,function(e,t){return t}],p)},t.getShouldFetchArchiveFiles=function(e,t){var r=t.subpath;if(!r)return!1;var n=c(e,{subpath:r});return!n||![a.ApiClientStatus.Fetch,a.ApiClientStatus.Error].includes(n)},t.isErrorStateForSubpath=function(e,t){var r=t.subpath;return!!r&&c(e,{subpath:r})===a.ApiClientStatus.Error},t.getTreeApiStatus=function(e){return l(e).treeApiStatus}})),define("modules/clean/react/previews/archive/data/store",["require","exports","modules/clean/react/previews/archive/data/reducer","modules/clean/redux/namespaces","modules/clean/redux/store"],(function(e,t,r,n,o){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForPreviewArchive=void 0,t.getStoreForPreviewArchive=function(){var e;return i||(i=o.getStoreAndRegisterReducers(((e={})[n.PREVIEW_ARCHIVE_NAMESPACE_KEY]=r.previewArchiveReducer,e))),i}})),define("modules/clean/react/previews/archive/data/utils",["require","exports","tslib","lodash","modules/clean/react/file_viewer/location_utils","modules/clean/react/previews/archive/utils"],(function(e,t,r,n,o,i){"use strict";function a(e){var t=e.subpath,n=e.entry,o=e.rootFile,a=e.archiveFilesMap;if(n.isDir||!t)return n;var s=a[t]&&a[t].archiveFile;return r.__assign(r.__assign({},n),{file:i.createFileFromEntryAndApi(n,o,s)})}Object.defineProperty(t,"__esModule",{value:!0}),t.getEntryWithArchiveFiles=t.walkEntryTree=void 0,n=r.__importStar(n),t.walkEntryTree=function(e,t){for(var r=t.substring(1).split("/"),n=e,i="";r.length;){var a=r.shift(),s=a?n.children[a]:void 0;if(!s)return i!==t&&o.updateFileSubpathQuery(i),n;n=s,i+="/"+a}return n},t.getEntryWithArchiveFiles=function(e){return e.entry.isDir?(i=(t=e).subpath,s=t.entry,l=t.rootFile,c=t.archiveFilesMap,d=n.mapValues(s.children,(function(e,t){return a({subpath:o.addToFileSubpath(i,t),entry:e,rootFile:l,archiveFilesMap:c})})),r.__assign(r.__assign({},s),{children:d})):a(e);var t,i,s,l,c,d}})),define("modules/clean/react/previews/archive/entry_row",["require","exports","tslib","react","spectrum/file_icon/index","spectrum/icon_content/index","spectrum/media_table/index","modules/clean/display_format","modules/clean/em_string","modules/clean/react/previews/archive/constants","modules/clean/react/previews/archive/utils","modules/clean/react/thumbnail"],(function(e,t,r,n,o,i,a,s,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntryRow=void 0;var p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){e.stopPropagation(),t.props.onClick&&t.props.onClick(e,t.props.entry)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,r=t.entry,o=t.shouldHideSize,i=t.topOffset;return this.props.onClick?n.default.createElement(a.CulledMediaRow,{topOffset:i,onClick:this.handleClick,doubleLine:!0},(function(t){var n=t.isHovered;return f({entry:r,highlight:n,onClick:e.handleClick,shouldHideSize:o})})):n.default.createElement(a.CulledMediaRow,{topOffset:i,doubleLine:!0},f({entry:r,shouldHideSize:o}))},t})((n=r.__importDefault(n)).default.Component);t.EntryRow=p;var f=function(e){var t=e.entry,r=e.onClick,o=e.highlight,i=e.shouldHideSize,d=l.Emstring.em_snippet(t.name,c.MAX_ROW_WIDTH_IN_EMS),u=[n.default.createElement(a.MediaCell,{key:"rowname",title:r?n.default.createElement("button",{className:"entry-row-button",onClick:r,"aria-label":t.name},d):d,icon:n.default.createElement(m,{displayName:t.name,file:t.file,isDir:t.isDir}),highlight:o})];return t.size&&!i&&u.push(n.default.createElement(a.MediaCell,{key:"rowsize",title:s.format_bytes(t.size)})),u},m=function(e){return e.isDir?n.default.createElement(i.IconContent,{name:"folder-small"}):e.file&&d.shouldAllowVisualFolderIcons()?n.default.createElement(u.ThumbnailIcon,{className:"entry-row-icon",file:e.file,alt:e.displayName}):n.default.createElement(o.FileIcon,{path:e.displayName})}})),define("modules/clean/react/previews/archive/file_entry_view",["require","exports","tslib","react","classnames","modules/clean/react/file_viewer/data/selectors","modules/clean/redux/constants","modules/clean/react/previews/loading_indicator","modules/clean/react/file_viewer/file_preview","modules/clean/react/file_viewer/constants","modules/clean/react/size_class/size_class","modules/clean/react/previews/constants","modules/clean/previews/constants","react-redux","modules/clean/react/previews/archive/data/selectors","modules/clean/react/previews/archive/utils","modules/clean/react/size_class/constants","modules/clean/previews/data/selectors"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m,h,_,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileEntryView=t._FileEntryView=t.PreviewTypeWhitelist=void 0,n=r.__importDefault(n),o=r.__importDefault(o),t.PreviewTypeWhitelist=[p.PreviewType.SsrDoc,p.PreviewType.Excel,p.PreviewType.HTML,p.PreviewType.Image,p.PreviewType.RawHTML],t._FileEntryView=function(e){var r=e.entry,o=e.extensionsEnabled,i=e.previewApiData,s=e.isErrorState,d=e.isFullscreen,p=e.isSidebarOpen,f=e.sidebar,m=e.sizeClass,v=e.rootFile,g=e.encryptionOptions,b=r.file,w=m!==_.SizeClass.Small,S={canCopyToDropboxRoles:[],canDownloadRoles:[],canPrintRoles:[],canRemoveLinkUids:[],canSyncToDropboxRoles:[],canViewContextMenuRoles:[],canViewMetadataRoles:[]};return b?n.default.createElement(l.FilePreviewWithLogging,{extensionsEnabled:o,file:b,isFullscreen:d,isSidebarOpen:p,sidebar:f,sourceAction:u.PreviewSourceAction.Click,sourceContext:u.PreviewSourceContext.ArchiveFile,maxFilenameEmLength:c.SizeClassFilenameLengthMap[m],previewTypeWhitelist:t.PreviewTypeWhitelist,sharePermission:S,shouldDisplayToolbar:w,previewApiData:i,sizeClass:m,encryptionOptions:g}):s?n.default.createElement(l.FilePreview,{extensionsEnabled:o,file:h.createFileFromEntry(r,v),previewApiData:{data:void 0,status:a.ApiClientStatus.Error},isFullscreen:d,isSidebarOpen:p,sidebar:f,sourceAction:u.PreviewSourceAction.Click,sourceContext:u.PreviewSourceContext.ArchiveFile,maxFilenameEmLength:c.SizeClassFilenameLengthMap[m],previewTypeWhitelist:t.PreviewTypeWhitelist,sharePermission:S,shouldDisplayToolbar:w,sizeClass:m,encryptionOptions:g}):n.default.createElement(y,null)};var g=d.withSizeClass(t._FileEntryView,{responsiveClassName:"preview-content--full-height"});t.FileEntryView=f.connect((function(e,t){return{previewApiData:v.getPreviewForArchiveFile(e,t.entry.file),extensionsEnabled:i.getExtensionsEnabled(e),isFullscreen:i.getIsFullScreen(e),isSidebarOpen:i.getIsSidebarOpen(e),isErrorState:m.isErrorStateForSubpath(e,{subpath:t.currentSubpath}),sidebar:i.getSidebar(e)}}))(g);var y=function(){return n.default.createElement("div",{className:o.default("preview-content","preview-content--center","preview-content--full-height")},n.default.createElement(s.LoadingIndicator,null))}})),define("modules/clean/react/previews/archive/folder_entry_view",["require","exports","tslib","react","classnames","lodash","spectrum/icon_content/index","spectrum/dimensions/index","spectrum/table/index","modules/clean/react/previews/archive/entry_row","modules/clean/react/size_class/size_class","modules/clean/react/size_class/constants","modules/core/i18n","modules/clean/react/file_viewer/file_conversion/utils"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FolderEntryView=void 0,n=r.__importDefault(n),o=r.__importDefault(o),i=r.__importStar(i),t.FolderEntryView=function(e){var t=e.entry,r=e.onEntryRowClick,o=e.shouldAllowFileNavigation,a=e.file,s=e.user,l=e.sharePermission,c=e.shareToken,d=i.values(t.children),u=d.length?n.default.createElement(h,{entries:d,onRowClick:r,shouldAllowFileNavigation:o}):n.default.createElement(_,null),p=f.getConversionsForPreview(a,s,c,l);return n.default.createElement(n.default.Fragment,null,p,u)};var m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderEntryRow=function(e,r,o){var i=t.props.shouldAllowFileNavigation||e.isDir?t.props.onRowClick:void 0;return n.default.createElement(c.EntryRow,{entry:e,onClick:i,shouldHideSize:t.props.sizeClass===u.SizeClass.Small,topOffset:o})},t}return r.__extends(t,e),t.prototype.render=function(){var e=this;return n.default.createElement(s.Dimensions,{className:"preview-archive__table"},(function(t){t.width;var r=t.height;return n.default.createElement(l.Table,null,n.default.createElement(l.FixedTableHead,null,n.default.createElement(l.TableHeadCell,null,p.intl.formatMessage({id:"cJojIg",defaultMessage:"Name"})),e.props.sizeClass===u.SizeClass.Small?null:n.default.createElement(l.TableHeadCell,null,p.intl.formatMessage({id:"txUjQq",defaultMessage:"Size"}))),n.default.createElement(l.CulledTableBody,{items:e.props.entries,listItemHeight:72,renderRow:e.renderEntryRow,viewportHeight:r,shouldUseWindowAsScrollContainer:!1}))}))},t})(n.default.Component),h=d.withSizeClass(m,{responsiveClassName:"preview-content--full-height"}),_=function(){return n.default.createElement("div",{className:o.default("preview-content","preview-content--center","preview-content--column","preview-content--full-height","preview-archive--empty")},n.default.createElement(a.IconContent,{name:"folder-small"}),n.default.createElement("div",{className:"empty-text u-pad-top-s"},p.intl.formatMessage({id:"YLBqRL",defaultMessage:"This folder is empty"})))}})),define("modules/clean/react/previews/archive/keyboard_binding_connector",["require","exports","tslib","react","ts-keycode-enum","modules/clean/react/file_viewer/location_utils","modules/clean/react/keyboard_binding/keyboard_binding","modules/clean/react/keyboard_binding/keyboard_binding_connector"],(function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArchiveKeyboardBindingConnector=void 0;var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleKeyPress=function(){var e=i.shortenFileSubpathBy(t.props.fileSubpath,1);return i.updateFileSubpathQuery(e),!0},t.keyboardBindings=[{keyboardEventCriteria:a.generateUnmodifiedKeyboardEventCriteria(o.Key.Escape),callback:t.handleKeyPress}],t}return r.__extends(t,e),t.prototype.render=function(){return n.default.createElement(s.KeyboardBindingConnector,{keyboardBindings:this.keyboardBindings})},t})((n=r.__importDefault(n)).default.Component);t.ArchiveKeyboardBindingConnector=l})),define("modules/clean/react/previews/archive/preview_archive",["require","exports","tslib","react","react-redux","modules/clean/react/previews/archive/app","modules/clean/react/previews/archive/data/selectors","modules/clean/react/previews/archive/data/store","modules/clean/react/previews/archive/data/actions","modules/clean/react/components/css"],(function(e,t,r,n,o,i,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewArchiveForTesting=t.PreviewArchive=void 0,n=r.__importDefault(n);var d=a.makeGetArchiveEntry();var u={fetchRootArchiveEntry:l.fetchRootArchiveEntry,resetState:l.resetState},p=o.connect((function(e,t){return{entry:d(e,{fileSubpath:t.fileSubpath,rootFile:t.rootFile}),isPasswordProtected:a.getEncryptedStatus(e),treeApiStatus:a.getTreeApiStatus(e)}}),u)(i.App);t.PreviewArchiveForTesting=p;var f=s.getStoreForPreviewArchive(),m=c.requireCssWithComponent((function(e){return n.default.createElement(o.Provider,{store:f},n.default.createElement(p,r.__assign({},e)))}),["/static/css/preview_archive-vflWyumo_.css"]);t.PreviewArchive=m})),define("modules/clean/react/previews/archive/utils",["require","exports","tslib","lodash","modules/clean/react/file_viewer/location_utils","modules/clean/previews/util","modules/core/uri"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNeededArchiveFileSubpathInfos=t.createFileFromEntryAndApi=t.createFileFromEntry=t.scanEntryContents=t.shouldAllowVisualFolderIcons=t.getPreviewUrl=void 0,n=r.__importStar(n),t.getPreviewUrl=function(e){var t=a.URI.parse(e.toString()).toString();return"//"===t.slice(0,2)&&(t="https:"+t),t},t.shouldAllowVisualFolderIcons=function(){return!1},t.scanEntryContents=function(e){for(var t={},r=[e];r.length;){var o=r.shift();if(o.isDir)r.push.apply(r,n.values(o.children));else{var a=i.getWhitelistedExtension(o.name);t[a]=++t[a]||1}}return t},t.createFileFromEntry=function(e,t){return{subpath:e.name,is_dir:!1,filename:e.name,ns_id:t.ns_id,sjid:t.sjid,bytes:e.size,sort_key:void 0,href:void 0,ts:void 0,file_id:void 0,revision_id:void 0,is_symlink:!1}},t.createFileFromEntryAndApi=function(e,t,r){if(r)return{bytes:e.size,file_id:void 0,filename:r.filename,href:void 0,is_dir:!1,ns_id:t.ns_id,revision_id:void 0,sjid:t.sjid,sort_key:void 0,subpath:r.subpath,thumbnail_url_tmpl:r.thumbnail_url_tmpl,ts:void 0,is_symlink:!1,preview:r.preview}},t.getNeededArchiveFileSubpathInfos=function(e,t){return t?t.isDir||t.file||!e?n.values(t.children).filter((function(e){return!e.isDir&&!e.file})).map((function(t){return{subpath:o.addToFileSubpath(e,t.name),size:t.size}})):[{subpath:e,size:t.size}]:[]}})),define("modules/clean/react/previews/archive/view",["require","exports","tslib","react","spectrum/media_table_skeleton/index","spectrum/snackbar/index","modules/clean/react/async/loadable","modules/clean/react/previews/archive/folder_entry_view","modules/clean/react/previews/archive/constants","modules/core/i18n"],(function(e,t,r,n,o,i,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.View=void 0,n=r.__importDefault(n);var d=a.Loadable({loader:function(){return new Promise((function(t,r){e(["modules/clean/react/previews/archive/file_entry_view"],t,r)})).then(r.__importStar).then((function(e){return e.FileEntryView}))}});t.View=function(e){var t=e.entry,r=e.rootFile,o=e.fileExtension,a=e.isPasswordProtected,s=e.onEntryRowClick,l=e.currentSubpath,d=e.encryptionOptions,f=e.user,m=e.sharePermission,h=e.shareToken;return n.default.createElement("div",{className:"preview-archive"},n.default.createElement("div",{className:"preview-archive__content"},t?n.default.createElement(u,{entry:t,rootFile:r,shouldAllowFileNavigation:!a,onEntryRowClick:s,currentSubpath:l,encryptionOptions:d,user:f,sharePermission:m,shareToken:h}):n.default.createElement(p,null),a?n.default.createElement(i.Snackbar,{title:c.intl.formatMessage({id:"xONQyk",defaultMessage:"Can’t preview items in password-protected {extension} files."},{extension:"."+o}),variant:"warn"}):null))};var u=function(e){return e.entry.isDir?n.default.createElement(s.FolderEntryView,{entry:e.entry,onEntryRowClick:e.onEntryRowClick,shouldAllowFileNavigation:e.shouldAllowFileNavigation,file:e.rootFile,user:e.user,sharePermission:e.sharePermission,shareToken:e.shareToken}):n.default.createElement(d,{entry:e.entry,rootFile:e.rootFile,currentSubpath:e.currentSubpath,encryptionOptions:e.encryptionOptions})},p=function(){return n.default.createElement("div",{className:"preview-archive__table"},n.default.createElement(o.MediaTableSkeleton,{numRows:l.DEFAULT_NUM_ROWS}))}})),define("modules/clean/react/copy_to_dropbox/actions",["require","exports","tslib","modules/clean/react/copy_to_dropbox/api","modules/core/browser"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copySharedFile=void 0,n=r.__importStar(n),o=r.__importStar(o),t.copySharedFile=function(e,t){return r.__awaiter(this,void 0,void 0,(function(){var i;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,n.copySharedFile(e,t)];case 1:return i=r.sent(),o.redirect(i),[2]}}))}))}})),define("modules/clean/react/copy_to_dropbox/api",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_as_promised_jquery"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.copySharedFile=void 0,n=r.__importStar(n),t.copySharedFile=function(e,t){var r={link_key:e.linkKey,link_type:e.linkType,secure_hash:e.secureHash,subpath:e.subPath};return e.itemId&&(r.item_id=e.itemId),new Promise((function(e,o){return n.WebProgressRequest({url:"/sm/c2d",data:r,subject_user:t,success:e})}))}})),define("modules/clean/react/copy_to_dropbox/modal",["require","exports","tslib","react","modules/clean/analytics","modules/clean/em_string","modules/clean/filepath/filepath","modules/clean/react/copy_to_dropbox/actions","modules/clean/react/components/modal","modules/clean/share_download/types","modules/clean/share_download/utils","modules/clean/viewer","modules/core/i18n","modules/core/notify","modules/clean/loggers/folder_preview_logger","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/logging"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m,h,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyToDropboxModal=void 0,n=r.__importDefault(n),a=r.__importStar(a);var v=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleAccept=function(){var e=g(t.props.role);f.Notify.success(e),s.copySharedFile(t.props.shareToken,t.props.userId),t.props.folderPreviewSession?m.logEvent(h.UserAction.SaveToDropboxApprove,t.props.folderPreviewSession):_.logUserAction(h.UserAction.SaveToDropboxApprove,h.UserActionContext.Unknown)},t.handleDismiss=function(e){t.props.onDismiss&&t.props.onDismiss(e),t.props.folderPreviewSession?m.logEvent(h.UserAction.SaveToDropboxCancel,t.props.folderPreviewSession):_.logUserAction(h.UserAction.SaveToDropboxCancel,h.UserActionContext.Unknown)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){o.WebMiscActivityLogger.log("show-c2d-modal")},t.prototype.render=function(){var e=this.props,t=e.copyable,r=e.role,o=d.getCopyableName(t),s=d.getCopyableType(t);return n.default.createElement(l.Modal,{title:y(o,r),acceptButtonText:p.intl.formatMessage({id:"78AHo5",defaultMessage:"Save"}),dismissButtonText:p.intl.formatMessage({id:"d9/SE1",defaultMessage:"Cancel"}),onAccept:this.handleAccept,onDismiss:this.handleDismiss,style:"default-maestro"},n.default.createElement("p",{className:"db-modal-message"},(function(e,t,r){var o=u.Viewer.get_viewer(),s=o.get_user_by_role(t);if(e=i.Emstring.em_snippet(e,15),s&&s.is_cdm_member)return p.intl.formatMessage({id:"3Sb6Ws",defaultMessage:"<strong>{name}</strong> will be saved to the <strong>{cdm_tmf_name}</strong> folder in your {team_name} Dropbox account."},{name:e,cdm_tmf_name:a.filename(s.cdm_tmf_path),team_name:o.team_name,strong:function(e){return n.default.createElement("strong",null,e)}});if(o.is_paired)switch(t){case"personal":return p.intl.formatMessage({id:"nBgj3Q",defaultMessage:"<strong>{name}</strong> will be saved to your personal Dropbox account and synced to any connected devices."},{name:e,strong:function(e){return n.default.createElement("strong",null,e)}});case"work":switch(r){case c.CopyableType.Collection:return p.intl.formatMessage({id:"2yp43H",defaultMessage:"This album will be instantly saved to your {team_name} Dropbox and downloaded to all the computers linked to your {team_name} account."},{team_name:o.team_name});case c.CopyableType.Folder:return p.intl.formatMessage({id:"eJs/IE",defaultMessage:"This folder will be instantly saved to your {team_name} Dropbox and downloaded to all the computers linked to your {team_name} account."},{team_name:o.team_name});default:return p.intl.formatMessage({id:"Kb1en/",defaultMessage:"This file will be instantly saved to your {team_name} Dropbox and downloaded to all the computers linked to your {team_name} account."},{team_name:o.team_name})}}switch(r){case c.CopyableType.Collection:return p.intl.formatMessage({id:"35MZFn",defaultMessage:"This album will be instantly saved to your Dropbox and downloaded to all the computers linked to your account."});case c.CopyableType.Folder:return p.intl.formatMessage({id:"qkudum",defaultMessage:"This folder will be instantly saved to your Dropbox and downloaded to all the computers linked to your account."});default:return p.intl.formatMessage({id:"uGDUlE",defaultMessage:"This file will be instantly saved to your Dropbox and downloaded to all the computers linked to your account."})}})(o,r,s)))},t})(n.default.Component);function g(e){var t=u.Viewer.get_viewer();if(t.is_paired)switch(e){case"personal":return p.intl.formatMessage({id:"9Q/1TS",defaultMessage:"Saving to your personal Dropbox..."});case"work":return p.intl.formatMessage({id:"5wQTp4",defaultMessage:"Saving to your {team_name} Dropbox..."},{team_name:t.team_name})}return p.intl.formatMessage({id:"vFhcfF",defaultMessage:"Saving to your Dropbox..."})}function y(e,t){var r=u.Viewer.get_viewer(),n=r.get_user_by_role(t);if(n&&n.is_cdm_member)return p.intl.formatMessage({id:"yHgTUN",defaultMessage:"Save to your member folder?"});if(r.is_paired)switch(t){case"personal":return p.intl.formatMessage({id:"fI7sAv",defaultMessage:"Save to your personal Dropbox account?"});case"work":var o=r.team_name,a=new i.Emstring(o||"").length,s=Math.max(10,15-a);return p.intl.formatMessage({id:"5SXeZ6",defaultMessage:"Save ‘{name}’ to my {team_name} Dropbox"},{name:i.Emstring.em_snippet(e,s),team_name:o})}return p.intl.formatMessage({id:"ktpG9L",defaultMessage:"Save ‘{name}’ to my Dropbox"},{name:i.Emstring.em_snippet(e,15)})}t.CopyToDropboxModal=v})),define("modules/clean/react/share_download/actions",["require","exports","tslib","react","modules/clean/auth/login_or_register/types","modules/clean/downloads","modules/clean/react/copy_to_dropbox/modal","modules/clean/react/components/modal","modules/clean/react/share_download/api","modules/core/persistence/storage","modules/clean/viewer","modules/core/browser","modules/core/exception","modules/core/i18n","modules/core/notify","modules/clean/react/share_download/api"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.authModalHelpers=t.toDropbox=t.direct=void 0,n=r.__importDefault(n),i=r.__importStar(i),l=r.__importStar(l),u=r.__importStar(u),t.direct=function(e,n,o){return r.__awaiter(this,void 0,void 0,(function(){var a,s,c;return r.__generator(this,(function(r){switch(r.label){case 0:return a=e.downloadTestUrl,s=e.url,o||p.reportException({err:new Error("No encryption options provided for direct download action"),severity:"non-critical",tags:["sharing-encryption-options"]}),[4,t.authModalHelpers.authenticateForDownload(n||null,o)];case 1:if(r.sent(),!a)return[3,5];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,l.testDownload(a)];case 3:return r.sent(),[3,5];case 4:return r.sent()instanceof h.TooLargeError?m.Notify.error(f.intl.formatMessage({id:"pcsTpL",defaultMessage:"The zip file is too large."})):m.Notify.error(f.intl.formatMessage({id:"pllUQE",defaultMessage:"Failed to download zip file."})),[2];case 5:return r.trys.push([5,7,,8]),[4,l.fetchDownloadUrl(s)];case 6:return c=r.sent(),i.get({url:c}),[3,8];case 7:return r.sent(),m.Notify.error(f.intl.formatMessage({id:"6OUwIN",defaultMessage:"Failed to download."})),[3,8];case 8:return[2]}}))}))},t.toDropbox=function(e,o,i,l,c,f){return r.__awaiter(this,void 0,void 0,(function(){var m,h;return r.__generator(this,(function(r){switch(r.label){case 0:return"anonymous"!==i?[3,2]:(c||p.reportException({err:new Error("No encryption options provided for anonymous sharing action"),severity:"non-critical",tags:["sharing-encryption-options"]}),[4,t.authModalHelpers.authenticateForSaveToDropbox(c)]);case 1:return m=r.sent(),h=u.reload,[3,4];case 2:return m=l?l.id:-1,p.assert(-1!==m,"role isn't anonymous => user cannot be null or undefined!"),d.Viewer.get_viewer().is_user_signed_in(l)?[3,4]:(c||p.reportException({err:new Error("No encryption options provided for multiaccount sharing action"),severity:"non-critical",tags:["sharing-encryption-options"]}),[4,t.authModalHelpers.doMultiAccountAuthentication(i,c)]);case 3:r.sent(),r.label=4;case 4:return s.Modal.showInstance(n.default.createElement(a.CopyToDropboxModal,{shareToken:e,copyable:o,userId:m,role:i,onDismiss:h,folderPreviewSession:f})),[2]}}))}))},t.authModalHelpers={authenticateForDownload:function(t,i){return t!==o.LoginOrRegisterKind.DOWNLOAD||c.LocalStorage.get("has_seen_download_signup_modal")?Promise.resolve():new Promise((function(a,l){var d=function(){c.LocalStorage.set("has_seen_download_signup_modal",!0),a()},u=function(){c.LocalStorage.set("has_seen_download_signup_modal",!0),l()};new Promise((function(t,r){e(["modules/clean/auth/login_or_register/modal"],t,r)})).then(r.__importStar).then((function(e){var r=e.LoginOrRegisterModal;s.Modal.showInstance(n.default.createElement(r,{downloadAction:o.DownloadAction.DIRECT_DOWNLOAD,id:"shared-link-download-signup-modal",initialMode:o.Mode.REGISTER,kind:t,onAuthenticateSuccess:d,onCancel:u,signup_tag:"shmodel_download_register",encryptionOptions:i}))}))}))},authenticateForSaveToDropbox:function(t){return new Promise((function(i,a){var l=function(e){return i(e.id)};new Promise((function(t,r){e(["modules/clean/auth/login_or_register/modal"],t,r)})).then(r.__importStar).then((function(e){var r=e.LoginOrRegisterModal;s.Modal.showInstance(n.default.createElement(r,{downloadAction:o.DownloadAction.SAVE_TO_DROPBOX,id:"shared-link-immediate-signup-modal",initialMode:o.Mode.REGISTER,kind:o.LoginOrRegisterKind.DOWNLOAD,onAuthenticateSuccess:l,onCancel:a,signup_tag:"shmodel_modal_register",encryptionOptions:t}))}))}))},doMultiAccountAuthentication:function(t,o){return new Promise((function(i,a){new Promise((function(t,r){e(["modules/clean/auth/multi_account_login_modal"],t,r)})).then(r.__importStar).then((function(e){var r=e.MultiAccountLoginModal;s.Modal.showInstance(n.default.createElement(r,{onAuthenticateSuccess:i,onCancel:a,role:t,encryptionOptions:o}))}))}))}}})),define("modules/clean/react/share_download/models",["require","exports","tslib","immutable","react","modules/clean/filepath/filepath","modules/clean/react/file_viewer/constants","modules/clean/react/share_download/actions","modules/core/i18n","modules/core/exception","modules/clean/react/flows/conversions/actions/unzip"],(function(e,t,r,n,o,i,a,s,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareDownloadActionOption=void 0,n=r.__importStar(n),o=r.__importDefault(o),i=r.__importStar(i),s=r.__importStar(s);var u={text:void 0,handler:void 0,spriteName:void 0,isDisabled:void 0,userAction:void 0},p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.buildDirectOption=function(e,n,o){var i=this;return o||c.reportException({err:new Error("No encryption options for building direct download option"),severity:"non-critical",tags:["sharing-encryption-options"]}),new t({text:l.intl.formatMessage({id:"n1Nx/q",defaultMessage:"Direct download"}),handler:function(){return r.__awaiter(i,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,s.direct(e,n,o)];case 1:return t.sent(),[2]}}))}))},spriteName:"download_arrow",userAction:a.UserAction.Download})},t.buildToDropboxOption=function(e,r,n,d,u,p,f,m){void 0===p&&(p=!1),f||c.reportException({err:new Error("No encryption options for building to dropbox option"),severity:"non-critical",tags:["sharing-encryption-options"]});var h=l.intl.formatMessage({id:"l/lvUk",defaultMessage:"Save to my Dropbox"}),_="dropbox",v=a.UserAction.SaveToDropbox;if(d&&d.is_cdm_member){var g=i.filename(d.cdm_tmf_path);h=g.length>12?l.intl.formatMessage({id:"QPvsZL",defaultMessage:"Save to my member folder"}):l.intl.formatMessage({id:"VIDWC/",defaultMessage:"Save to <strong>{cdm_tmf_name}</strong> folder"},{cdm_tmf_name:g,strong:function(e){return o.default.createElement("strong",null,e)}}),n.is_paired&&(_="s_briefcase",v=a.UserAction.SaveToDropboxWork)}else if(n.is_paired)switch(u){case"personal":h=l.intl.formatMessage({id:"S5UJEB",defaultMessage:"Save to personal Dropbox"}),_="s_house",v=a.UserAction.SaveToDropboxPersonal;break;case"work":h=l.intl.formatMessage({id:"76AF1h",defaultMessage:"Save to {team_name} Dropbox"},{team_name:n.team_name}),_="s_briefcase",v=a.UserAction.SaveToDropboxWork}return new t({text:h,handler:function(){s.toDropbox(e,r,u,d,f,m)},spriteName:_,isDisabled:p,userAction:v,role:u})},t.extractToDropboxOption=function(e,r,n,o,s){void 0===s&&(s=!1);var c=l.intl.formatMessage({id:"IoJAyh",defaultMessage:"Extract to my Dropbox"}),u=a.UserAction.DecompressFile;if(e&&e.is_cdm_member){var p=i.filename(e.cdm_tmf_path);c=p.length>12?l.intl.formatMessage({id:"eN3/4H",defaultMessage:"Extract to my member folder"}):l.intl.formatMessage({id:"J+cK0b",defaultMessage:"Extract to {cdm_tmf_name} folder"},{cdm_tmf_name:p})}return new t({text:c,handler:function(){return d.UnzipAction.convert([r],e,o)},spriteName:"dropbox",isDisabled:s,userAction:u,role:n})},t})(n.Record(u));t.ShareDownloadActionOption=p})),define("modules/clean/react/share_download/util",["require","exports","tslib","react","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/utils","modules/clean/react/share_download/models","modules/clean/react/title_bar/overflow_menu","modules/clean/share_download/types","modules/clean/shared_link/types","modules/clean/viewer","modules/clean/loggers/folder_preview_logger","modules/clean/react/flows/conversions/actions/unzip","modules/clean/react/flows/conversions/utils"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m){"use strict";function h(e,t,r,n,o){var i=e.canCopyToDropboxRoles,a=[];if(i.length>0){var l=u.Viewer.get_viewer(),c=l.get_users(!0),d=function(e,c){var d=-1===i.indexOf(c);a.push(s.ShareDownloadActionOption.buildToDropboxOption(t,r,l,e,c,d,n,o))};c.forEach((function(e){d(e,e.role)})),i.indexOf("anonymous")>-1&&d(void 0,"anonymous")}return a}function _(e,t,r,n,o,i,a,l){var u=e.canDownloadRoles,p=s.ShareDownloadActionOption.buildDirectOption,_=[];return c.isPendingEntry(n)?_:(u.length>0&&_.push(p(t,o,i)),_.push.apply(_,h(e,r,n,i,l)),a&&c.isEntry(n)&&d.isEntrySharedFile(n)&&m.canConvertFile(n,e)&&f.UnzipAction.selector([n])&&_.push(s.ShareDownloadActionOption.extractToDropboxOption(a,n,a.role,r,!1)),_)}function v(e,t,r,n,o){return function(s){n&&n(),e.handler&&e.handler(),r?p.logEvent(e.userAction,r):i.logUserAction(e.userAction,a.getSplitButtonUserActionContext(t,o))}}Object.defineProperty(t,"__esModule",{value:!0}),t.isDownloadAllowed=t.getDownloadOptionsAsPopoverOrMobileItems=t.callOptionHandler=t.getDownloadOptions=t.getToDropboxOptions=void 0,n=r.__importDefault(n),t.getToDropboxOptions=h,t.getDownloadOptions=_,t.callOptionHandler=v,t.getDownloadOptionsAsPopoverOrMobileItems=function(e,t,r,i,a,s){return _(e,t,r,i,null,a,null,s).map((function(e){return n.default.createElement(l.PopoverOrMobileItem,{key:e.userAction,disabled:e.isDisabled,onSelect:v(e,o.SplitButtonActionLocation.Split,s)},e.text)}))},t.isDownloadAllowed=function(e){return e.canDownloadRoles.length>0}})),define("modules/clean/react/title_bar/overflow_menu",["require","exports","tslib","react","modules/core/browser_detection","modules/clean/react/title_bubble","modules/core/i18n","dig-components/icons","dig-components/icons/src","spectrum/popover/index","spectrum/mobile_menu/index","modules/clean/react/file_viewer/constants","modules/clean/react/sticky_position"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PopoverOrMobileItem=t.OverflowMenu=void 0;var f=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handlePopoverSelection=function(e,t){return e&&e(t)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.children,r=e.contentWrapperClassName,s=e.hideOnDisabled,l=e.direction,f=(function(e){var t=Array.isArray(e)?e.filter((function(e){return!!e})):e;return null==e||Array.isArray(t)&&0===t.length})(t);if(f&&s)return null;if(o.is_mobile_or_tablet())return n.default.createElement(d.MobileMenu,{trigger:function(e){var t=e.openMobileMenu;return n.default.createElement(m,{disabled:f,onClick:t})}},t);var h=l===u.OverflowMenuDirection.ABOVE?"above":"below",_=l===u.OverflowMenuDirection.ABOVE?p.StickyPosition.TOP:p.StickyPosition.BOTTOM;return n.default.createElement(c.Popover,{className:"more-button-popover",onSelection:this.handlePopoverSelection},n.default.createElement(c.PopoverTrigger,{"aria-label":a.intl.formatMessage({id:"oeNPkV",defaultMessage:"More actions"}),disabled:f},n.default.createElement(i.TitleBubble,{content:a.intl.formatMessage({id:"S6stj+",defaultMessage:"More"}),distanceFromTarget:10,isTargetPositionFixed:!0,position:_},n.default.createElement(m,{disabled:f}))),n.default.createElement("div",{className:r},n.default.createElement(c.PopoverContent,{attachment:"right",position:h},t)))},t})((n=r.__importDefault(n)).default.Component);function m(e){e.disabled;var t=e.onClick;return n.default.createElement("span",{"aria-label":a.intl.formatMessage({id:"S6stj+",defaultMessage:"More"}),className:"u-mar-left-xs more-button",onClick:t},n.default.createElement(s.UIIcon,{src:l.MoreHorizontalLine}))}t.OverflowMenu=f;var h=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSelect=function(e){o.is_mobile_or_tablet()&&e.preventDefault();var r=t.props.onSelect;return r&&r(e)},t}return r.__extends(t,e),t.prototype.render=function(){var e=o.is_mobile_or_tablet(),t=this.props,i=(t.onSelect,r.__rest(t,["onSelect"]));return e?n.default.createElement(d.MobileMenuItem,r.__assign({onSelect:this.onSelect},i)):n.default.createElement(c.PopoverContentItem,r.__assign({value:this.onSelect},i))},t})(n.default.Component);t.PopoverOrMobileItem=h})),define("modules/clean/share_download/types",["require","exports"],(function(e,t){"use strict";function r(e){return"ns_id"in e}Object.defineProperty(t,"__esModule",{value:!0}),t.isPendingEntry=t.isEntry=t.CopyableType=void 0,(function(e){e[e.Collection=0]="Collection",e[e.File=1]="File",e[e.Folder=2]="Folder"})(t.CopyableType||(t.CopyableType={})),t.isEntry=r,t.isPendingEntry=function(e){return r(e)&&null==e.ns_id}})),define("modules/clean/share_download/utils",["require","exports","modules/clean/share_download/types"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCopyableType=t.getCopyableName=void 0,t.getCopyableName=function(e){return r.isEntry(e)?e.filename:e.name},t.getCopyableType=function(e){return r.isEntry(e)?e.is_dir?r.CopyableType.Folder:r.CopyableType.File:r.CopyableType.Collection}})),define("modules/clean/shared_link/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEntrySharedFile=void 0,t.isEntrySharedFile=function(e){return"sjid"in e}})),define("modules/clean/react/copy_to_dropbox/button",["require","exports","tslib","react","modules/core/i18n","modules/clean/react/share_download/util","modules/clean/react/share_download/models","dig-components/buttons","spectrum/button/index","modules/clean/react/file_viewer/constants","modules/clean/react/share_download/button_component","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/utils","modules/clean/loggers/folder_preview_logger","classnames"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CopyToDropboxButton=void 0,n=r.__importDefault(n),m=r.__importDefault(m);var h=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentDidMount=function(){},t.prototype.onClickedOption=function(e,t){e.preventDefault(),t.handler(),this.props.folderPreviewSession?f.logEvent(t.userAction,this.props.folderPreviewSession):u.logUserAction(t.userAction,p.getSplitButtonUserActionContext(c.SplitButtonActionLocation.Main,this.props.location))},t.prototype.renderCopyToDropboxButton=function(){var e=this;if(0===this.props.sharePermission.canCopyToDropboxRoles.length)return null;var t=o.intl.formatMessage({id:"Y60BJ8",defaultMessage:"Save to Dropbox"}),r={"copy-to-dropbox-button":!0};this.props.shouldDisplayLayoutChange||(r.control__button=!0,r["control__button--collapsed"]=this.props.isCollapsed);var c=i.getToDropboxOptions(this.props.sharePermission,this.props.shareToken,this.props.copyable,this.props.encryptionOptions,this.props.folderPreviewSession);if(this.props.showDownloadOption&&this.props.sharedLinkInfo){var u=a.ShareDownloadActionOption.buildDirectOption(this.props.sharedLinkInfo,null,this.props.encryptionOptions);c.push(u)}if(1===c.length){if(this.props.shouldDisplayLayoutChange){var p=this.props.importance;return n.default.createElement(s.Button,{className:m.default(r),style:{display:"-webkit-box"},variant:p,onClick:function(t){return e.onClickedOption(t,c[0])},"aria-label":t},t)}p=this.props.importance;return n.default.createElement(l.Button,{className:m.default(r),style:{display:"-webkit-box"},variant:p,onClick:function(t){return e.onClickedOption(t,c[0])},"aria-label":t},t)}p=this.props.importance;return n.default.createElement(d.DownloadDropdown,{targetText:t+" ▾",options:c,onClick:this.props.onClick,location:this.props.location,importance:p,title:o.intl.formatMessage({id:"Y60BJ8",defaultMessage:"Save to Dropbox"}),isCollapsed:this.props.isCollapsed,isDisabled:!1,folderPreviewSession:this.props.folderPreviewSession})},t.prototype.render=function(){return n.default.createElement("div",null,this.renderCopyToDropboxButton())},t})(n.default.Component);t.CopyToDropboxButton=h})),define("modules/clean/react/share_download/button_component",["require","exports","tslib","classnames","prop-types","react","dig-components/buttons","spectrum/button/index","spectrum/popover/index","modules/clean/filepath/filepath","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/utils","modules/clean/react/share_download/util","modules/clean/react/share_download/models","modules/clean/react/share_download/util","modules/clean/share_download/types","modules/clean/react/title_bubble","modules/core/i18n","modules/core/browser_detection","modules/clean/react/file_viewer_sidebar/buttons/icon","modules/clean/loggers/folder_preview_logger","modules/clean/react/sticky_position","dig-components/icons","dig-components/icons/src"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m,h,_,v,g,y,b,w,S,E,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareDownloadButton=t.DownloadDropdown=t.DownloadSimpleButton=void 0,n=r.__importDefault(n),o=r.__importDefault(o),i=r.__importDefault(i),c=r.__importStar(c);var k=function(e){return!y.is_mobile_or_tablet()&&e.title&&e.isCollapsed?i.default.createElement(v.TitleBubble,{content:e.title,isTargetPositionFixed:!0,position:S.StickyPosition.LEFT},e.children):i.default.createElement(i.default.Fragment,null,e.children)},F=(function(e){function t(t){var r=e.call(this,t)||this;return r.state={isDisabled:!0},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.setState({isDisabled:this.props.isDisabled})},t.prototype.render=function(){var e={"download-button":!0,control__button:!0,"control__button--collapsed":this.props.isCollapsed};return this.props.className&&(e[this.props.className]=!0),i.default.createElement(k,{title:this.props.title,isCollapsed:this.props.isCollapsed},i.default.createElement(a.Button,{className:n.default(e),style:{display:"-webkit-box"},variant:this.props.importance,disabled:this.state.isDisabled,onClick:this.props.onClick,"aria-label":this.props.title,withIconLeft:i.default.createElement(E.UIIcon,{src:M.DownloadLine})},this.props.children))},t.defaultProps={isDisabled:!1,importance:"opacity"},t})(i.default.Component),P=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this,t="secondary"===this.props.importance?"opacity":this.props.importance;return i.default.createElement(F,{isDisabled:this.props.isDisabled,onClick:function(t){t.preventDefault(),e.props.onClick&&e.props.onClick(e.props.option),e.props.option.handler(),e.props.folderPreviewSession?w.logEvent(e.props.option.userAction,e.props.folderPreviewSession):d.logUserAction(e.props.option.userAction,p.getSplitButtonUserActionContext(u.SplitButtonActionLocation.Main,e.props.location))},importance:t,isCollapsed:this.props.isCollapsed,title:this.props.title},this.props.isCollapsed?i.default.createElement(b.ButtonIcon,{name:"download-file",isPrimary:"primary"===this.props.importance}):this.props.targetText)},t})(i.default.Component);t.DownloadSimpleButton=P;var A=(function(e){function t(t){var r=e.call(this,t)||this;return r.onPopoverSelection=function(e){f.callOptionHandler(e,u.SplitButtonActionLocation.Split,r.props.folderPreviewSession,r.props.onClick,r.props.location)()},r.state={isDisabled:!0},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.setState({isDisabled:this.props.isDisabled})},t.prototype.renderIcon=function(){return i.default.createElement(b.ButtonIcon,{name:"download-file",isPrimary:"primary"===this.props.importance,"aria-label":this.props.title})},t.prototype.renderPopover=function(){var e=this.props.options.map((function(e){return i.default.createElement(l.PopoverContentItem,{key:e.text,value:e,disabled:e.isDisabled},e.text)})),t={"download-button":!0,control__button:!0,"control__button--collapsed":this.props.isCollapsed};return i.default.createElement(l.Popover,{key:"download-dropdown",onSelection:this.onPopoverSelection,className:n.default(t)},i.default.createElement(l.PopoverTrigger,{"aria-label":this.props.title},i.default.createElement(k,{title:this.props.title,isCollapsed:this.props.isCollapsed},i.default.createElement(s.Button,{tagName:"span",variant:this.props.importance,disabled:this.state.isDisabled,"aria-label":this.props.title},this.props.isCollapsed?this.renderIcon():this.props.targetText))),i.default.createElement(l.PopoverContent,{attachment:"right"},e))},t.prototype.render=function(){var e="secondary"===this.props.importance?"opacity":this.props.importance;return this.props.isDisabled?i.default.createElement(F,{isDisabled:!0,importance:e,title:this.props.title,isCollapsed:this.props.isCollapsed},this.props.isCollapsed?this.renderIcon():this.props.targetText):this.renderPopover()},t.defaultProps={importance:"secondary"},t})(i.default.Component);t.DownloadDropdown=A;var T=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.getTargetText=function(e){if(f.isDownloadAllowed(this.props.sharePermission))return e>1?{title:g.intl.formatMessage({id:"0YRjqy",defaultMessage:"Download ▾"})}:{title:g.intl.formatMessage({id:"pHnJw0",defaultMessage:"Download"})};if(this.props.user&&this.props.user.is_cdm_member){var t=c.filename(this.props.user.cdm_tmf_path);return t.length>25?{title:g.intl.formatMessage({id:"6m85k6",defaultMessage:"Add to my member folder"})}:{label:g.intl.formatMessage({id:"ck1w+U",defaultMessage:"Add to <strong>{cdm_tmf_name}</strong> folder"},{cdm_tmf_name:t,strong:function(e){return i.default.createElement("strong",{style:{fontWeight:800}},e)}}),title:g.intl.formatMessage({id:"nzqkZQ",defaultMessage:"Add to {cdm_tmf_name} folder"},{cdm_tmf_name:t})}}return{title:g.intl.formatMessage({id:"N8ovVA",defaultMessage:"Add to Dropbox"})}},t.prototype.getTooltipLabel=function(){return _.isPendingEntry(this.props.copyable)?g.intl.formatMessage({id:"DldXvN",defaultMessage:"Download is unavailable while file is uploading."}):g.intl.formatMessage({id:"gUTeT9",defaultMessage:"Downloads disabled."})},t.prototype.render=function(){var e=h.getDownloadOptions(this.props.sharePermission,this.props.sharedLinkInfo,this.props.shareToken,this.props.copyable,this.context.authModalKind||null,this.props.encryptionOptions,this.props.user,this.props.folderPreviewSession);if(this.props.downloadOnly){var t=new m.ShareDownloadActionOption({isDisabled:!0}),r=!0;return f.isDownloadAllowed(this.props.sharePermission)&&(t=m.ShareDownloadActionOption.buildDirectOption(this.props.sharedLinkInfo,null,this.props.encryptionOptions),r=!1),i.default.createElement(P,{isDisabled:r,targetText:g.intl.formatMessage({id:"pHnJw0",defaultMessage:"Download"}),title:g.intl.formatMessage({id:"pHnJw0",defaultMessage:"Download"}),option:t,onClick:this.props.onClick,location:this.props.location,importance:this.props.importance,isCollapsed:this.props.isCollapsed,folderPreviewSession:this.props.folderPreviewSession})}if(0===e.length)return i.default.createElement(A,{targetText:g.intl.formatMessage({id:"pHnJw0",defaultMessage:"Download"}),isDisabled:!0,options:[new m.ShareDownloadActionOption({isDisabled:!0})],onClick:this.props.onClick,location:this.props.location,title:this.getTooltipLabel(),importance:this.props.importance,isCollapsed:this.props.isCollapsed,folderPreviewSession:this.props.folderPreviewSession});var n=this.getTargetText(e.length);return 1===e.length?i.default.createElement(P,{isDisabled:!1,targetText:n.label||n.title,title:n.title,option:e[0],onClick:this.props.onClick,location:this.props.location,importance:this.props.importance,isCollapsed:this.props.isCollapsed,folderPreviewSession:this.props.folderPreviewSession}):i.default.createElement(A,{targetText:n.label||n.title,options:e,onClick:this.props.onClick,location:this.props.location,isDisabled:!1,importance:this.props.importance,isCollapsed:this.props.isCollapsed,title:g.intl.formatMessage({id:"pHnJw0",defaultMessage:"Download"}),folderPreviewSession:this.props.folderPreviewSession})},t.contextTypes={authModalKind:o.default.oneOf(["immediate","download",null])},t})(i.default.Component);t.ShareDownloadButton=T})),define("modules/clean/react/shared_link_folder/page",["require","exports","tslib","classnames","react","modules/clean/analytics","modules/clean/components/loading_indicator","modules/clean/react/browse/sort_helpers","modules/clean/react/components/css","modules/clean/react/async/loadable","modules/clean/em_string","modules/clean/react/open_in_app/banner","modules/clean/react/shared_link_folder/folder_icon","modules/clean/react/shared_link_folder/grid","modules/clean/react/shared_link_folder/list","modules/clean/react/shared_link_folder/view_toggle","modules/clean/react/takedown_warning","spectrum-sharing/utils/sharing_constants","modules/clean/web_timing_logger","modules/core/i18n","modules/clean/react/icon/icon_helper","modules/clean/react/size_class/size_class","modules/clean/react/size_class/constants","modules/clean/loggers/folder_preview_logger","modules/clean/react/file_viewer/app_download_interstitial/app_download_interstitial","modules/clean/react/shared_link_folder/folder_title","modules/core/i18n","modules/clean/bug_reporting/routing","modules/clean/react/branding/optional_branding_block","modules/clean/react/branding/branding_modal_controller","modules/clean/react/share_sync/button","modules/clean/react/copy_to_dropbox/button","modules/clean/react/share_download/button","retrieval-components/view-mode-toggle/index"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m,h,_,v,g,y,b,w,S,E,M,k,F,P,A,T,C,D,x,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedLinkFolderPage=t._SharedLinkFolderPage=void 0,n=r.__importDefault(n),o=r.__importDefault(o),g=r.__importStar(g);var I=c.Loadable({loader:function(){return new Promise((function(t,r){e(["modules/clean/react/shared_link_folder/title_bar"],t,r)})).then(r.__importStar).then((function(e){return e.SharedLinkFolderTitleBar}))}}),L=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={openInAppBannerClosed:!1,currentMode:O.ViewMode.LIST},t.shouldShowOpenInAppBanner=function(){var e=t.props.folder,r=t.state.openInAppBannerClosed;return e&&e.open_in_app_data&&!r},t.onOpenInAppClosed=function(){t.setState((function(e){return{openInAppBannerClosed:!0,currentMode:e.currentMode}}))},t.changeViewMode=function(e,r){t.setState((function(t){return{openInAppBannerClosed:t.openInAppBannerClosed,currentMode:e}}))},t.onInterstitialClose=function(){E.logEvent(E.EventType.appDownloadInterstitialClose,t.props.folderPreviewSession),t.props.onAppDownloadInterstitialDismissed()},t.onInterstitialContinue=function(){E.logEvent(E.EventType.appDownloadInterstitialContinue,t.props.folderPreviewSession),t.props.onAppDownloadInterstitialDismissed()},t.onAppDownload=function(){E.logEvent(E.EventType.appDownloadInterstitialInstall,t.props.folderPreviewSession)},t.handleBreadcrumbClick=function(e){var n=t.props,o=n.breadcrumbs,i=n.folderPreviewSession;i.extra=r.__assign(r.__assign({},i.extra),{origin_breadcrumb:o.length-1,destination_breadcrumb:e}),E.logEvent(E.EventType.breadcrumbClicked,i)},t}return r.__extends(t,e),t.prototype.componentWillMount=function(){E.logEvent(E.EventType.attempted,this.props.folderPreviewSession)},t.prototype.componentWillUnmount=function(){E.logEvent(E.EventType.ended,this.props.folderPreviewSession)},t.prototype.componentDidMount=function(){this.ensureWebTimingMarked(),this.logSclTiming(),this.shouldShowAppDownloadInterstitial()&&E.logEvent(E.EventType.appDownloadInterstitialView,this.props.folderPreviewSession)},t.prototype.componentDidUpdate=function(){this.ensureWebTimingMarked()},t.prototype.componentDidCatch=function(){E.logEvent(E.EventType.renderFailed,this.props.folderPreviewSession)},t.prototype.shouldShowAppDownloadInterstitial=function(){var e=this.props,t=e.folder;return!e.appDownloadInterstitialDismissed&&t&&t.open_in_app_data},t.prototype.ensureWebTimingMarked=function(){var e=this.props,t=e.contents,r=t.files,n=t.folders,o=e.hasMore,i=e.webTimer;(r.length>0||n.length>0||!o)&&(i&&(i.timeToView()||i.markTimeToView(),i.timeToInteractive()||i.markTimeToInteractive()),E.markPrimaryEvent(this.props.folderPreviewSession),E.logEvent(E.EventType.renderSucceeded,this.props.folderPreviewSession))},t.prototype.logSclTiming=function(){if(this.props.user&&this.props.folderShareToken.linkType===v.SharedLinkType.Content){var e=(new Date).getTime(),t={ns_id:this.props.folder.shared_folder_id,timing:e-g.start_time()};i.ShareTibEventLogger.log(this.props.user.id,"PREVIEW_RENDER",v.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,t)}},t.prototype.render=function(){var e=this.props,t=e.accountMenuOptions,r=e.brandingInfo,i=e.breadcrumbs,s=e.contents,l=e.folder,c=e.folderSharePermission,p=e.folderShareToken,f=e.folderSharedLinkInfo,m=e.folderPreviewSession,v=e.hasMore,g=e.onFileOpen,b=e.onFolderOpen,w=e.onListModeDisable,E=e.onListModeEnable,F=e.outOfQuota,C=e.shouldForceListMode,D=e.showSyncCoachmark,x=e.sizeClass,O=e.takedownRequestType,L=e.user,N=e.encryptionOptions,R=e.shouldDisplayLayoutChange;m.extra.size_class=x;var U,H=o.default.createElement(k.FolderTitle,{title:d.Emstring.em_snippet(l.filename,x!==S.SizeClass.Small?35:20),ownerName:f.ownerName,ownerTeamName:f.ownerTeamName,ownerTeamLogo:f.ownerTeamLogo,breadcrumbs:i,onCrumbClick:this.handleBreadcrumbClick}),j=n.default("sl-page-body",{"view-in-app-bar-present":this.shouldShowOpenInAppBanner()});if(this.shouldShowAppDownloadInterstitial()){var B=f.displayName;U=o.default.createElement("div",{"aria-label":B},o.default.createElement(M.AppDownloadInterstitial,{isFolder:!0,fileOrFolderName:B,open_in_app_data:l.open_in_app_data,ownerName:f.ownerName,ownerTeamName:f.ownerTeamName,onClose:this.onInterstitialClose,onContinue:this.onInterstitialContinue,onAppDownload:this.onAppDownload}))}return o.default.createElement(P.RegisterComponentWithBugReporter,{componentId:"web.folder_viewer",componentName:"Shared Folder Viewer"},o.default.createElement("div",null,o.default.createElement("div",{className:"sl-page-container"},o.default.createElement("div",{className:"sl-page-header"},o.default.createElement(I,{accountMenuOptions:t,folder:l,outOfQuota:F,sharedLinkInfo:f,shareToken:p,sharePermission:c,showSyncCoachmark:D,sizeClass:x,title:x===S.SizeClass.Small?H:void 0,user:L,encryptionOptions:N,folderPreviewSession:m,shouldDisplayLayoutChange:R}),this.shouldShowOpenInAppBanner()?o.default.createElement(u.OpenInAppBanner,{urls:l.open_in_app_data,onClose:this.onOpenInAppClosed}):null),o.default.createElement("div",{className:j},o.default.createElement(A.OptionalBrandingBlock,{brandingInfo:r,className:"sl-branding-header",sharedLinkInfo:f}),o.default.createElement("div",{className:"sl-header clearfix"},o.default.createElement("h3",{className:"sl-title"},null!=O?o.default.createElement("div",{className:"sl-takedown-warning"},o.default.createElement(_.TakedownWarning,{takedownType:O})):null,x!==S.SizeClass.Small?H:null)),R?o.default.createElement("div",{className:"sl-buttons"},this.renderCTAButtons(l,F,f,c,p,D,L,N,m,R),o.default.createElement("div",{className:"sl-cta"}),o.default.createElement("div",{className:"sl-view-toggle"},o.default.createElement(h.FolderViewModeToggle,{onViewModeChanged:this.changeViewMode,currentViewMode:this.state.currentMode}))):null,o.default.createElement(q,{files:s.files,folder:l,hasMore:v,shouldForceListMode:C,sizeClass:x,subfolders:s.folders,onListModeDisable:w,onListModeEnable:E,onFolderOpen:b,onFileOpen:g,shouldDisplayLayoutChange:R,currentMode:this.state.currentMode}),v?o.default.createElement("div",{className:"sl-loading-indicator"},o.default.createElement(a.LoadingIndicator,{style:a.LoadingIndicator.LoadingIndicatorStyle.BLUE_SPINNER})):null)),U||o.default.createElement(T.BrandingModalController,{brandingInfo:r,closeButtonText:y.intl.formatMessage({id:"eC3oZ9",defaultMessage:"View folder"}),sharedLinkInfo:f})))},t.prototype.renderCTAButtons=function(e,t,r,n,i,a,s,l,c,d){var u=n.canSyncToDropboxRoles,p=i.linkType!==v.SharedLinkType.Shmodel&&u.length>0;return o.default.createElement(o.default.Fragment,null,p&&c?o.default.createElement(C.ShareSyncButton,{folder:e,outOfQuota:t,sharedLinkInfo:r,sharePermission:n,shareToken:i,showSyncCoachmark:a,user:s,folderPreviewSession:c}):null,o.default.createElement(D.CopyToDropboxButton,{shareToken:i,sharedLinkInfo:r,sharePermission:n,copyable:e,encryptionOptions:l,user:s,folderPreviewSession:c,importance:"primary",showDownloadOption:!1,shouldDisplayLayoutChange:d}),o.default.createElement(x.ShareDownloadButton,{copyable:e,sharedLinkInfo:r,shareToken:i,sharePermission:n,user:s,downloadOnly:!0,encryptionOptions:l,folderPreviewSession:c}))},t.defaultProps={shouldForceListMode:!1,webTimer:g.get_timer()},t})(o.default.PureComponent);t._SharedLinkFolderPage=L;var N=l.requireCssWithComponent(L,["/static/css/react_title_bar-vflSGo9Xd.css","/static/css/react_file_viewer-vfldZQLtI.css"]),R=w.withSizeClass(N);t.SharedLinkFolderPage=R;function U(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]);var n,o=(n=F.case_insensitive_comparator(!0),function(e,t){return s.compare(e.filename,t.filename,1,n)});return r.__spreadArrays(t,e).sort(o)}function H(e){return o.default.createElement("div",{className:"sl-body sl-body--empty-folder"},o.default.createElement(p.SharedLinkFolderFolderIcon,{className:"sl-empty-folder-icon",folder:e.folder,size:b.SpectrumIconSize.Large}),o.default.createElement("h3",{className:"sl-empty-folder-message"},y.intl.formatMessage({id:"YLBqRL",defaultMessage:"This folder is empty"})))}function q(e){var t=e.files,r=e.folder,n=e.hasMore,i=e.shouldForceListMode,a=e.sizeClass,s=e.subfolders,l=e.onFileOpen,c=e.onFolderOpen,d=e.shouldDisplayLayoutChange,u=e.currentMode,p=U(t,s);if(!p.length&&!n)return o.default.createElement(H,{folder:r});if(!d)return o.default.createElement("div",{className:"sl-body"},i?[o.default.createElement(m.SharedLinkFolderList,{key:"list",entries:p,sizeClass:a,onFolderOpen:c,onFileOpen:l}),o.default.createElement(h.FolderViewToggleOption,{key:"toggler",icon:"grid_light",label:y.intl.formatMessage({id:"vEc1Xz",defaultMessage:"View as grid"}),onClick:e.onListModeDisable})]:[o.default.createElement(f.SharedLinkFolderGrid,{key:"grid",entries:p,onFolderOpen:c,onFileOpen:l}),o.default.createElement(h.FolderViewToggleOption,{key:"toggler",icon:"list_light",label:y.intl.formatMessage({id:"XLVIFy",defaultMessage:"View as list"}),onClick:e.onListModeEnable})]);switch(u){case O.ViewMode.LIST:return o.default.createElement("div",{className:"sl-body"},o.default.createElement(m.SharedLinkFolderList,{key:"list",entries:p,sizeClass:a,onFolderOpen:c,onFileOpen:l}));case O.ViewMode.CONDENSED_LIST:return o.default.createElement("div",{className:"sl-body"},o.default.createElement(m.SharedLinkFolderList,{key:"list",entries:p,sizeClass:a,onFolderOpen:c,onFileOpen:l,smallList:!0}));case O.ViewMode.TILE:return o.default.createElement("div",{className:"sl-body"},o.default.createElement(f.SharedLinkFolderGrid,{key:"grid",entries:p,onFolderOpen:c,onFileOpen:l,largeGrid:!0}));case O.ViewMode.GRID:default:return o.default.createElement("div",{className:"sl-body"},o.default.createElement(f.SharedLinkFolderGrid,{key:"grid",entries:p,onFolderOpen:c,onFileOpen:l}))}}})),define("modules/clean/react/shared_link_folder/app",["require","exports","tslib","lodash","react","redux","react-redux","modules/clean/cloud_docs/open_with_utils","modules/clean/loggers/folder_preview_logger","modules/clean/open_in_app/actions","modules/clean/previews/constants","modules/clean/react/async/loadable","modules/clean/react/file_viewer/data/actions","modules/clean/react/file_viewer/data/selectors","modules/clean/react/file_viewer/location_utils","modules/clean/react/location/with_location","modules/clean/react/file_viewer/url_utils","modules/clean/react/previews/constants","modules/clean/react/shared_link_folder/data/actions","modules/clean/react/shared_link_folder/data/store","modules/clean/react/shared_link_folder/page","modules/clean/viewer","modules/clean/web_timing_logger","modules/constants/python","modules/clean/web_timing_logger","modules/core/persistence/storage","modules/constants/page_load","modules/core/langpack","react-intl","modules/core/i18n","modules/clean/react/shared_link_folder/utils","modules/clean/react/shared_link_folder/data/selectors","modules/clean/csrf","modules/core/browser","modules/clean/react/file_viewer/utils"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m,h,_,v,g,y,b,w,S,E,M,k,F,P,A,T,C,D,x,O,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedLinkFolderApp=t._SharedLinkFolderApp=t.AsyncFileCollectionViewer=void 0,n=r.__importStar(n),o=r.__importDefault(o),M=r.__importStar(M),P=r.__importStar(P);var L=n.memoize((function(){return new Promise((function(t,r){e(["modules/clean/react/file_viewer/collection_viewer"],t,r)})).then(r.__importStar)}));t.AsyncFileCollectionViewer=u.Loadable({loader:function(){return L().then((function(e){return e.FileCollectionViewer}))}});var N=function(e){return{label:e.filename,href:e.href}};function R(){var e=M.get_timer();return e.timeToInteractive()&&(e=M.get_timer("shared_link_folder_ajax")).initialize({requireTTI:!0,requireTTV:!0,url:"shared_link_folder_ajax"}),e}var U=(function(i){function a(e){var t,r,n=i.call(this,e)||this;n.handleOpenFile=function(e){e.preview_type&&e.preview_type===d.PreviewType.CloudDoc&&!s.isShortcut(e)?O.open_tab(e.href):n.previewDataPromise?n.previewDataPromise.then((function(){return _.openFile(e)})):_.openFile(e)},n.handleOpenFolder=function(e){n.previewDataPromise?n.previewDataPromise.then((function(){return C.openFolder(e)})):C.openFolder(e)};var o=w.Viewer.get_viewer(),a=o.work_user||o.personal_user,c=e.folderShareToken.secureHash,u=e.folderData,p=e.shouldFetchPreviewData;return n.state={folderHierarchyMap:(t={},t[c]=u?[u]:[],t),pageYOffset:0,previewSourceAction:v.PreviewSourceAction.Visit,user:a},n.folderPreviewSession=l.createSession({subfolder_nav_tracking:e.subfolderNavTracking,use_odyssey:p,folder_id:null===(r=e.folder)||void 0===r?void 0:r.folder.folder_id}),n.webTimer=R(),n}return r.__extends(a,i),a.prototype.componentWillMount=function(){if(this.webTimer.applicationStart(),this.props.openImmediatelyInApp)return this.openImmediatelyInApp()},a.prototype.componentWillUnmount=function(){this.unsubscribe()},a.prototype.componentWillReceiveProps=function(e){var t,r;!this.props.viewingFilename&&e.viewingFilename&&this.setState({pageYOffset:window.pageYOffset}),this.props.viewingFilename!==e.viewingFilename&&this.setState({previewSourceAction:v.PreviewSourceAction.Click});var n=e.folder?e.folder.folder.ns_id:void 0;e.folderShareToken.secureHash!==this.props.folderShareToken.secureHash?(this.webTimer=R(),this.webTimer.restart(),this.folderPreviewSession=l.createSession({source_action:v.PreviewSourceAction.Click,subfolder_nav_tracking:e.subfolderNavTracking,has_cached_data:e.folder&&!!e.folder.entries.length,ns_id:n,folder_id:null===(t=e.folder)||void 0===t?void 0:t.folder.folder_id}),this.props.onFolderLoad(e.folderShareToken,this.webTimer)):this.props.viewingFilename&&!e.viewingFilename&&(this.folderPreviewSession=l.createSession({source_action:v.PreviewSourceAction.FileViewerExit,subfolder_nav_tracking:e.subfolderNavTracking,has_cached_data:!0,ns_id:n,folder_id:null===(r=e.folder)||void 0===r?void 0:r.folder.folder_id})),e.folder&&e.folder.folder&&C.setPageTitle(e.folder.folder.filename)},a.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,t,o,i,a;return r.__generator(this,(function(r){switch(r.label){case 0:return e=this.props,t=e.file,o=e.folderShareToken,i=e.onFolderPrefetch,e.viewingFilename&&window.setTimeout(I.cleanupPrerenderPreview),o&&(this.previewDataPromise=i(o,t)),[4,S.waitForTTI()];case 1:return r.sent(),L(),[4,this.readFolderHierarchy()];case 2:return a=r.sent(),this.setState((function(e,t){var r=t.folderShareToken.secureHash;return{folderHierarchyMap:n.get(a,r)?a:e.folderHierarchyMap}})),[2]}}))}))},a.prototype.componentDidUpdate=function(e){var t=this.props.viewingFilename,n=this.state.pageYOffset;t!==e.viewingFilename&&(t||window.scrollTo(0,n));var o=e.folderShareToken.secureHash,i=this.props.folderShareToken.secureHash;o!==i&&this.setState((function(t,n){var a;if(!n.folder||!C.shouldUpdateFolderHierarchy(t.folderHierarchyMap,e.folderShareToken,n.folderShareToken))return{folderHierarchyMap:t.folderHierarchyMap};var s=n.folder.folder;return{folderHierarchyMap:r.__assign(r.__assign({},t.folderHierarchyMap),(a={},a[i]=r.__spreadArrays(t.folderHierarchyMap[o],[s]),a))}}),this.writeFolderHierarchy)},a.prototype.getUserStorageKey=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,n;return r.__generator(this,(function(o){switch(o.label){case 0:return[4,new Promise((function(t,r){e(["sjcl"],t,r)})).then(r.__importStar)];case 1:return t=o.sent(),n=t.hash.sha256.hash(x.readCsrfToken()||""),[2,t.codec.base64.fromBits(n)]}}))}))},a.prototype.writeFolderHierarchy=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,t,n,o;return r.__generator(this,(function(r){switch(r.label){case 0:return t=(e=k.SessionStorage).set,n=["shared_folder_hierarchy"],o={},[4,this.getUserStorageKey()];case 1:return t.apply(e,n.concat([(o[r.sent()]=this.state.folderHierarchyMap,o)])),[2]}}))}))},a.prototype.readFolderHierarchy=function(){return r.__awaiter(this,void 0,void 0,(function(){var e,t,o;return r.__generator(this,(function(r){switch(r.label){case 0:return t=(e=n).get,o=[k.SessionStorage.get("shared_folder_hierarchy")],[4,this.getUserStorageKey()];case 1:return[2,t.apply(e,o.concat([r.sent()]))]}}))}))},a.prototype.openImmediatelyInApp=function(){var e=this.props.folder;if(e)try{e.folder.open_in_app_data&&c.openImmediately(e.folder.open_in_app_data)}catch(e){}},a.prototype.render=function(){var e=this.props,r=e.accountMenuOptions,i=e.appDownloadInterstitialDismissed,a=e.brandingInfo,s=e.file,l=e.files,c=e.fileViewOrigin,d=e.fileViewTarget,u=e.folder,p=e.onAppDownloadInterstitialDismissed,f=e.outOfQuota,m=e.shouldForceListMode,h=e.showSyncCoachmark,g=e.subfolders,y=e.viewingFilename,w=e.encryptionOptions,S=e.shouldDisplayLayoutChange,M=this.state,k=M.folderHierarchyMap,F=M.user,P=M.previewSourceAction,A=n.get(k,this.props.folderShareToken.secureHash,[]).map(N);if(y&&s){var T=[],D=[],x=[],O=[];return Array.isArray(l)&&l.length?l.forEach((function(e,t){D.push(e.shareToken),x.push(e.sharedLinkInfo),T.push(e.sharePermission),O.push(e.file)})):(O=[s.file],T=[s.sharePermission],D=[s.shareToken],x=[s.sharedLinkInfo]),o.default.createElement(t.AsyncFileCollectionViewer,{brandingInfo:a,canClose:!0,className:"no-background",file:s.file,files:O,fileViewOrigin:c,fileViewTarget:d,fileViewAction:E.FileViewActionType.CLICK,initialPreviewSourceContext:v.PreviewSourceContext.SharedLinkFolder,initialPreviewSourceAction:P,skipOuterRouting:!0,sharedLinkInfos:x,sharePermissions:T,shareTokens:D,titleBarCloseUrl:_.getCurrentFolderHref(),onCloseViewer:_.closeFile,user:F,encryptionOptions:w})}if(!u)return null;var I=u.shareToken,L=u.sharedLinkInfo,R=u.folder,U=u.sharePermission,H=u.hasMore,q=u.takedownRequestType,j={files:Array.isArray(l)?l.map((function(e){return e.file})):[],folders:Array.isArray(g)?g.map((function(e){return e.folder})):[]};return R.folder_id&&(this.folderPreviewSession.extra.folder_id=R.folder_id),o.default.createElement(b.SharedLinkFolderPage,{accountMenuOptions:r,appDownloadInterstitialDismissed:i,brandingInfo:a,breadcrumbs:A,contents:j,folder:R,folderPreviewSession:this.folderPreviewSession,folderSharePermission:U,folderShareToken:I,folderSharedLinkInfo:L,hasMore:H,onAppDownloadInterstitialDismissed:p,onFileOpen:this.handleOpenFile,onFolderOpen:this.handleOpenFolder,onListModeDisable:C.disableListMode,onListModeEnable:C.enableListMode,outOfQuota:f,shouldForceListMode:m,showSyncCoachmark:h,takedownRequestType:q,user:F,webTimer:this.webTimer,encryptionOptions:w,shouldDisplayLayoutChange:S})},a.defaultProps={subfolderNavTracking:!1},a})(o.default.PureComponent);t._SharedLinkFolderApp=U;var H=a.connect((function(e,t){var r=f.getAppDownloadInterstitial(e);void 0===r&&(r=t.appDownloadInterstitialDismissed);var n=t.folderShareToken.secureHash,o=t.viewingFilename;return{appDownloadInterstitialDismissed:r,file:D.getSharedFilePackageByFilenameForFolderPath(e,n,o||""),folder:D.getFolderByPath(e,n),files:D.getSharedFilePackagesForFolderPath(e,n),subfolders:D.getSubfoldersForFolderPath(e,n)}}),(function(e,t){var r=t.shouldFetchPreviewData;return i.bindActionCreators({onAppDownloadInterstitialDismissed:p.dismissAppDownloadInterstitial,onFolderLoad:g.fetchFolder,onFolderPrefetch:r?g.prefetchFolderFromOdyssey:g.prefetchFolder},e)}))(U),q=h.withLocation(H,(function(e){return{folderShareToken:C.getFolderShareTokenFromLocation(e),viewingFilename:m.getFilenameFromLocation(e),shouldForceListMode:"lst"in e.query,subfolderNavTracking:"subfolder_nav_tracking"in e.query}})),j=(function(e){function t(t){var r=e.call(this,t)||this;return r.store=y.getStoreForSharedLinkFolder(),y.hydrateStore(r.store,{initialFolder:r.props.folderData,initialPreview:r.props.preview,folderSharedLinkInfo:r.props.folderSharedLinkInfo,folderSharePermission:r.props.folderSharePermission,folderShareToken:r.props.folderShareToken}),r}return r.__extends(t,e),t.prototype.render=function(){return o.default.createElement(A.IntlProvider,{defaultLocale:"en-US",locale:T.localeToBcp47LangTag(F.USER_LOCALE),messages:P},o.default.createElement(a.Provider,{store:this.store},o.default.createElement(q,r.__assign({},this.props))))},t})(o.default.Component);t.SharedLinkFolderApp=j})),define("spectrum/mobile_menu/index",["require","exports","tslib","spectrum/mobile_menu/mobile_menu","spectrum/mobile_menu/mobile_menu_close_button","spectrum/mobile_menu/mobile_menu_content","spectrum/mobile_menu/mobile_menu_item"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(n,t),r.__exportStar(o,t),r.__exportStar(i,t),r.__exportStar(a,t)})),define("modules/clean/loggers/folder_preview_logger",["require","exports","tslib","modules/clean/deprecated_ajax/ajax_jquery","modules/core/browser","modules/constants/request","modules/clean/react/previews/constants","modules/clean/web_timing_logger","modules/clean/uuid/uuid","modules/clean/loggers/device_type"],(function(e,t,r,n,o,i,a,s,l,c){"use strict";var d;function u(e){return+!!e}function p(e){return JSON.stringify(r.__assign(r.__assign({},e),{has_cached_data:u(e.has_cached_data),folder_preview_timeline:JSON.stringify(e.folder_preview_timeline),subfolder_nav_tracking:u(e.subfolder_nav_tracking),web_timing_data:JSON.stringify(e.web_timing_data)}))}function f(e){var t=r.__assign({},e.extra),n=o.performance();if(null!=n){var i=n.timing;i&&i.fetchStart&&(t.time_to_first_byte=i.responseStart-i.fetchStart,t.web_timing_data=i)}return{device_type:e.deviceType,folder_preview_session_id:e.id,folder_ns_id:e.ns_id||0,web_request_id:e.web_request_id,extra:p(t)}}Object.defineProperty(t,"__esModule",{value:!0}),t.logEvent=t.markPrimaryEvent=t.createSession=t.EventType=void 0,n=r.__importStar(n),o=r.__importStar(o),i=r.__importStar(i),(function(e){e.attempted="preview_attempted",e.renderSucceeded="render_succeeded",e.renderFailed="render_failed",e.ended="preview_session_ended",e.appDownloadInterstitialClose="app_download_interstitial_close",e.appDownloadInterstitialContinue="app_download_interstitial_continue",e.appDownloadInterstitialInstall="app_download_interstitial_install",e.appDownloadInterstitialView="app_download_interstitial_view",e.breadcrumbClicked="breadcrumb_clicked"})(d=t.EventType||(t.EventType={})),t.createSession=function(e){var t=void 0===e?{}:e,r=t.id,n=void 0===r?l.UUID.v4({allowInsecure:!0}):r,d=t.ns_id,u=void 0===d?0:d,p=t.deviceType,f=void 0===p?c.getDeviceType():p,m=t.web_request_id,h=void 0===m?i.REQUEST_ID:m,_=t.source_action,v=void 0===_?a.PreviewSourceAction.Visit:_,g=t.subfolder_nav_tracking,y=t.has_cached_data,b=t.use_odyssey,w=void 0!==b&&b,S=t.folder_id;return{id:n,ns_id:u,web_request_id:h,deviceType:f,extra:{start_time:v===a.PreviewSourceAction.Visit?s.start_time():o.now(),subfolder_nav_tracking:g,has_cached_data:y,source_action:v,folder_preview_timeline:{},use_odyssey:w,folder_id:S}}},t.markPrimaryEvent=function(e){var t=e.extra;if(!t.primary_mark_ts){var r=o.now();t.primary_mark_ts=r;var n=t.start_time;n&&t.primary_mark_ts&&(t.time_to_primary_mark=t.primary_mark_ts-n)}},t.logEvent=function(e,t){var i=t.extra.folder_preview_timeline,a=o.now();if(!i.preview_session_ended_ts){switch(e){case d.attempted:if(i.preview_attempted_ts)return;i.preview_attempted_ts=a;break;case d.ended:if(i.preview_session_ended_ts)return;i.preview_session_ended_ts=a;break;case d.renderSucceeded:if(i.render_succeeded_ts)return;i.render_succeeded_ts=a;break;case d.renderFailed:if(i.render_failed_ts)return;i.render_failed_ts=a}return(function(e,t){return n.SilentBackgroundBeaconRequest({url:"/log/folder_preview",data:r.__assign(r.__assign({},f(t)),{event_name:e})})})(e,t)}}})),define("modules/clean/prefetch/prefetch",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPrefetchData=void 0,t.getPrefetchData=function(e){var t=window[e];if(t)return(function(e){return new Promise((function(t,r){var n=e.getDataIfAvailable();n?n.payload?t(JSON.parse(n.payload)):r(n.error):e((function(e){return t(JSON.parse(e))}),r)}))})(t)}})),define("modules/clean/react/shared_link_folder/api",["require","exports","modules/clean/prefetch/prefetch","modules/clean/deprecated_ajax/ajax_jquery"],(function(e,t,r,n){"use strict";function o(e){return{_mount_access_perms:e._mount_access_perms,filename:e.filename,href:e.href,is_dir:e.is_dir,ns_id:e.ns_id,open_in_app_data:e.open_in_app_data,shared_folder_id:e.shared_folder_id,sort_key:e.sort_key,folder_id:e.folder_id}}function i(e){return{canCopyToDropboxRoles:e.canCopyToDropboxRoles,canDownloadRoles:e.canDownloadRoles,canPrintRoles:e.canPrintRoles,canRemoveLinkUids:e.canRemoveLinkUids,canSyncToDropboxRoles:e.canSyncToDropboxRoles,canViewContextMenuRoles:e.canViewContextMenuRoles,canViewMetadataRoles:e.canViewMetadataRoles}}function a(e){return{itemId:e.itemId,linkKey:e.linkKey,linkType:e.linkType,secureHash:e.secureHash,subPath:e.subPath}}function s(e){for(var t,r=[],n=0,s=e.entries;n<s.length;n++){var l=s[n];l.is_dir?r.push(o(l)):r.push({is_dir:(t=l).is_dir,filename:t.filename,sort_key:t.sort_key,href:t.href,bytes:t.bytes,preview:t.preview,ns_id:t.ns_id,preview_type:t.preview_type?t.preview_type:null,sjid:t.sjid,ts:t.ts,thumbnail_url_tmpl:t.thumbnail_url_tmpl,file_id:t.file_id,revision_id:t.revision_id,is_symlink:!1})}var c=e.share_permissions.map(i),d=e.share_tokens.map(a);return{entries:r,folder:o(e.folder),folderSharedLinkInfo:e.folder_shared_link_info,folderSharePermission:i(e.folder_share_permission),folderShareToken:a(e.folder_share_token),hasMoreEntries:e.has_more_entries,nextRequestVoucher:e.next_request_voucher,sharedLinkInfos:e.shared_link_infos,sharePermissions:c,shareTokens:d,takedownRequestType:e.takedown_request_type}}function l(e,t,r){var o={link_key:e.linkKey,link_type:e.linkType,secure_hash:e.secureHash,sub_path:e.subPath||""};return t&&(o.voucher=t),new Promise((function(e,t){return n.WebRequest({type:"POST",url:"/list_shared_link_folder_entries",data:o,dataType:"json",success:function(t,n,o){if(r){var i=o.getResponseHeader("x-dropbox-request-id");r.end(i||void 0)}e(s(t))},error:function(e,r,n){t(new Error(n))}})}))}Object.defineProperty(t,"__esModule",{value:!0}),t.fetchNextPage=t.prefetchFirstPage=t.fetchPreviewAndSharingData=t.fetchPage=t.deserializePage=void 0,t.deserializePage=s,t.fetchPage=l,t.fetchPreviewAndSharingData=function(e){return l(e)},t.prefetchFirstPage=function(e){return(function(){var e=r.getPrefetchData("__REGISTER_SHARED_LINK_FOLDER_PRELOAD_HANDLER");if(e)return e.then(s)})()||l(e)},t.fetchNextPage=function(e,t){return l(e,t)}})),define("modules/clean/react/shared_link_folder/api_odyssey",["require","exports","tslib","modules/clean/prefetch/prefetch","modules/clean/react/shared_link_folder/api","modules/clean/filepath/filepath"],(function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prefetchFirstPage=t.deserializeFile=t.deserializeFolder=t.deserializeOdysseyResponse=void 0,i=r.__importStar(i);function a(e){for(var t=[],r=0,n=e.paginated?e.first_page.items:e.file_info;r<n.length;r++){var o=n[r];o.is_dir?t.push(s(o)):t.push(l(o))}return{entries:t,hasMoreEntries:e.paginated&&e.first_page.has_more_items,nextRequestVoucher:e.paginated?e.first_page.next_request_voucher:void 0}}function s(e){return{_mount_access_perms:e.mount_access_perms,filename:i.filename(e.fq_path),href:"",is_dir:!0,ns_id:e.ns_id,open_in_app_data:void 0,shared_folder_id:void 0,sort_key:[e.sort_key]}}function l(e){return{bytes:e.bytes,file_id:e.file_id,filename:i.filename(e.fq_path),href:"",is_dir:!1,is_symlink:e.is_symlink,ns_id:e.ns_id,revision_id:e.revision_id,sjid:e.sjid,sort_key:[e.sort_key],ts:e.ts}}t.deserializeOdysseyResponse=a,t.deserializeFolder=s,t.deserializeFile=l,t.prefetchFirstPage=function(e){return(function(){var e=n.getPrefetchData("__REGISTER_ODYSSEY_SHARED_LINK_FOLDER_PRELOAD_HANDLER");if(e)return e.then(a)})()||o.fetchPage(e)}})),define("modules/clean/react/shared_link_folder/data/actions",["require","exports","tslib","modules/clean/file_store/actions","modules/clean/react/shared_link_folder/api","modules/clean/react/shared_link_folder/api_odyssey","modules/clean/react/shared_link_folder/data/types","modules/clean/file_store/utils","modules/clean/previews/data/actions","modules/clean/redux/constants"],(function(e,t,r,n,o,i,a,s,l,c){"use strict";function d(e,t){var n=(function(e){return e?{file:e.file,fileMetadata:r.__rest(e,["file"])}:{file:void 0,fileMetadata:void 0}})(t),o=n.file,i=n.fileMetadata,l=o&&s.getFileStoreId(o);return{type:a.Actions.HydrateSharedFolder,payload:{fileId:l,fileMetadata:i,folderPackage:r.__assign(r.__assign({},e),{entries:e.entries.length?e.entries:l?[{type:"file",id:l}]:[]})}}}function u(e,t){for(var r=[],n={},o=0,i=t;o<i.length;o++){var l=i[o];if(l.is_dir){var c=l.filename;r.push({type:"folder",id:c}),n[c]={folder:l,entries:[],hasMore:!0}}else r.push({type:"file",id:s.getFileRevisionId(l)})}return{type:a.Actions.HydrateEntries,payload:{secureHash:e,entries:r,folderPackageMap:n}}}function p(e){return{type:a.Actions.FetchPageRequest,payload:e}}function f(e,t){return{type:a.Actions.FetchPageSuccess,payload:{fileMetadata:e,folderPackage:t}}}function m(e,t){return function r(i,l){void 0===l&&(l=0);var c=(function(e,t,r){var n;void 0===r&&(r=0);var o=e.entries,i=e.hasMoreEntries,l=e.sharedLinkInfos,c=e.sharePermissions,d=e.shareTokens,u=e.takedownRequestType,p={},f=((n={})[t]={entries:[],fromIndex:r,hasMore:i,takedownRequestType:u,folder:e.folder,sharedLinkInfo:e.folderSharedLinkInfo,sharePermission:e.folderSharePermission,shareToken:e.folderShareToken},n),m=[];return o.forEach((function(e,r){if(a.isFile(e)){var n=s.getFileStoreId(e);m.push(e),p[n]={sharedLinkInfo:l[r],sharePermission:c[r],shareToken:d[r]},f[t].entries.push({type:"file",id:n})}else{var o=d[r].secureHash;f[t].entries.push({type:"folder",id:o}),f[o]={folder:e,fromIndex:0,hasMore:!0,sharedLinkInfo:l[r],sharePermission:c[r],shareToken:d[r]}}})),{files:m,fileMetadata:p,folderPackage:f}})(i,t.secureHash,l),d=c.files,u=c.fileMetadata,p=c.folderPackage;e(n.putFiles(d)),e(f(u,p)),i.hasMoreEntries&&i.nextRequestVoucher&&o.fetchNextPage(t,i.nextRequestVoucher).then((function(e){return r(e,l+i.entries.length)}))}}function h(e,t){return function(r){var o=t.entries,i=t.sharedLinkInfos,d=t.sharePermissions,u=t.shareTokens;if(o){var p=[],f={},m={},h=[];o.forEach((function(e,t){if(a.isFile(e)){var r=s.getFileStoreId(e);f[r]={sharedLinkInfo:i[t],sharePermission:d[t],shareToken:u[t]},p.push(e),h.push({type:"file",id:s.getFileRevisionId(e)})}else{var n=u[t].secureHash;m[n]={entries:[],folder:e,fromIndex:0,hasMore:!0,sharedLinkInfo:i[t],sharePermission:d[t],shareToken:u[t]},h.push({type:"folder",id:n})}})),r(n.putFiles(p)),r(l.updatePreviewData(l.buildPreviewData(p,c.ApiClientStatus.Success))),r({type:a.Actions.HydratePreviewAndSharingData,payload:{parentSecureHash:e,parentFolderEntries:h,fileMetadataMap:f,folderPackageMap:m}})}}}Object.defineProperty(t,"__esModule",{value:!0}),t.hydratePreviewAndSharingData=t.fetchFolder=t.prefetchFolderFromOdyssey=t.prefetchFolder=t.fetchPageSuccess=t.hydrateEntries=t.hydrateSharedFolderAndFile=void 0,o=r.__importStar(o),i=r.__importStar(i),t.hydrateSharedFolderAndFile=function(e,t){return function(r){t&&r(n.putFile(t.file)),r(d(e,t))}},t.hydrateEntries=u,t.fetchPageSuccess=f,t.prefetchFolder=function(e,t){return function(t){t(p(e.secureHash));var r=o.prefetchFirstPage(e);return r.then(m(t,e)),r}},t.prefetchFolderFromOdyssey=function(e,t){return function(r){var d=o.fetchPreviewAndSharingData(e);return r(p(e.secureHash)),i.prefetchFirstPage(e).then((function(o){var i=(function(e,t){var r=e.entries,n=t?t.file:void 0;return{files:r.filter(a.isFile).map((function(e){return n&&s.areFilesEqual(n,e)?n:e})),entries:r}})(o,t),p=i.files,f=i.entries;r(n.putFiles(p)),r(l.updatePreviewData(l.buildPreviewData(p,c.ApiClientStatus.Request))),r(u(e.secureHash,f)),d.then((function(t){r(h(e.secureHash,t)),m(r,e)(t)}))})),d}},t.fetchFolder=function(e,t){return function(r){return r(p(e.secureHash)),o.fetchPage(e,void 0,t).then(m(r,e))}},t.hydratePreviewAndSharingData=h})),define("modules/clean/react/shared_link_folder/data/reducer",["require","exports","tslib","lodash","modules/clean/react/shared_link_folder/data/types","modules/clean/react/shared_link_folder/utils"],(function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sharedLinkFolderReducer=void 0,n=r.__importStar(n);var a={fileMetadata:{},folderPackage:{}};t.sharedLinkFolderReducer=function(e,t){var s,l,c,d,u;switch(void 0===e&&(e=a),t.type){case o.Actions.FetchPageRequest:var p=t.payload,f=e.folderPackage[p];return f?r.__assign(r.__assign({},e),{folderPackage:r.__assign(r.__assign({},e.folderPackage),(s={},s[p]=r.__assign(r.__assign({},f),{hasMore:!0}),s))}):e;case o.Actions.HydrateSharedFolder:var m=t.payload,h=m.fileId,_=m.fileMetadata,v=(p=(w=m.folderPackage).shareToken.secureHash,null!=h?((l={})[h]=_,l):{});return r.__assign(r.__assign({},e),{fileMetadata:r.__assign(r.__assign({},e.fileMetadata),v),folderPackage:r.__assign(r.__assign({},e.folderPackage),(c={},c[p]=r.__assign(r.__assign({},w),{hasMore:!0}),c))});case o.Actions.HydrateEntries:var g=t.payload,y=(p=g.secureHash,g.entries),b=g.folderPackageMap,w=e.folderPackage[p];return r.__assign(r.__assign({},e),{folderPackage:r.__assign(r.__assign(r.__assign({},e.folderPackage),b),(d={},d[p]=r.__assign(r.__assign({},w),{entries:y}),d))});case o.Actions.FetchPageSuccess:var S=t.payload,E=(_=S.fileMetadata,S.folderPackage),M={};return Object.keys(E).forEach((function(t){var n=e.folderPackage[t]||{},o=E[t],a=o.fromIndex,s=r.__rest(o,["fromIndex"]);M[t]=r.__assign(r.__assign(r.__assign({},n),s),{entries:i.mergeFolderEntries(n.entries,s.entries,a,!s.hasMore)})})),r.__assign(r.__assign({},e),{fileMetadata:r.__assign(r.__assign({},e.fileMetadata),_),folderPackage:r.__assign(r.__assign({},e.folderPackage),M)});case o.Actions.HydratePreviewAndSharingData:var k=t.payload,F=k.fileMetadataMap,P=(b=k.folderPackageMap,k.parentSecureHash),A=k.parentFolderEntries,T=n.values(b).map((function(e){return e.folder.filename})),C=Object.keys(e.folderPackage).filter((function(e){return-1===T.indexOf(e)})).reduce((function(t,r){return t[r]=e.folderPackage[r],t}),{});return r.__assign(r.__assign({},e),{fileMetadata:r.__assign(r.__assign({},e.fileMetadata),F),folderPackage:r.__assign(r.__assign(r.__assign({},C),b),(u={},u[P]=r.__assign(r.__assign({},e.folderPackage[P]),{entries:A}),u))})}return e}})),define("modules/clean/react/shared_link_folder/data/selectors",["require","exports","tslib","lodash","modules/clean/redux/namespaces","modules/clean/file_store/selectors"],(function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSharedFilePackageByFilenameForFolderPath=t.getSharedFilePackagesForFolderPath=t.getSubfoldersForFolderPath=t.getFolderByPath=void 0,n=r.__importStar(n);var a=function(e){return e[o.SHARED_LINK_FOLDER_NAMESPACE_KEY]};t.getFolderByPath=function(e,t){return a(e).folderPackage[t]};var s=function(e,r){var n=t.getFolderByPath(e,r);return n?n.entries.filter((function(e){return"file"===e.type})).map((function(e){return e.id})):[]};function l(e,t){var n=i.getFile(e,t);if(n){var o=(function(e,t){return a(e).fileMetadata[t]})(e,t);return r.__assign(r.__assign({},o),{file:n})}}t.getSubfoldersForFolderPath=function(e,r){var n=t.getFolderByPath(e,r);if(n)return n.entries.filter((function(e){return"folder"===e.type})).map((function(t){return(function(e,t){return a(e).folderPackage[t]})(e,t.id)}))},t.getSharedFilePackagesForFolderPath=function(e,t){return s(e,t).map((function(t){return l(e,t)})).filter(Boolean)},t.getSharedFilePackageByFilenameForFolderPath=function(e,t,r){var o=(function(e,t,r){if(r){var o=s(e,t);return n.find(o,(function(t){var n=i.getFile(e,t);return void 0!==n&&n.filename===r}))}})(e,t,r);if(o)return l(e,o)}})),define("modules/clean/react/shared_link_folder/data/store",["require","exports","tslib","lodash","modules/clean/file_store/reducer","modules/clean/react/file_viewer/data/reducer","modules/clean/react/shared_link_folder/data/actions","modules/clean/react/shared_link_folder/data/reducer","modules/clean/redux/store","modules/clean/redux/namespaces"],(function(e,t,r,n,o,i,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hydrateStore=t.getStoreForSharedLinkFolder=void 0,n=r.__importStar(n),t.getStoreForSharedLinkFolder=n.once((function(){var e,t=((e={})[c.FILE_NAMESPACE_KEY]=o.fileNamespaceReducer,e[c.FILE_VIEWER_NAMESPACE_KEY]=i.fileViewerReducer,e[c.SHARED_LINK_FOLDER_NAMESPACE_KEY]=s.sharedLinkFolderReducer,e);return l.getStoreAndRegisterReducers(t)})),t.hydrateStore=function(e,t){var r=t.initialPreview,n={folder:t.initialFolder,sharedLinkInfo:t.folderSharedLinkInfo,sharePermission:t.folderSharePermission,shareToken:t.folderShareToken,hasMore:!0,entries:[]};e.dispatch(a.hydrateSharedFolderAndFile(n,r))}})),define("modules/clean/react/shared_link_folder/data/types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TakedownType=t.Actions=t.isFile=void 0,t.isFile=function(e){return!e.is_dir},(function(e){e.HydrateSharedFolder="SHARED_FOLDER/HYDRATE",e.HydrateEntries="SHARED_FOLDER/HYDRATE_ENTRIES",e.HydratePreviewAndSharingData="SHARED_FOLDER/HYDRATE_PREVIEW_AND_SHARING_DATA",e.FetchPageSuccess="SHARED_FOLDER/FETCH_SUCCESS",e.FetchPageRequest="SHARED_FOLDER/FETCH_REQUEST"})(t.Actions||(t.Actions={})),(function(e){e[e.DMCA=1]="DMCA",e[e.MALWARE=2]="MALWARE",e[e.ILLEGAL=3]="ILLEGAL",e[e.OTHER=4]="OTHER",e[e.SPAM=5]="SPAM",e[e.TERROR=6]="TERROR",e[e.CSAI=7]="CSAI",e[e.PHISHING=8]="PHISHING"})(t.TakedownType||(t.TakedownType={}))})),define("modules/clean/react/shared_link_folder/folder_icon",["require","exports","tslib","react","modules/clean/react/shared_link_folder/utils","spectrum/icon_content/index","modules/clean/react/icon/icon_helper"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedLinkFolderFolderIcon=void 0,n=r.__importDefault(n),t.SharedLinkFolderFolderIcon=function(e){var t=e.className,r=e.folder,s=e.size;return n.default.createElement(i.IconContent,{className:t,name:a.spectrumFolderIcon({size:s,isConfidential:o.isNoAccessFolder(r)})})}})),define("modules/clean/react/shared_link_folder/folder_title",["require","exports","tslib","react","modules/constants/trademark","modules/core/uri","modules/core/i18n","modules/clean/react/shared_link_folder/utils","modules/clean/react/async/loadable"],(function(e,t,r,n,o,i,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContentOwner=t.FolderTitle=void 0,n=r.__importDefault(n);var c=l.Loadable({loader:function(){return new Promise((function(t,r){e(["modules/clean/react/breadcrumb/trail"],t,r)})).then(r.__importStar).then((function(e){return e.BreadcrumbTrail}))}}),d=(function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleCrumbClick=function(e,r,n){var o=t.props.onCrumbClick;e.preventDefault(),s.navigateToFolderHref(r.href),o&&o(n)},t}return r.__extends(o,e),o.prototype.render=function(){var e=this.props,o=e.breadcrumbs,i=e.ownerName,a=e.ownerTeamLogo,s=e.ownerTeamName,l=e.title;return n.default.createElement("div",{className:"sl-folder-title"},o&&o.length>0?n.default.createElement(c,r.__assign({},(function(e){var t,r;return e.length<=2?t=e:(t=e.slice(e.length-1),r=e.slice(0,e.length-1)),{inlineCrumbs:t,overflowCrumbs:r}})(o),{onChange:this.handleCrumbClick})):l,s?n.default.createElement(t.ContentOwner,{ownerName:i,ownerTeamName:s,ownerTeamLogo:a}):null)},o})(n.default.PureComponent);t.FolderTitle=d;var u=new i.URI({path:"/business",query:{src:"schmodel"}}).toString();t.ContentOwner=function(e){var t=e.ownerName,r=e.ownerTeamName,i=e.ownerTeamLogo;return n.default.createElement("div",{className:"sl-subtitle"},null!=t?a.intl.formatMessage({id:"V1gDEG",defaultMessage:"from {owner} ({team})"},{owner:t,team:r}):a.intl.formatMessage({id:"mL9XU3",defaultMessage:"from {team}"},{team:r}),null!=i?n.default.createElement("span",null," ","via ",n.default.createElement("a",{href:u},o.TRADEMARK_BUSINESS)):null)}})),define("modules/clean/react/shared_link_folder/grid",["require","exports","tslib","react","classnames","modules/clean/em_string","modules/clean/previews/constants","modules/clean/react/icon/icon_helper","modules/clean/react/shared_link_folder/folder_icon","modules/clean/react/file_viewer/url_utils","modules/clean/react/thumbnail","spectrum/tooltip/index","modules/core/i18n"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FolderCell=t.FileCell=t.SharedLinkFolderGrid=t.FileTitle=void 0,n=r.__importDefault(n),o=r.__importDefault(o);function f(e){var t=e.label,r=e.filename,o=n.default.createElement("span",{className:"sl-grid-filename"},t);return r===t?o:n.default.createElement(u.Tooltip,{positioning:"below",tooltipContent:r,wrapperClassName:"sl-grid-tooltip-wrapper"},o)}function m(e){var t=e.entry,r=e.onFolderOpen,o=e.onFileOpen,a=e.largeGrid,s=i.Emstring.em_snippet(t.filename,16);return t.is_dir?n.default.createElement(_,{folder:t,label:s,onOpen:r,largeGrid:a}):n.default.createElement(h,{file:t,label:s,onOpen:o,largeGrid:a})}t.FileTitle=f,t.SharedLinkFolderGrid=function(e){var t=e.entries,r=e.onFileOpen,o=e.onFolderOpen,i=e.largeGrid,a="sl-grid-cell";return i&&(a+="-lg"),n.default.createElement("div",{className:"sl-grid"},n.default.createElement("div",{className:"sl-grid-header clearfix"},n.default.createElement("div",{className:"sl-grid-header-column sl-grid-header-column--sort"},p.intl.formatMessage({id:"gTD7Ga",defaultMessage:"Sorted by name"}))),n.default.createElement("ol",{className:"sl-grid-body"},t.map((function(e){return n.default.createElement("li",{className:a,key:e.filename},n.default.createElement(m,{entry:e,onFolderOpen:o,onFileOpen:r,largeGrid:i}))}))))};var h=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=c.linkClickHandler((function(e){e.preventDefault();var r=t.props,n=r.file;(0,r.onOpen)(n)})),t}return r.__extends(t,e),t.prototype.isVideo=function(){return this.props.file.preview_type===a.PreviewType.Video},t.prototype.render=function(){var e=this.props,t=e.file,r=e.label,i=e.largeGrid,a=o.default("sl-link sl-link--file",{"sl-link--disabled":""===t.href}),l="sl-grid-thumbnail-container",c="sl-grid-thumbnail";return i&&(l="sl-grid-thumbnail-container-lg",c="sl-grid-thumbnail-lg"),n.default.createElement("a",{href:t.href,onClick:this.handleClick,className:a},n.default.createElement("div",{className:l},n.default.createElement(d.ThumbnailIcon,{alt:t.filename,className:c,file:t,iconSize:s.SpectrumIconSize.Large}),this.isVideo()?n.default.createElement("div",{className:"sl-video-watermark"}):null),n.default.createElement(f,{label:r,filename:t.filename}))},t})(n.default.PureComponent);t.FileCell=h;var _=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=c.linkClickHandler((function(e){e.preventDefault();var r=t.props,n=r.folder;(0,r.onOpen)(n)})),t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.folder,r=e.label,i=e.largeGrid,a=o.default("sl-link sl-link--folder",{"sl-link--disabled":""===t.href}),c="sl-grid-thumbnail-container",d="sl-grid-thumbnail";return i&&(c="sl-grid-thumbnail-container-lg",d="sl-grid-thumbnail-lg"),n.default.createElement("a",{href:t.href,onClick:this.handleClick,className:a},n.default.createElement("div",{className:c},n.default.createElement(l.SharedLinkFolderFolderIcon,{className:d,folder:t,size:s.SpectrumIconSize.Large})),n.default.createElement(f,{label:r,filename:t.filename}))},t})(n.default.PureComponent);t.FolderCell=_})),define("modules/clean/react/shared_link_folder/list",["require","exports","tslib","react","classnames","spectrum/table/index","spectrum/media_table/index","modules/clean/datetime/datetime","modules/clean/em_string","modules/clean/react/shared_link_folder/folder_icon","modules/clean/react/thumbnail","modules/core/i18n","modules/core/uri","modules/clean/react/size_class/constants","modules/clean/react/file_viewer/url_utils","modules/clean/display_format"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedLinkFolderList=void 0,n=r.__importDefault(n),o=r.__importDefault(o);var _=["1 1 50%","1 1 30%","1 1 20%"];function v(e){var t=e.entry,r=e.sizeClass,o=e.onFolderOpen,i=e.onFileOpen,a=e.smallList;return t.is_dir?n.default.createElement(y,{folder:t,sizeClass:r,onOpen:o,smallList:a}):n.default.createElement(b,{file:t,sizeClass:r,onOpen:i,smallList:a})}function g(e){var t=e.icon,r=e.lastModified,i=e.name,c=e.fileSize,d=e.sizeClass,u=e.onClick,p=e.href,_=e.smallList,v=m.linkClickHandler((function(e){e.preventDefault(),"function"==typeof u&&u()})),g=o.default("sl-list-row",{"sl-list-row--disabled":""===p});return n.default.createElement(a.MediaRow,{className:g},n.default.createElement(a.MediaCell,{className:"sl-list-column--filename",icon:t,title:l.Emstring.em_snippet(i,40)},n.default.createElement("a",{href:p,"aria-label":i,onClick:v})),d!==f.SizeClass.Small?n.default.createElement(a.MediaCell,{className:"sl-list-column--modified",title:r?s.format_date(r,s.localized_datetime_format):"--"}):null,_?n.default.createElement(a.MediaCell,{className:"sl-list-column--size",title:c?h.format_bytes(c):"--"}):null)}function y(e){var t=e.folder,r=e.sizeClass,o=e.onOpen,i=e.smallList,a="";""!==t.href&&(a=p.URI.parse(t.href).updateQuery({lst:""}).toString());return n.default.createElement(g,{icon:n.default.createElement(c.SharedLinkFolderFolderIcon,{className:"sl-list-icon",folder:t}),href:a,name:t.filename,onClick:function(){return o(t)},sizeClass:r,smallList:i})}function b(e){var t=e.file,r=e.sizeClass,o=e.onOpen,i=e.smallList;return n.default.createElement(g,{icon:n.default.createElement(d.ThumbnailIcon,{alt:t.filename,className:"sl-list-icon",file:t}),lastModified:new Date(1e3*t.ts),name:t.filename,fileSize:t.bytes,href:t.href,onClick:function(){return o(t)},sizeClass:r,smallList:i})}t.SharedLinkFolderList=function(e){var t=e.entries,r=e.sizeClass,a=e.onFileOpen,s=e.onFolderOpen,l=e.smallList;return n.default.createElement(i.Table,{columnFlex:_,className:o.default("sl-list-container",{"sl-list-container-condensed-list":l})},n.default.createElement(i.TableHead,null,n.default.createElement(i.TableHeadCell,null,u.intl.formatMessage({id:"cJojIg",defaultMessage:"Name"})),r!==f.SizeClass.Small?n.default.createElement(i.TableHeadCell,null,u.intl.formatMessage({id:"wqMlXT",defaultMessage:"Modified"})):null,l?n.default.createElement(i.TableHeadCell,null,u.intl.formatMessage({id:"QG1cgy",defaultMessage:"Size"})):null),n.default.createElement(i.TableBody,null,t.map((function(e){return n.default.createElement(v,{key:e.filename,entry:e,sizeClass:r,onFileOpen:a,onFolderOpen:s,smallList:l})}))))}})),define("modules/clean/react/shared_link_folder/utils",["require","exports","tslib","modules/core/uri","modules/clean/history","modules/core/notify","modules/core/i18n","spectrum-sharing/utils/sharing_constants","modules/clean/viewer"],(function(e,t,r,n,o,i,a,s,l){"use strict";function c(e){var t=e._mount_access_perms;return null!=t&&!t.includes("can_view")}function d(e){var t=e.getPath();try{t=decodeURIComponent(t)}catch(e){}o.default.push_state(n.URI.encode_parts(t),e.getQuery())}function u(e,t){void 0===t&&(t=!1);var r=n.URI.parse(e);"lst"in o.default.get_uri().getQuery()&&r.updateQuery({lst:""}),t&&r.updateQuery({subfolder_nav_tracking:"1"}),d(r)}function p(e){return l.Viewer.get_viewer().is_signed_in?a.intl.formatMessage({id:"dbYCaa",defaultMessage:"{folder_name} - Dropbox"},{folder_name:e}):a.intl.formatMessage({id:"3J1lxt",defaultMessage:"Dropbox - {folder_name} - Simplify your life"},{folder_name:e})}function f(e,t,n,o){if(void 0===n&&(n=0),void 0===o&&(o=!1),!Array.isArray(t))return e||[];if(!t.length)return[];if(!Array.isArray(e))return t;var i=r.__spreadArrays(e);return i.splice.apply(i,r.__spreadArrays([n,t.length],t)),o?i.slice(0,n+t.length):i}Object.defineProperty(t,"__esModule",{value:!0}),t.mergeFolderEntries=t.mergeListChunk=t.setPageTitle=t.generatePageTitle=t.shouldUpdateFolderHierarchy=t.getFolderShareTokenFromLocation=t.disableListMode=t.enableListMode=t.openFolder=t.navigateToFolderHref=t.isNoAccessFolder=void 0,o=r.__importDefault(o),t.isNoAccessFolder=c,t.navigateToFolderHref=u,t.openFolder=function(e){c(e)?i.Notify.error(a.intl.formatMessage({id:"IzGklK",defaultMessage:"Can’t open {folder_name}. Ask your admin for access."},{folder_name:e.filename})):u(e.href,!0)},t.enableListMode=function(){(function(e,t){var r={};r[e]=t;var n=o.default.get_uri();n.updateQuery(r),d(n)})("lst","")},t.disableListMode=function(){var e,t;e="lst",(t=o.default.get_uri()).removeQuery(e),d(t)},t.getFolderShareTokenFromLocation=function(e){var t=e.path,r=s.SharedLinkType.Shmodel;"/sh"===t.substr(0,3)?(r=s.SharedLinkType.Shmodel,t=t.substring(4,t.length)):"/scl/fo"===t.substr(0,7)&&(r=s.SharedLinkType.Content,t=t.substring(8,t.length));var n=t.split("/");return{linkKey:n[0],linkType:r,secureHash:n[1],subPath:n.slice(2).join("/")}},t.shouldUpdateFolderHierarchy=function(e,t,r){var n=r.secureHash,o=r.subPath,i=t.secureHash,a=t.subPath;return!e[n]||o.startsWith(a)&&e[i].length>=e[n].length},t.generatePageTitle=p,t.setPageTitle=function(e){document.title=p(e)},t.mergeListChunk=f,t.mergeFolderEntries=f})),define("modules/clean/react/shared_link_folder/view_toggle",["require","exports","tslib","classnames","react","modules/clean/react/sprite","retrieval-components/view-mode-toggle/index"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FolderViewModeToggle=t.FolderViewToggleOption=void 0,n=r.__importDefault(n),o=r.__importDefault(o),t.FolderViewToggleOption=function(e){var t=e.icon,r=e.label,a=e.onClick;return o.default.createElement("button",{"aria-label":r,className:n.default({"sl-view-toggle-option":!0}),name:r,onClick:a,value:r},o.default.createElement(i.Sprite,{group:"web",name:t,alt:r}))},t.FolderViewModeToggle=o.default.memo((function(e){var t=e.className,r=e.currentViewMode,n=e.onViewModeChanged;return o.default.createElement(a.ViewModeToggle,{className:t,currentMode:r,onSelection:n})}))})),define("modules/clean/react/share_sync/actions",["require","exports","tslib","modules/clean/multiaccount_login","modules/clean/viewer","modules/clean/sharing/shared_content_link_mount_folder"],(function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.syncToDropbox=void 0,n=r.__importDefault(n),i=r.__importStar(i),t.syncToDropbox=function(e,t,r){new Promise((function(e,r){o.Viewer.get_viewer().is_role_signed_in(t)?e():n.default.show_modal({role:t,on_success:function(){e()}})})).then((function(){i.mountSharedFolder(e,t,r,!0)}))}})),define("modules/clean/react/share_sync/button",["require","exports","tslib","react","modules/clean/filepath/filepath","modules/clean/react/bubble_menu","modules/clean/react/share_sync/models","spectrum-sharing/utils/sharing_constants","modules/clean/sharing/views/sync_coachmark","modules/clean/react/sprite_div","modules/clean/viewer","modules/core/i18n","modules/constants/payments","modules/clean/analytics","modules/clean/react/sticky_position","dig-components/buttons"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareSyncButton=void 0,n=r.__importDefault(n),o=r.__importStar(o),s=r.__importStar(s),c=r.__importDefault(c),p=r.__importStar(p);var _=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.options.map((function(e){return n.default.createElement(i.BubbleMenuItem,{onClick:function(){return e.handler()},disabled:e.isDisabled},n.default.createElement(c.default,{group:"web",name:e.spriteName,text:e.text}))}));return n.default.createElement(i.BubbleMenu,{targetButton:this.props.targetButton,position:m.StickyPosition.BOTTOM,verticalDisplacement:4,items:e})},t})(n.default.Component),v=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.logShareFolderPreviewUpgradeBtn=function(e){f.GrowthEventsLogger.log("wb_nq_pre_fo_up_b",{action:e,button_text:"Upgrade to Add Folder",destination_url:"http://www.dropbox.com/low-space",location:"top",quota_status:"near",upsell_type:"button"})},t.handleUpgradeButtonClick=function(){t.logShareFolderPreviewUpgradeBtn("click")},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.outOfQuota&&this.logShareFolderPreviewUpgradeBtn("view")},t.prototype.onClickedOption=function(e,t){e.preventDefault(),t.handler()},t.prototype.getSyncOptions=function(){var e=this,t=this.props.sharePermission.canSyncToDropboxRoles,r=d.Viewer.get_viewer();return t.map((function(t){return a.ShareSyncActionOption.buildOption(e.props.folder,r,t,s.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,e.props.folderPreviewSession,e.props.shareToken.linkType)}))},t.prototype.renderSyncCoachmark=function(){var e=this.props.sharePermission.canSyncToDropboxRoles.length>0;return this.props.showSyncCoachmark&&e?n.default.createElement("div",{className:"sync-button__coachmark-container"},n.default.createElement(l.SharingSyncCoachmark,null)):null},t.prototype.renderSyncButton=function(){var e=this;if(""!==this.props.shareToken.subPath)return null;if(0===this.props.sharePermission.canSyncToDropboxRoles.length)return null;var t="control__button sync-button";if(this.props.outOfQuota){var r=p.OUT_OF_SPACE_URL+"?oqa=wb_oq_pre_fo_up_b";return n.default.createElement("a",{className:t,href:r,onClick:this.handleUpgradeButtonClick},u.intl.formatMessage({id:"JhDJcU",defaultMessage:"Upgrade to Add Folder"}))}var i=void 0;if(this.props.user&&this.props.user.is_cdm_member){var a=o.filename(this.props.user.cdm_tmf_path);i=a.length>25?u.intl.formatMessage({id:"6m85k6",defaultMessage:"Add to my member folder"}):u.intl.formatMessage({id:"nzqkZQ",defaultMessage:"Add to {cdm_tmf_name} folder"},{cdm_tmf_name:a})}else i=u.intl.formatMessage({id:"N8ovVA",defaultMessage:"Add to Dropbox"});var s=this.getSyncOptions();if(1===s.length)return n.default.createElement(h.Button,{className:t,variant:"primary",style:{display:"-webkit-box"},onClick:function(t){return e.onClickedOption(t,s[0])}},i);var l=n.default.createElement(h.Button,{className:t,variant:"primary"},i);return n.default.createElement(_,{targetButton:l,folder:this.props.folder,shareToken:this.props.shareToken,options:s})},t.prototype.render=function(){return n.default.createElement("div",null,this.renderSyncCoachmark(),this.renderSyncButton())},t})(n.default.Component);t.ShareSyncButton=v})),define("modules/clean/react/share_sync/models",["require","exports","tslib","immutable","react","modules/clean/filepath/filepath","modules/clean/react/share_sync/actions","modules/core/i18n","modules/clean/loggers/folder_preview_logger","modules/clean/react/file_viewer/constants","spectrum-sharing/utils/sharing_constants"],(function(e,t,r,n,o,i,a,s,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShareSyncActionOption=void 0,n=r.__importStar(n),o=r.__importDefault(o),i=r.__importStar(i),a=r.__importStar(a);var u={text:void 0,handler:void 0,isDisabled:!1,spriteName:void 0},p=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.buildOption=function(e,r,n,u,p,f){var m=s.intl.formatMessage({id:"l/lvUk",defaultMessage:"Save to my Dropbox"}),h="dropbox",_=r.get_user_by_role(n);if(_&&_.is_cdm_member){var v=i.filename(_.cdm_tmf_path);m=v.length>12?s.intl.formatMessage({id:"QPvsZL",defaultMessage:"Save to my member folder"}):s.intl.formatMessage({id:"VIDWC/",defaultMessage:"Save to <strong>{cdm_tmf_name}</strong> folder"},{cdm_tmf_name:v,strong:function(e){return o.default.createElement("strong",null,e)}}),r.is_paired&&(h="s_briefcase")}else if(r.is_paired)switch(n){case"personal":m=s.intl.formatMessage({id:"S5UJEB",defaultMessage:"Save to personal Dropbox"}),h="s_house";break;case"work":m=s.intl.formatMessage({id:"76AF1h",defaultMessage:"Save to {team_name} Dropbox"},{team_name:r.team_name}),h="s_briefcase"}return new t({text:m,handler:function(){f===d.SharedLinkType.Shmodel&&l.logEvent(c.UserAction.AddToDropbox,p),a.syncToDropbox(e.shared_folder_id,n,u)},spriteName:h})},t})(n.Record(u));t.ShareSyncActionOption=p})),define("modules/clean/auth/multi_account_login_modal",["require","exports","tslib","react","modules/clean/auth/login/form","modules/clean/react/components/modal","modules/clean/viewer","modules/core/exception","modules/core/i18n","spectrum/modal/index"],(function(e,t,r,n,o,i,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestOnlyMultiAccountLoginModal=t.TestOnlyAssumePersonalLockedModal=t.MultiAccountLoginModal=void 0;var d=(function(e){function t(t){var r=e.call(this,t)||this;return r.getUser=function(){var e,t=r.props,n=t.user,o=t.userId,i=t.role;return null!=n?e=n:null!=o?e=r.viewer.get_user_by_id(o,!0):null!=i&&(e=r.viewer.get_user_by_role(i,!0)),e},r.onLoginSuccess=function(e){r.viewer._sign_in_all_users(),r.props.onAuthenticateSuccess&&!r.props.continuationUrl&&r.props.onAuthenticateSuccess(),r.closeModal()},r.closeModal=function(e){e&&e.stopPropagation(),r.props.onCancel&&r.props.onCancel(),i.Modal.close()},s.assert(null!==t.onAuthenticateSuccess&&void 0!==t.onAuthenticateSuccess||null!==t.continuationUrl&&void 0!==t.continuationUrl,"onAuthenticateSuccess and continuationUrl are mutually exclusive"),r.viewer=a.Viewer.get_viewer(),r}return r.__extends(t,e),t.prototype.render=function(){if(this.viewer.is_team_assume_user_session)return n.default.createElement(p,{displayName:this.viewer.display_name,onRequestClose:this.closeModal,open:!0,teamName:this.viewer.team_name});var e=this.getUser();return s.assert(null!=e,"invalid user"),s.assert(!this.viewer.is_user_signed_in(e),"called multi-account login for a user that's already signed in"),n.default.createElement(u,{onRequestClose:this.closeModal,onAuthenticateSuccess:this.onLoginSuccess,open:!0,continuationUrl:this.props.continuationUrl,teamName:this.viewer.team_name||"",user:e,encryptionOptions:this.props.encryptionOptions})},t})((n=r.__importDefault(n)).default.PureComponent);t.MultiAccountLoginModal=d;var u=function(e){var t=e.user.role;if(!t)return null;var r="personal"===t?l.intl.formatMessage({id:"DCfdq9",defaultMessage:"Sign in to your personal Dropbox"}):l.intl.formatMessage({id:"L5lWSy",defaultMessage:"Sign in to your {team_name} Dropbox"},{team_name:e.teamName});return n.default.createElement(c.Modal,{appElement:document.body,ariaLabel:l.intl.formatMessage({id:"lggZdA",defaultMessage:"Multi-account login modal"}),bodyClassName:"multiaccount-login-modal",bodyId:"multiaccount-login-modal",className:"mc-util-modal",displayCloseButton:!0,onRequestClose:e.onRequestClose,open:e.open,overlayClassName:"file-viewer-modal-overlay"},n.default.createElement("div",{className:"mc-util-modal-header"},r),n.default.createElement("div",{className:"mc-util-modal-body"},n.default.createElement(o.LoginForm,{canRedirect:!!e.continuationUrl,continuationUrl:e.continuationUrl||void 0,emailProps:{initialValue:e.user.email,readonly:!0},googleLoginProps:{positionBelow:!1},maestroStyle:!0,onLoginSuccess:e.onAuthenticateSuccess,rememberMeCheckboxProps:{checked:!0},type:"multi",encryptionOptions:e.encryptionOptions})))};t.TestOnlyMultiAccountLoginModal=u;var p=function(e){var t=e.displayName,r=e.onRequestClose,o=e.teamName;return n.default.createElement(c.UtilityModal,{appElement:document.body,ariaLabel:l.intl.formatMessage({id:"XTU3gF",defaultMessage:"Personal account locked modal"}),className:"team-assume-user-modal",displayCloseButton:!0,onRequestClose:r,open:e.open,primaryAction:l.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),title:l.intl.formatMessage({id:"YcDQxL",defaultMessage:"Personal account not accessible"})},n.default.createElement("div",null,l.intl.formatMessage({id:"9uHtUs",defaultMessage:"{display_name}’s personal account isn’t managed by the {team_name} team, so its contents aren’t accessible to admins."},{display_name:t,team_name:o})))};t.TestOnlyAssumePersonalLockedModal=p})),define("modules/clean/sharing/shared_content_link_mount_folder",["require","exports","tslib","react","modules/clean/browse_interface","modules/clean/react/components/modal","modules/clean/auth/multi_account_login_modal","modules/clean/sharing/api/client","api_v2/user_client","modules/clean/sharing/ui_notifications_util","modules/clean/viewer","modules/core/browser","modules/core/exception","modules/core/i18n","modules/clean/flux/dispatcher","modules/clean/sharing/share_page/action_types"],(function(e,t,r,n,o,i,a,s,l,c,d,u,p,f,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mountSharedFolder=void 0,n=r.__importDefault(n),o=r.__importStar(o),u=r.__importStar(u),t.mountSharedFolder=function e(t,r,_,v,g,y,b){void 0===g&&(g=!1),void 0===y&&(y=null);var w,S=d.Viewer.get_viewer();if(r&&(S.is_role_signed_in(r)||i.Modal.showInstance(n.default.createElement(a.MultiAccountLoginModal,{role:r,onAuthenticateSuccess:function(){e(t,r,_,v,!1,null,b)}}))),r){var E=S.get_uid_by_role(r);p.assert(!!E,"selected role should have corresponding uid"),w=E||-1}else p.assert(!S.is_paired,"role can not be unspecified for paired viewer"),w=S.get_user_ids()[0];var M=f.intl.formatMessage({id:"Zd8jt8",defaultMessage:"Adding to your Dropbox..."});S.is_paired&&(M=S.get_user_by_id(w).is_team?f.intl.formatMessage({id:"PTGTT4",defaultMessage:"Adding to your {team_name} Dropbox..."},{team_name:S.team_name}):f.intl.formatMessage({id:"IVdsoO",defaultMessage:"Adding to your personal Dropbox..."})),c.sharingNotificationSuccess(M);var k=new s.FolderShareApiClient({userId:w,client:new l.UserApiV2Client});m.Dispatcher.dispatch({type:h.SharePageActionTypes.MOUNT_FOLDER_REQUEST,metadata:b,user:S.get_user_by_id(w),shared_folder_id:t}),k.mount({contentId:t}).then((function(e){(function(e){if(e){var t=e;(null==y?void 0:y.ns_path)&&(t+=y.ns_path);var r=S.get_user_by_id(w),n=o.browse_uri_for_fq_path(r,t),i=g?"1":"0";n.updateQuery({from_scl_sync_modal:i}),u.redirect(n.toString())}})(e.path_lower)})).catch((function(e){e&&e.error&&"insufficient_quota"===e.error[".tag"]?c.sharingNotificationError(f.intl.formatMessage({id:"jENkzW",defaultMessage:"Can’t add folder. Your Dropbox account is full."})):c.sharingNotificationError(f.intl.formatMessage({id:"EQfnGr",defaultMessage:"We were unable to complete your request."}))}))}})),define("spectrum/backdrop/index",["require","exports","tslib","spectrum/backdrop/backdrop"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(n,t)})),define("spectrum/backdrop/backdrop",["require","exports","tslib","classnames","react"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Backdrop=void 0,n=r.__importDefault(n),o=r.__importStar(o),t.Backdrop=function(e){var t=e.className,i=e.isVisible,a=r.__rest(e,["className","isVisible"]);return i?o.createElement("div",Object.assign({className:n.default("mc-backdrop",t)},a)):null},t.Backdrop.displayName="Backdrop"})),define("spectrum/mobile_menu/mobile_menu",["require","exports","tslib","react","classnames","focus-trap-react","spectrum/backdrop/index","spectrum/mobile_menu/mobile_menu_content","spectrum/mobile_menu/mobile_menu_close_button","spectrum/portal/index","spectrum/scroll_locker/index"],(function(e,t,r,n,o,i,a,s,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MobileMenu=void 0,n=r.__importStar(n),o=r.__importDefault(o),i=r.__importDefault(i);var u=(function(e){function t(){var t=e.apply(this,arguments)||this;return t.initBodyPadding="0",t.state={isVisible:!1},t.openMobileMenu=function(){t.initBodyPadding=d.getBodyPadding(),t.setState({isVisible:!0},d.lockScroll)},t.closeMobileMenu=function(){t.setState({isVisible:!1},(function(){return d.unlockScroll(t.initBodyPadding)}))},t.handleKeyDown=function(e){var r=e.key;if("Escape"!==r){var n=e.target;if("ArrowUp"===r||"ArrowLeft"===r){var o=n.previousElementSibling;o&&o.focus()}if("ArrowDown"===r||"ArrowRight"===r){var i=n.nextElementSibling;i&&i.focus()}}else t.closeMobileMenu()},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.children,d=e.className,u=e.closeButton,p=e.trigger,f=r.__rest(e,["children","className","closeButton","trigger"]);return n.createElement("div",Object.assign({className:o.default("mc-mobile-menu",d)},f),p({openMobileMenu:this.openMobileMenu}),this.state.isVisible?n.createElement(c.Portal,{isShowInitially:!0},n.createElement("div",{className:"mc-mobile-menu-container",onKeyDown:this.handleKeyDown},n.createElement(i.default,{focusTrapOptions:{returnFocusOnDeactivate:!0}},n.createElement(a.Backdrop,{onClick:this.closeMobileMenu,isVisible:!0}),n.createElement(s.MobileMenuContent,{closeMobileMenu:this.closeMobileMenu},n.createElement("div",{className:"mc-mobile-menu-section"},t),n.createElement("div",{className:"mc-mobile-menu-section"},u?u({closeMobileMenu:this.closeMobileMenu}):n.createElement(l.MobileMenuCloseButton,null)))))):null)},t})(n.Component);t.MobileMenu=u})),define("spectrum/mobile_menu/mobile_menu_close_button",["require","exports","tslib","react","spectrum/mobile_menu/mobile_menu_item"],(function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MobileMenuCloseButton=void 0,n=r.__importStar(n),t.MobileMenuCloseButton=function(){return n.createElement(o.MobileMenuItem,{className:"mc-mobile-menu-close-button",shouldCloseMenuOnSelect:!0},"Close")},t.MobileMenuCloseButton.displayName="MobileMenuCloseButton"})),define("spectrum/mobile_menu/mobile_menu_content",["require","exports","tslib","react","classnames","prop-types"],(function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MobileMenuContent=void 0,n=r.__importStar(n),o=r.__importDefault(o),i=r.__importDefault(i);var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.getChildContext=function(){return{closeMobileMenu:this.props.closeMobileMenu}},t.prototype.render=function(){var e=this.props,t=e.className,i=e.children,a=(e.closeMobileMenu,r.__rest(e,["className","children","closeMobileMenu"]));return n.createElement("div",Object.assign({className:o.default("mc-mobile-menu-content",t)},a),i)},t})(n.Component);t.MobileMenuContent=a,a.childContextTypes={closeMobileMenu:i.default.func}})),define("spectrum/mobile_menu/mobile_menu_item",["require","exports","tslib","react","classnames","prop-types","react-touch-events"],(function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MobileMenuItem=void 0,n=r.__importStar(n),o=r.__importDefault(o),i=r.__importDefault(i),a=r.__importDefault(a);var s=(function(e){function t(){var t=e.apply(this,arguments)||this;return t.handleSelect=function(e){var r=t.props,n=r.shouldCloseMenuOnSelect,o=r.shouldPreventDefaultOnSelectItem,i=r.onSelect;n&&t.context.closeMobileMenu(),o&&e.preventDefault(),i&&i(e)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,i=(e.shouldCloseMenuOnSelect,e.children),s=(e.onSelect,e.shouldPreventDefaultOnSelectItem,r.__rest(e,["className","shouldCloseMenuOnSelect","children","onSelect","shouldPreventDefaultOnSelectItem"]));return n.createElement(a.default,{onTap:this.handleSelect},n.createElement("button",Object.assign({},s,{className:o.default("mc-mobile-menu-item",t),onClick:this.handleSelect}),i))},t})(n.Component);t.MobileMenuItem=s,s.contextTypes={closeMobileMenu:i.default.func},s.defaultProps={shouldCloseMenuOnSelect:!0,shouldPreventDefaultOnSelectItem:!0}})),define("modules/clean/sharing/views/sync_coachmark",["require","exports","tslib","react","modules/clean/deprecated_ajax/ajax_jquery","modules/clean/react/bubble","modules/clean/react/components/css","modules/clean/react/image","modules/clean/static_urls","modules/core/i18n"],(function(e,t,r,n,o,i,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharingSyncCoachmark=void 0,n=r.__importDefault(n),o=r.__importStar(o),i=r.__importDefault(i);var d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={show:!0},t.hideSyncCoachmark=function(){t.setState({show:!1})},t}return r.__extends(t,e),t.prototype.componentWillMount=function(){o.BackgroundRequest({url:"/sharing/seen_sync_coachmark"})},t.prototype.render=function(){return this.state.show?n.default.createElement(i.default,{arrow:i.default.ARROW.TOP_LEFT,className:"sync-coachmark u-pad-s"},n.default.createElement(s.Image,{className:"u-l-ib",src:l.static_url("/static/images/sharing/sync_coachmark-vflvg8Oy0.png"),srcHiRes:l.static_url("/static/images/sharing/sync_coachmark@2x-vflhX3Mhx.png")}),n.default.createElement("div",{className:"u-l-ib u-pad-left-s sync-coachmark__content"},n.default.createElement("h2",null,c.intl.formatMessage({id:"utNf/m",defaultMessage:"Stay in sync"})),n.default.createElement("p",null,c.intl.formatMessage({id:"SIGEzu",defaultMessage:"For easy access to this folder in the future, add it to your Dropbox."})),n.default.createElement("button",{className:"c-btn c-btn--secondary",onClick:this.hideSyncCoachmark},c.intl.formatMessage({id:"W4An+g",defaultMessage:"Got it"})))):n.default.createElement("div",null)},t.displayName="SharingSyncCoachmark",t})(n.default.Component);t.SharingSyncCoachmark=a.requireCssWithComponent(d,["/static/css/sharing/sync_coachmark-vflHD6MS5.css"])})),define("prod_assets_web_modules/react-touch-events",["./common/_commonjsHelpers","react"],(function(e,t){"use strict";var r=(function(e){return e&&e.__esModule?e:{default:e}})(t),n=e.createCommonjsModule((function(t,n){var o;e.commonjsGlobal,o=function(e){return(function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=8)})([function(e,t,r){function n(e){return function(){return e}}var o=function(){};o.thatReturns=n,o.thatReturnsFalse=n(!1),o.thatReturnsTrue=n(!0),o.thatReturnsNull=n(null),o.thatReturnsThis=function(){return this},o.thatReturnsArgument=function(e){return e},e.exports=o},function(e,t,r){var n;n=function(e){if(void 0===e)throw new Error("invariant requires an error message argument")},e.exports=function(e,t,r,o,i,a,s,l){if(n(t),!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[r,o,i,a,s,l],u=0;(c=new Error(t.replace(/%s/g,(function(){return d[u++]})))).name="Invariant Violation"}throw c.framesToPop=1,c}}},function(e,t,r){var n,o=r(0);n=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=0,i="Warning: "+e.replace(/%s/g,(function(){return r[o++]}));"undefined"!=typeof console&&console.error(i);try{throw new Error(i)}catch(e){}},o=function(e,t){if(void 0===t)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(0!==t.indexOf("Failed Composite propType: ")&&!e){for(var r=arguments.length,o=Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];n.apply(void 0,[t].concat(o))}},e.exports=o},function(e,t,r){e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,r){var n="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;e.exports=r(7)((function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}),!0)},function(t,r){t.exports=e},function(e,t,r){var n=r(1),o=r(2),i=r(3),a={};e.exports=function(e,t,r,s,l){for(var c in e)if(e.hasOwnProperty(c)){var d;try{n("function"==typeof e[c],"%s: %s type `%s` is invalid; it must be a function, usually from React.PropTypes.",s||"React class",r,c),d=e[c](t,c,s,r,null,i)}catch(e){d=e}if(o(!d||d instanceof Error,"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",s||"React class",r,c,typeof d),d instanceof Error&&!(d.message in a)){a[d.message]=!0;var u=l?l():"";o(!1,"Failed %s type: %s%s",r,d.message,null!=u?u:"")}}}},function(e,t,r){var n=r(0),o=r(1),i=r(2),a=r(3),s=r(6);e.exports=function(e,t){var r="function"==typeof Symbol&&Symbol.iterator,l={array:u("array"),bool:u("boolean"),func:u("function"),number:u("number"),object:u("object"),string:u("string"),symbol:u("symbol"),any:d(n.thatReturnsNull),arrayOf:function(e){return d((function(t,r,n,o,i){if("function"!=typeof e)return new c("Property `"+i+"` of component `"+n+"` has invalid PropType notation inside arrayOf.");var s=t[r];if(!Array.isArray(s))return new c("Invalid "+o+" `"+i+"` of type `"+f(s)+"` supplied to `"+n+"`, expected an array.");for(var l=0;l<s.length;l++){var d=e(s,l,n,o,i+"["+l+"]",a);if(d instanceof Error)return d}return null}))},element:d((function(t,r,n,o,i){var a=t[r];return e(a)?null:new c("Invalid "+o+" `"+i+"` of type `"+f(a)+"` supplied to `"+n+"`, expected a single ReactElement.")})),instanceOf:function(e){return d((function(t,r,n,o,i){if(!(t[r]instanceof e)){var a=e.name||"<<anonymous>>";return new c("Invalid "+o+" `"+i+"` of type `"+((s=t[r]).constructor&&s.constructor.name?s.constructor.name:"<<anonymous>>")+"` supplied to `"+n+"`, expected instance of `"+a+"`.")}var s;return null}))},node:d((function(e,t,r,n,o){return p(e[t])?null:new c("Invalid "+n+" `"+o+"` supplied to `"+r+"`, expected a ReactNode.")})),objectOf:function(e){return d((function(t,r,n,o,i){if("function"!=typeof e)return new c("Property `"+i+"` of component `"+n+"` has invalid PropType notation inside objectOf.");var s=t[r],l=f(s);if("object"!==l)return new c("Invalid "+o+" `"+i+"` of type `"+l+"` supplied to `"+n+"`, expected an object.");for(var d in s)if(s.hasOwnProperty(d)){var u=e(s,d,n,o,i+"."+d,a);if(u instanceof Error)return u}return null}))},oneOf:function(e){return Array.isArray(e)?d((function(t,r,n,o,i){for(var a=t[r],s=0;s<e.length;s++)if((l=a)===(d=e[s])?0!==l||1/l==1/d:l!=l&&d!=d)return null;var l,d;return new c("Invalid "+o+" `"+i+"` of value `"+a+"` supplied to `"+n+"`, expected one of "+JSON.stringify(e)+".")})):(i(!1,"Invalid argument supplied to oneOf, expected an instance of array."),n.thatReturnsNull)},oneOfType:function(e){return Array.isArray(e)?d((function(t,r,n,o,i){for(var s=0;s<e.length;s++)if(null==(0,e[s])(t,r,n,o,i,a))return null;return new c("Invalid "+o+" `"+i+"` supplied to `"+n+"`.")})):(i(!1,"Invalid argument supplied to oneOfType, expected an instance of array."),n.thatReturnsNull)},shape:function(e){return d((function(t,r,n,o,i){var s=t[r],l=f(s);if("object"!==l)return new c("Invalid "+o+" `"+i+"` of type `"+l+"` supplied to `"+n+"`, expected `object`.");for(var d in e){var u=e[d];if(u){var p=u(s,d,n,o,i+"."+d,a);if(p)return p}}return null}))}};function c(e){this.message=e,this.stack=""}function d(e){var r={},n=0;function s(s,l,d,u,p,f,m){if(u=u||"<<anonymous>>",f=f||d,m!==a)if(t)o(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");else if("undefined"!=typeof console){var h=u+":"+d;!r[h]&&n<3&&(i(!1,"You are manually calling a React.PropTypes validation function for the `%s` prop on `%s`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details.",f,u),r[h]=!0,n++)}return null==l[d]?s?null===l[d]?new c("The "+p+" `"+f+"` is marked as required in `"+u+"`, but its value is `null`."):new c("The "+p+" `"+f+"` is marked as required in `"+u+"`, but its value is `undefined`."):null:e(l,d,u,p,f)}var l=s.bind(null,!1);return l.isRequired=s.bind(null,!0),l}function u(e){return d((function(t,r,n,o,i,a){var s=t[r];return f(s)!==e?new c("Invalid "+o+" `"+i+"` of type `"+(function(e){var t=f(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t})(s)+"` supplied to `"+n+"`, expected `"+e+"`."):null}))}function p(t){switch(typeof t){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(p);if(null===t||e(t))return!0;var n=(function(e){var t=e&&(r&&e[r]||e["@@iterator"]);if("function"==typeof t)return t})(t);if(!n)return!1;var o,i=n.call(t);if(n!==t.entries){for(;!(o=i.next()).done;)if(!p(o.value))return!1}else for(;!(o=i.next()).done;){var a=o.value;if(a&&!p(a[1]))return!1}return!0;default:return!1}}function f(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":(function(e,t){return"symbol"===e||"Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol})(t,e)?"symbol":t}return c.prototype=Error.prototype,l.checkPropTypes=s,l.PropTypes=l,l}},function(e,t,r){var n=(function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}})();function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var a=r(5),s=r(4);function l(e){return e.touches[0].clientX}function c(e){return e.touches[0].clientY}var d=(function(e){function t(){var e,r,n;o(this,t);for(var a=arguments.length,s=Array(a),d=0;d<a;d++)s[d]=arguments[d];return r=n=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),n.handleTouchStart=function(e){n.touchStarted||(n.touchStarted=!0,n.touchMoved=!1,n.swipeOutBounded=!1,n.startX=l(e),n.startY=c(e),n.currentX=0,n.currentY=0)},n.handleTouchMove=function(e){if(n.currentX=l(e),n.currentY=c(e),n.touchMoved){if(!n.swipeOutBounded){var t=n.props.swipeTolerance;n.swipeOutBounded=Math.abs(n.startX-n.currentX)>t&&Math.abs(n.startY-n.currentY)>t}}else{var r=n.props.tapTolerance;n.touchMoved=Math.abs(n.startX-n.currentX)>r||Math.abs(n.startY-n.currentY)>r}},n.handleTouchCancel=function(){n.touchStarted=n.touchMoved=!1,n.startX=n.startY=0},n.handleTouchEnd=function(e){if(n.touchStarted=!1,n.touchMoved){if(!n.swipeOutBounded&&n.props.onSwipe){var t,r=n.props.swipeTolerance;t=Math.abs(n.startX-n.currentX)<r?n.startY>n.currentY?"top":"bottom":n.startX>n.currentX?"left":"right",n.props.onSwipe(t,e)}}else n.props.onTap&&n.props.onTap(e)},i(n,r)}return(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)})(t,e),n(t,[{key:"render",value:function(){var e=this.props.children,t=e?a.Children.only(e):a.createElement("button",null);return a.cloneElement(t,{onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,onTouchCancel:this.handleTouchCancel,onTouchEnd:this.handleTouchEnd})}}]),t})(a.Component);d.defaultProps={tapTolerance:10,swipeTolerance:30},d.propTypes={children:s.node,tapTolerance:s.number,swipeTolerance:s.number,onTap:s.func,onSwipe:s.func},e.exports=d}])},t.exports=o(r.default)}));return e.getDefaultExportFromCjs(n)}));
//# sourceMappingURL=pkg-file_viewer_archive.min.js-vflaqwTvk.map